<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0070)https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <!-- AppResources meta begin -->
        <script type="text/javascript">var ncbi_startTime = new Date();</script>
        <!-- AppResources meta end -->
        
        <!-- TemplateResources meta begin -->
        <meta name="paf_template" content="">

        <!-- TemplateResources meta end -->
        
        <!-- Logger begin -->
        <meta name="ncbi_db" content="pmc"><meta name="ncbi_pdid" content="article"><meta name="ncbi_acc" content=""><meta name="ncbi_domain" content="hal"><meta name="ncbi_report" content="printable"><meta name="ncbi_type" content="fulltext"><meta name="ncbi_objectid" content=""><meta name="ncbi_pcid" content="/articles/PMC2881565/?report=printable"><meta name="ncbi_app" content="pmc">
        <!-- Logger end -->
        
        <title>An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images</title>
        
        <!-- AppResources external_resources begin -->
        <link rel="stylesheet" href="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/jig.min.css"><script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/jig.min.js"></script>

        <!-- AppResources external_resources end -->
        
        <!-- Page meta begin -->
        <meta name="robots" content="INDEX,NOFOLLOW,NOARCHIVE"><link rel="canonical" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/"><link rel="schema.DC" href="http://purl.org/DC/elements/1.0/"><meta name="citation_journal_title" content="Ieee Transactions on Medical Imaging"><meta name="citation_title" content="An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images"><meta name="citation_authors" content="Pierrick Coupé, Pierre Yger, Sylvain Prima, Pierre Hellier, Charles Kervrann, Christian Barillot"><meta name="citation_date" content="April 2008"><meta name="citation_issue" content="4"><meta name="citation_volume" content="27"><meta name="citation_firstpage" content="425"><meta name="citation_doi" content="10.1109/TMI.2007.906087"><meta name="citation_abstract_html_url" content="/pmc/articles/PMC2881565/?report=abstract"><meta name="citation_pmid" content="18390341"><meta name="DC.Title" content="An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images"><meta name="DC.Type" content="Text"><meta name="DC.Publisher" content="Inserm"><meta name="DC.Contributor" content="Pierrick Coupé"><meta name="DC.Contributor" content="Pierre Yger"><meta name="DC.Contributor" content="Sylvain Prima"><meta name="DC.Contributor" content="Pierre Hellier"><meta name="DC.Contributor" content="Charles Kervrann"><meta name="DC.Contributor" content="Christian Barillot"><meta name="DC.Date" content="2008 Apr"><meta name="DC.Identifier" content="10.1109/TMI.2007.906087"><meta name="DC.Language" content="en"><meta property="og:title" content="An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images"><meta property="og:type" content="article"><meta property="og:description" content="A critical issue in image restoration is the problem of noise removal while keeping the integrity of relevant image information. Denoising is a crucial step to increase image quality and to improve the performance of all the tasks needed for quantitative ..."><meta property="og:url" content="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/"><meta property="og:site_name" content="PubMed Central (PMC)"><meta property="og:image" content="https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-logo-share.png"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@ncbi"><link rel="stylesheet" href="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/pmc.min.css" type="text/css"><link rel="stylesheet" href="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/pmc_extras_prnt.min.css" type="text/css" media="print"><script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/common.min.js">//</script><script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/NcbiTagServer.min.js">//</script><meta name="citationexporter" content="backend:&#39;https://api.ncbi.nlm.nih.gov/lit/ctxp/v1/pmc/&#39;"><script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/jquery.citationexporter.min.js">//</script><link rel="stylesheet" href="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/citationexporter.css" type="text/css"><script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/MathJax.js"></script><script type="text/javascript">window.name="mainwindow";</script><style type="text/css">.pmc-wm {background:transparent repeat-y top left;background-image:url(/corehtml/pmc/pmcgifs/wm-hal.gif);background-size: auto, contain}</style><style type="text/css">.print-view{display:block}</style>

        <!-- Page meta end -->
    <link rel="shortcut icon" href="https://www.ncbi.nlm.nih.gov/favicon.ico"><meta name="ncbi_phid" content="8A1B0945F9DEC0F100000000025D025D.m_4">
<meta name="referrer" content="origin-when-cross-origin"><link type="text/css" rel="stylesheet" href="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/3964959.css"><link type="text/css" rel="stylesheet" href="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/3882866.css" media="print"><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script async="1" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/analytics.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
</style></head>
    <body class="article" id="ui-ncbiexternallink-1"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
        <div class="grid">
            <div class="col twelve_col nomargin shadow">
                <!-- System messages like service outage or JS required; this is handled by the TemplateResources portlet -->
                <div class="sysmessages">
                    <noscript>
	<p class="nojs">
	<strong>Warning:</strong>
	The NCBI web site requires JavaScript to function. 
	<a href="/guide/browsers/#enablejs" title="Learn how to enable JavaScript" target="_blank">more...</a>
	</p>
	</noscript>
                </div>
                <!--/.sysmessage-->
                <div class="wrap">
                    <div class="page">
                        <div class="top">
                            
                            <div class="header">
    
    
</div>

                            
                            
                        <!--<component id="Page" label="headcontent"/>-->
                            
                        </div>
                        <div class="content">
                            <!-- site messages -->
                            <div class="container">
    <!-- Journal banner -->
    <div class="pmc-page-banner whole_rhythm"><div><img src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/logo-hal.gif" alt="Logo of hal" usemap="#logo-imagemap"><map id="logo-imagemap" name="logo-imagemap"><area alt="Link to Publisher&#39;s site" title="Link to Publisher&#39;s site" shape="default" coords="0,0,499,74" href="http://hal.archives-ouvertes.fr/" target="pmc_ext" ref="reftype=publisher&amp;article-id=2881565&amp;issue-id=187433&amp;journal-id=469&amp;FROM=Article%7CBanner&amp;TO=Publisher%7COther%7CN/A"></map></div> </div>
    
    <div class="">
        
        <div class="hide-overflow article lit-style content pmc-wm slang-all page-box report-printable"><!--main-content--><div><div class="fm-sec half_rhythm no_top_margin"><div class="fm-citation half_rhythm no_top_margin clearfix"><div class="inline_block eight_col va_top"><div><span id="pmcmata">IEEE Trans Med Imaging</span>. Author manuscript; available in PMC 2010 Jun 11.</div><div></div><div>Published in final edited form as:</div><div style="margin-left:1em"><div class="fm-vol-iss-date"><a href="https://www.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;retmode=ref&amp;cmd=prlinks&amp;id=18390341" target="pmc_ext" ref="reftype=publisher&amp;article-id=2881565&amp;issue-id=187433&amp;journal-id=469&amp;FROM=Article%7CFront%20Matter&amp;TO=Content%20Provider%7CArticle%7CRestricted%20Access"><span class="cit">IEEE Trans Med Imaging. 2008 Apr; 27(4): 425–441. </span></a></div> <span class="doi">doi:&nbsp;10.1109/TMI.2007.906087: 10.1109/TMI.2007.906087</span></div></div><div class="inline_block four_col va_top show-overflow align_right"><div class="fm-citation-ids"><div class="fm-citation-pmcid"><span class="fm-citation-ids-label">PMCID: </span><span>PMC2881565</span></div><div class="fm-citation-manuscriptid"><span class="fm-citation-ids-label">HALMS: </span><span>HALMS169658</span></div><div class="fm-citation-pmid">PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/18390341">18390341</a></div></div></div><div class="fm-doctopic no_margin">Inserm subrepository</div></div><h1 class="content-title">An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images</h1><div class="half_rhythm"><div class="contrib-group fm-author"><a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Coup%26%23x000e9%3B%20P%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341" class="affpopup" co-rid="_co_idm140650529672032" co-class="co-affbox">Pierrick Coupé</a>,<sup>1,</sup><sup>2,</sup><sup>3,</sup><sup>*</sup> <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Yger%20P%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341" class="affpopup" co-rid="_co_idm140650529656768" co-class="co-affbox">Pierre Yger</a>,<sup>1,</sup><sup>2,</sup><sup>4</sup> <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Prima%20S%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341" class="affpopup" co-rid="_co_idm140650529653072" co-class="co-affbox">Sylvain Prima</a>,<sup>1,</sup><sup>2</sup> <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Hellier%20P%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341" class="affpopup" co-rid="_co_idm140650529650112" co-class="co-affbox">Pierre Hellier</a>,<sup>1,</sup><sup>2</sup> <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Kervrann%20C%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341" class="affpopup" co-rid="_co_idm140650529647152" co-class="co-affbox">Charles Kervrann</a>,<sup>5,</sup><sup>6</sup> and  <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Barillot%20C%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341" class="affpopup" co-rid="_co_idm140650529644192" co-class="co-affbox">Christian Barillot</a><sup>1,</sup><sup>2</sup></div><div style="display:none" class="contrib-group aff-tip"><div id="_co_idm140650529672032"><h3 class="no_margin">Pierrick Coupé</h3><p><sup>1</sup>IRISA, Institut de Recherche en Informatique et Systèmes Aléatoires
CNRS : UMR6074, INRIA, Institut National des Sciences Appliquées de Rennes, Université de Rennes 1, Campus universitaire de Beaulieu - 35042 Rennes,FR</p><p><sup>2</sup>VISAGES U746, Unité/Projet VISAGES U746: Vision Action et Gestion d'Informations en Santé
INSERM : U746, CNRS : UMR6074, INRIA, Université de Rennes 1, IRISA, campus de Beaulieu F-35042 Rennes,FR</p><p><sup>3</sup>Montreal Neurological Institute
Université McGill, 3801 University Street, Montréal, Québec, H3A 2B4,CA</p><div>Find articles by <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Coup%26%23x000e9%3B%20P%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341">Pierrick Coupé</a></div></div><div id="_co_idm140650529656768"><h3 class="no_margin">Pierre Yger</h3><p><sup>1</sup>IRISA, Institut de Recherche en Informatique et Systèmes Aléatoires
CNRS : UMR6074, INRIA, Institut National des Sciences Appliquées de Rennes, Université de Rennes 1, Campus universitaire de Beaulieu - 35042 Rennes,FR</p><p><sup>2</sup>VISAGES U746, Unité/Projet VISAGES U746: Vision Action et Gestion d'Informations en Santé
INSERM : U746, CNRS : UMR6074, INRIA, Université de Rennes 1, IRISA, campus de Beaulieu F-35042 Rennes,FR</p><p><sup>4</sup>ENS Cachan, Ecole Normale Supérieure de Cachan
École normale supérieure de Cachan - ENS Cachan, FR</p><div>Find articles by <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Yger%20P%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341">Pierre Yger</a></div></div><div id="_co_idm140650529653072"><h3 class="no_margin">Sylvain Prima</h3><p><sup>1</sup>IRISA, Institut de Recherche en Informatique et Systèmes Aléatoires
CNRS : UMR6074, INRIA, Institut National des Sciences Appliquées de Rennes, Université de Rennes 1, Campus universitaire de Beaulieu - 35042 Rennes,FR</p><p><sup>2</sup>VISAGES U746, Unité/Projet VISAGES U746: Vision Action et Gestion d'Informations en Santé
INSERM : U746, CNRS : UMR6074, INRIA, Université de Rennes 1, IRISA, campus de Beaulieu F-35042 Rennes,FR</p><div>Find articles by <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Prima%20S%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341">Sylvain Prima</a></div></div><div id="_co_idm140650529650112"><h3 class="no_margin">Pierre Hellier</h3><p><sup>1</sup>IRISA, Institut de Recherche en Informatique et Systèmes Aléatoires
CNRS : UMR6074, INRIA, Institut National des Sciences Appliquées de Rennes, Université de Rennes 1, Campus universitaire de Beaulieu - 35042 Rennes,FR</p><p><sup>2</sup>VISAGES U746, Unité/Projet VISAGES U746: Vision Action et Gestion d'Informations en Santé
INSERM : U746, CNRS : UMR6074, INRIA, Université de Rennes 1, IRISA, campus de Beaulieu F-35042 Rennes,FR</p><div>Find articles by <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Hellier%20P%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341">Pierre Hellier</a></div></div><div id="_co_idm140650529647152"><h3 class="no_margin">Charles Kervrann</h3><p><sup>5</sup>MIA, Unité de recherche Mathématiques et Informatique Appliquées
INRA : UR0341, FR</p><p><sup>6</sup>INRIA - IRISA, VISTAS
INRIA, Institut National des Sciences Appliquées de Rennes, CNRS : UMR6074, Université de Rennes 1, École normale supérieure de Cachan - ENS Cachan, FR</p><div>Find articles by <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Kervrann%20C%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341">Charles Kervrann</a></div></div><div id="_co_idm140650529644192"><h3 class="no_margin">Christian Barillot</h3><p><sup>1</sup>IRISA, Institut de Recherche en Informatique et Systèmes Aléatoires
CNRS : UMR6074, INRIA, Institut National des Sciences Appliquées de Rennes, Université de Rennes 1, Campus universitaire de Beaulieu - 35042 Rennes,FR</p><p><sup>2</sup>VISAGES U746, Unité/Projet VISAGES U746: Vision Action et Gestion d'Informations en Santé
INSERM : U746, CNRS : UMR6074, INRIA, Université de Rennes 1, IRISA, campus de Beaulieu F-35042 Rennes,FR</p><div>Find articles by <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Barillot%20C%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=18390341">Christian Barillot</a></div></div></div></div><div class="fm-panel half_rhythm"><div class="fm-authors-info fm-panel half_rhythm"><div class="fm-affl" lang="en" id="A1"><sup>1</sup>IRISA, Institut de Recherche en Informatique et Systèmes Aléatoires
CNRS : UMR6074, INRIA, Institut National des Sciences Appliquées de Rennes, Université de Rennes 1, Campus universitaire de Beaulieu - 35042 Rennes,FR</div><div class="fm-affl" lang="en" id="A2"><sup>2</sup>VISAGES U746, Unité/Projet VISAGES U746: Vision Action et Gestion d'Informations en Santé
INSERM : U746, CNRS : UMR6074, INRIA, Université de Rennes 1, IRISA, campus de Beaulieu F-35042 Rennes,FR</div><div class="fm-affl" lang="en" id="A3"><sup>3</sup>Montreal Neurological Institute
Université McGill, 3801 University Street, Montréal, Québec, H3A 2B4,CA</div><div class="fm-affl" lang="en" id="A4"><sup>4</sup>ENS Cachan, Ecole Normale Supérieure de Cachan
École normale supérieure de Cachan - ENS Cachan, FR</div><div class="fm-affl" lang="en" id="A5"><sup>5</sup>MIA, Unité de recherche Mathématiques et Informatique Appliquées
INRA : UR0341, FR</div><div class="fm-affl" lang="en" id="A6"><sup>6</sup>INRIA - IRISA, VISTAS
INRIA, Institut National des Sciences Appliquées de Rennes, CNRS : UMR6074, Université de Rennes 1, École normale supérieure de Cachan - ENS Cachan, FR</div><div id="FN1">* Correspondence should be adressed to: Pierrick Coupé <a href="mailto:dev@null" data-email="moc.liamg@epuoc.kcirreip" class="oemail">moc.liamg@epuoc.kcirreip</a></div></div><div class="fm-article-notes fm-panel half_rhythm"></div><div class="permissions fm-panel half_rhythm"></div></div></div><div class="sec"></div><div id="idm140650597175088" lang="en" class="tsec sec"><h2 class="head no_bottom_margin" id="idm140650597175088title">Abstract</h2><!--article-meta--><div><p id="P1" class="p p-first-last">A critical issue in image restoration is the problem of noise removal while keeping the integrity of relevant image information. Denoising is a crucial step to increase image quality and to improve the performance of all the tasks needed for quantitative imaging analysis. The method proposed in this paper is based on a 3D optimized blockwise version of the Non Local (NL) means filter [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>]. The NL-means filter uses the redundancy of information in the image under study to remove the noise. The performance of the NL-means filter has been already demonstrated for 2D images, but reducing the computational burden is a critical aspect to extend the method to 3D images. To overcome this problem, we propose improvements to reduce the computational complexity. These different improvements allow to drastically divide the computational time while preserving the performances of the NL-means filter. A fully-automated and optimized version of the NL-means filter is then presented. Our contributions to the NL-means filter are: (a) an automatic tuning of the smoothing parameter, (b) a selection of the most relevant voxels, (c) a blockwise implementation and (d) a parallelized computation. Quantitative validation was carried out on synthetic datasets generated with BrainWeb [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R2" rid="R2" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474429">2</a>]. The results show that our optimized NL-means filter outperforms the classical implementation of the NL-means filter, as well as two other classical denoising methods (Anisotropic Diffusion [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>] and Total Variation minimization process [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R4" rid="R4" class=" bibr popnode">4</a>]) in terms of accuracy (measured by the Peak Signal to Noise Ratio) with low computation time. Finally, qualitative results on real data are presented.</p></div><div class="sec"><strong class="kwd-title">Keywords: </strong><span class="kwd-text">Algorithms, Artifacts, Brain, anatomy &amp; histology, Humans, Image Enhancement, methods, Image Interpretation, Computer-Assisted, methods, Imaging, Three-Dimensional, methods, Magnetic Resonance Imaging, methods, Reproducibility of Results, Sensitivity and Specificity, Signal Processing, Computer-Assisted</span></div></div><div id="S1" class="tsec sec"><h2 class="head no_bottom_margin" id="S1title">I. Introduction</h2><p id="P2" class="p p-first">Quantitative imaging involves image processing workflows (registration, segmentation, visualization, <em>etc.</em>) with increasing complexity and sensitivity to possible image artifacts. As a consequence, image processing procedures often require to remove image artifacts beforehand in order to make quantitative post-processing more robust and efficient. A critical issue concerns the problem of noise removal while keeping the integrity of relevant image information. This is particularly true for ultrasound images or magnetic resonance images (MRI) in presence of small structures with signals barely detectable above the noise level. In addition, a constant evolution of quantitative medical imaging is to process always larger cohorts of 3D data in order to find significant discriminants for a given pathology (e.g. see [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R5" rid="R5" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474430">5</a>]). In this context, complex automatic image processing workflows are required [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R6" rid="R6" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474443">6</a>] since human interpretation of images is no longer feasible. For effectiveness, these workflows have to be robust to a wide range of image qualities and parameter-free (or at least using auto-tuned parameters). This paper focuses on these critical aspects by introducing a new restoration scheme in the context of 3D medical imaging. The Non Local (NL-) means filter was originally introduced by Buades <em>et al.</em> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>] for 2D image denoising. The adaptation of this filter we propose for 3D images is based on (a) an automatic tuning of the smoothing parameter, (b) a selection of the most relevant voxels for the NL-means computation, (c) a blockwise implementation and (d) a parallelized computation. These different contributions allow to make the adapted filter fully-automated and above all to overcome the main limitation of the classical NL-means: the computational burden.</p><p id="P3" class="p p-last">Section II gives a short overview of the literature on image restoration. Section III presents the proposed method with details about our contributions. Sections IV, V and VI show (a) the impact of our adaptations compared to the classical NL-means implementation and (b) a comparison with respect to other well established denoising methods on Gaussian and Rician noise. Both validation experiments are performed on a phantom data set in a quantitative way. Section VII shows results on real data such as 3 Tesla T1-weighted (T1-w) MRI and T2-weighted (T2-w) MRI of a patient with Multiple Sclerosis (MS) lesions. In section VIII we propose a discussion on the applicability and the further improvements of the NL-means filter in the context of 3D medical imaging.</p></div><div id="S2" class="tsec sec"><h2 class="head no_bottom_margin" id="S2title">II. State-of-the-ART</h2><div id="S3" class="sec sec-first"><h3 id="S3title">A. General overview</h3><p id="P4" class="p p-first">Many methods have been proposed for edge-preserving image denoising. Some popular approaches include Bayesian approaches [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R7" rid="R7" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_311983610">7</a>], PDE-based approaches [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R4" rid="R4" class=" bibr popnode">4</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R8" rid="R8" class=" bibr popnode">8</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R9" rid="R9" class=" bibr popnode">9</a>], robust and regression estimation [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R10" rid="R10" class=" bibr popnode">10</a>], adaptive smoothing [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R11" rid="R11" class=" bibr popnode">11</a>], wavelet-based methods [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R12" rid="R12" class=" bibr popnode">12</a>]–[<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R14" rid="R14" class=" bibr popnode">14</a>], bilateral filtering [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R15" rid="R15" class=" bibr popnode">15</a>]–[<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R17" rid="R17" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474428">17</a>], local mode filtering [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R18" rid="R18" class=" bibr popnode">18</a>], hybrid approaches [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R19" rid="R19" class=" bibr popnode">19</a>]–[<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R21" rid="R21" class=" bibr popnode">21</a>].</p><p id="P5">Strong theoretical links exist between most of these techniques, as recently shown for local mode filtering [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R18" rid="R18" class=" bibr popnode">18</a>], bilateral filtering, anisotropic diffusion and robust estimation [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R17" rid="R17" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474433">17</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R22" rid="R22" class=" bibr popnode">22</a>] and adaptive smoothing [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R23" rid="R23" class=" bibr popnode">23</a>], anisotropic diffusion and total variation minimization scheme [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R24" rid="R24" class=" bibr popnode">24</a>].</p><p id="P6">More recently, some promising methods have been proposed for improved image denoising, based on statistical averaging schemes enhanced via incorporating a variable spatial neighborhood scheme [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R25" rid="R25" class=" bibr popnode">25</a>]–[<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R29" rid="R29" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_394258652">29</a>]. Other approaches consist in modeling non-local pairwise interactions from training data [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R30" rid="R30" class=" bibr popnode">30</a>] or a library of natural image patches [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R31" rid="R31" class=" bibr popnode">31</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R32" rid="R32" class=" bibr popnode">32</a>]. The idea is to improve the traditional Markov random field (MRF) models by learning potential functions from examples and extended neighborhoods for computer vision applications [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R30" rid="R30" class=" bibr popnode">30</a>]–[<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R32" rid="R32" class=" bibr popnode">32</a>]. Awate and Whitaker proposed another non-parametric patch-based method relying on comparisons between probability density functions [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R33" rid="R33" class=" bibr popnode">33</a>].</p><p id="P7" class="p p-last">Some of these techniques, generally developed for 2D images, have often been extended to 3D medical data, especially to MR images: anisotropic diffusion [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R34" rid="R34" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474440">34</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R35" rid="R35" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474425">35</a>], total variation [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R36" rid="R36" class=" bibr popnode">36</a>], bilateral filtering and variants [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R37" rid="R37" class=" bibr popnode">37</a>], wavelet-based filtering [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R38" rid="R38" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474427">38</a>]–[<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R42" rid="R42" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474435">42</a>], hybrid approaches [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R43" rid="R43" class=" bibr popnode">43</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R44" rid="R44" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_311983611">44</a>].</p></div><div id="S4" class="sec sec-last"><h3 id="S4title">B. Introduction of the NL-means filter</h3><p id="P8" class="p p-first">Most of the denoising methods restore the intensity value of each image voxel by averaging in some way the intensities of its (spatially) neighboring voxels. The basic and intuitive approach is to replace the value of the voxel by the average of the voxels in its neigbourhood (so-called box filtering [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R45" rid="R45" class=" bibr popnode">45</a>]). In practice, this filter has been shown to be outperformed by the Gaussian filter, which consists in weighting each voxel in the neighborhood according to its distance to the voxel under study. Both filters can be iterated until the desired amount of smoothing is reached. Such <em>data-independent</em> approaches can be implemented very efficiently. Their major drawback is that they blur the structures of interest in the image (e.g. edges or small structures and textures).</p><p id="P9">This has naturally led to <em>data-dependent</em> approaches, which aim at eliminating (or reducing the influence of) the neighboring voxels dissimilar to the voxel under study. Simple order statistic operators can be used for this purpose, such as the median filter, leading to a simple generalization of the box filter. More sophisticated approaches, based on image derivatives have been successfully proposed for many applications, such as adaptive smoothing [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R11" rid="R11" class=" bibr popnode">11</a>] and anisotropic diffusion [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>]. Neighborhood filters [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R46" rid="R46" class=" bibr popnode">46</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R47" rid="R47" class=" bibr popnode">47</a>] and variants [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R15" rid="R15" class=" bibr popnode">15</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R16" rid="R16" class=" bibr popnode">16</a>], have been also proposed and consist in averaging input data over the image voxels that are spatially close to the voxel under study and with similar gray-level values.</p><p id="P10" class="p p-last">All these techniques rely on the idea that the restored value of a voxel should only depend on the voxels in its spatial neighborhood that belong to the same <em>population</em>, that is the same image context. This has been termed by Michael Elad as the <em>locally adaptive recovery paradigm</em> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R17" rid="R17" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474441">17</a>]. Another approach has been recently proposed, that has shown very promising results. It is based on the idea that any natural image has redundancy, and that any voxel of the image has similar voxels that are not necessarily located in a spatial neighborhood. First introduced by Buades <em>et al.</em> in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>], the NL-means filter is based on this redundancy property of periodic images, textured images or natural images to remove noise. In this approach, the weight involving voxels in the average, does not depend on their spatial proximity to the current voxel but is based on the intensity similarity of their neighborhoods with the neighborhood of the voxel under study, as in patched-based approaches. In other words, the NL-means filter can be viewed as an extreme case of neighborhood filters with infinite spatial kernel and where the similarity of the neighborhood intensities is substituted to the point-wise similarity of gray levels as in commonly-used bilateral filtering. This new <em>non-local recovery paradigm</em> allows to combine the two most important attributes of a denoising algorithm: edge preservation and noise removal.</p></div></div><div id="S5" class="tsec sec"><h2 class="head no_bottom_margin" id="S5title">III. Methods</h2><p id="P11" class="p p-first">In the following, we introduce the notations:</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P12"><em>u</em> : Ω<sup>3</sup> ↦ ℝ is the image, where Ω<sup>3</sup> represents the grid of the image, considered as cubic for the sake of simplicity and without loss of generality (|Ω<sup>3</sup>| = <em>N</em><sup>3</sup>).</p></li><li><p id="P13">for the original voxelwise NL-means approach</p><ul class="simple" style="list-style-type:none"><!--
list-behavior=simple
prefix-word=
mark-type=none
max-label-size=0
--><li><p id="P14">– <em>u</em>(<em>x<sub>i</sub></em>) is the intensity observed at voxel <em>x<sub>i</sub></em>.</p></li><li><p id="P15">– <em>V<sub>i</sub></em> is the cubic search volume centered on voxel <em>x<sub>i</sub></em> of size |<em>V<sub>i</sub></em>| = (2<em>M</em> + 1)<sup>3</sup>, <em>M</em> ∈ ℕ.</p></li><li><p id="P16">– <em>N<sub>i</sub></em> is the cubic local neighborhood of <em>x<sub>i</sub></em> of size |<em>N<sub>i</sub></em>| = (2<em>d</em> + 1)<sup>3</sup>, <em>d</em> ∈ ℕ.</p></li><li><p id="P17">– <strong>u</strong>(<em>N<sub>i</sub></em>) = (<em>u</em><sup>(1)</sup>(<em>N<sub>i</sub></em>), …, <em>u</em><sup>(|</sup><em><sup>N<sub>i</sub></sup></em><sup>|)</sup>(<em>N<sub>i</sub></em>))<em><sup>T</sup></em> is the vector containing the intensities of <em>N<sub>i</sub></em>.</p></li><li><p id="P18">– <em>NL</em>(<em>u</em>)(<em>x<sub>i</sub></em>) is the restored value of voxel <em>x<sub>i</sub></em>.</p></li><li><p id="P19">– <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) is the weight of voxel <em>x<sub>j</sub></em> when restoring <em>u</em>(<em>x<sub>i</sub></em>).</p></li></ul></li><li><p id="P20">for the blockwise NL-means approach</p><ul class="simple" style="list-style-type:none"><!--
list-behavior=simple
prefix-word=
mark-type=none
max-label-size=0
--><li><p id="P21">– <em>B<sub>i</sub></em> is the block centered on <em>x<sub>i</sub></em> of size |<em>B<sub>i</sub></em>| = (2<em>α</em> + 1)<sup>3</sup>, <em>α</em> ∈ ℕ.</p></li><li><p id="P22">– <strong>u</strong>(<em>B<sub>i</sub></em>) is the vector containing the intensities of the block <em>B<sub>i</sub></em>.</p></li><li><p id="P23">– <strong>NL</strong>(<em>u</em>)(<em>B<sub>i</sub></em>) is the vector containing the restored value of <em>B<sub>i</sub></em>.</p></li><li><p id="P24">– <em>w</em>(<em>B<sub>i</sub></em>, <em>B<sub>j</sub></em>) is the weight of block <em>B<sub>j</sub></em> when restoring the block <strong>u</strong>(<em>B<sub>i</sub></em>).</p></li><li><p id="P25">– the blocks <em>B<sub>i<sub>k</sub></sub></em> are centered on voxels <em>x<sub>i<sub>k</sub></sub></em> with <em>i<sub>k</sub></em> = (<em>k</em><sub>1</sub><em>n</em>, <em>k</em><sub>2</sub><em>n</em>, <em>k</em><sub>3</sub><em>n</em>), (<em>k</em><sub>1</sub>, <em>k</em><sub>2</sub>, <em>k</em><sub>3</sub>) ∈ ℕ<sup>3</sup> and <em>n</em> represents the distance between the centers of the blocks <em>B<sub>i<sub>k</sub></sub></em>.</p></li></ul></li></ul><div id="S6" class="sec"><h3 id="S6title">A. The Non Local means filter</h3><p id="P26" class="p p-first">In the classical formulation of the NL-means filter, the restored intensity <em>NL</em>(<em>u</em>)(<em>x<sub>i</sub></em>) of the voxel <em>x<sub>i</sub></em>, is the weighted average of all the voxel intensities in the image <em>u</em> defined as: 
</p><div class="disp-formula" id="FD1"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="M1" overflow="scroll" role="math" style="width: 15.123em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.2em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.414em, 1012.15em, 4.287em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mrow" id="MathJax-Span-3"><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-5" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-8" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-10"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-14" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="munder" id="MathJax-Span-16" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.255em;"><span class="mo" id="MathJax-Span-17" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.82em, 4.438em, -999.997em); top: -2.669em; left: 0.003em;"><span class="mrow" id="MathJax-Span-18"><span class="msub" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.305em;"><span class="mi" id="MathJax-Span-22" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msup" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.282em; left: 0.507em;"><span class="mn" id="MathJax-Span-27" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-28" style="padding-left: 0.204em;"><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-30" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-36" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-41" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-42" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.059em; border-left: 0px solid; width: 0px; height: 3.316em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-1"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="block" overflow="scroll"><mrow><mi>N</mi><mi>L</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo>∈</mo><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup></mrow></munder><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mi>u</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></script></div><div class="l">(1)</div></div><p> where <em>u</em>(<em>x<sub>j</sub></em>) is the intensity of voxel <em>x<sub>j</sub></em> and <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) is the weight assigned to <em>u</em>(<em>x<sub>j</sub></em>) in the restoration of voxel <em>x<sub>i</sub></em>. More precisely, the weight quantifies the similarity of the local neighborhoods <em>N<sub>i</sub></em> and <em>N<sub>j</sub></em> of the voxels <em>x<sub>i</sub></em> and <em>x<sub>j</sub></em> under the assumptions that <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) ∈ [0, 1] and Σ<sub><em>x</em><sub><em>j</em></sub>∈ Ω<sup>3</sup></sub> <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) = 1 (cf <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F1/" target="figure" class="fig-table-link figpopup" rid-figpopup="F1" rid-ob="ob-F1" co-legend-rid="lgnd_F1"><span>Fig. 1</span></a> left). The classical definition of the NL-means filter considers that each voxel can be linked to all the others, but for practical computational reasons the number of voxels taken into account in the weighted average can be limited to the so-called “search volume” <em>V<sub>i</sub></em> of size (2<em>M</em>+1)<sup>3</sup>, centered at the current voxel <em>x<sub>i</sub></em>.</p><p id="P27">For each voxel <em>x<sub>j</sub></em> in <em>V<sub>i</sub></em>, the Gaussian-weighted Euclidean distance 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M2" overflow="scroll" role="math" style="width: 2.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.048em, 1002.27em, 1.515em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.16em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-52"><span class="mo" id="MathJax-Span-53" style="font-family: STIXGeneral-Regular;">∥</span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular;">·</span><span class="mo" id="MathJax-Span-55" style="font-family: STIXGeneral-Regular;">∥</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.383em; left: 1.313em;"><span class="mn" id="MathJax-Span-56" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.96em, 4.236em, -999.997em); top: -3.727em; left: 1.313em;"><span class="mrow" id="MathJax-Span-57"><span class="mn" id="MathJax-Span-58" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-59" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-2"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" overflow="scroll"><mrow><msubsup><mrow><mo>∥</mo><mo>·</mo><mo>∥</mo></mrow><mrow><mn>2</mn><mo>,</mo><mi>a</mi></mrow><mn>2</mn></msubsup></mrow></math></script> defined in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>], is computed between <strong>u</strong>(<em>N<sub>j</sub></em>) and <strong>u</strong>(<em>N<sub>i</sub></em>). This distance is a classical <em>L</em><sub>2</sub> norm convolved with a Gaussian kernel of standard deviation <em>a</em>, and measures the distance between neighborhood intensities. Given this distance, <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) is computed as follows: 
</p><div class="disp-formula" id="FD2"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="M3" overflow="scroll" role="math" style="width: 13.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.789em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.456em, 1010.79em, 3.531em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-65" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-70" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-71" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-76" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-77" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-78" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1000.81em, 4.287em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.401em;"><span class="mrow" id="MathJax-Span-79"><span class="msub" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: STIXGeneral-Italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.96em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.96em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="msup" id="MathJax-Span-84"><span style="display: inline-block; position: relative; width: 5.144em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-85"><span class="mi" id="MathJax-Span-86" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.534em; left: 0.456em;"><span class="mrow" id="MathJax-Span-87"><span class="mo" id="MathJax-Span-88" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mstyle" id="MathJax-Span-89"><span class="mrow" id="MathJax-Span-90"><span class="mfrac" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 3.884em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1003.78em, 4.488em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.862em;"><span class="mrow" id="MathJax-Span-92"><span class="msubsup" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 3.783em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.03em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-94"><span class="mo" id="MathJax-Span-95" style="vertical-align: 0.507em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.324em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-96" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-97" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-101" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-103" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-104" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-105" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-109" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-110" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-111" style="vertical-align: 0.507em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.324em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.282em; left: 3.128em;"><span class="mn" id="MathJax-Span-112" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.66em, 4.186em, -999.997em); top: -3.677em; left: 3.128em;"><span class="mrow" id="MathJax-Span-113"><span class="mn" id="MathJax-Span-114" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-115" style="font-size: 50%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-116" style="font-size: 50%; font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.56em, 4.136em, -999.997em); top: -3.526em; left: 50%; margin-left: -0.249em;"><span class="mrow" id="MathJax-Span-117"><span class="msup" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-size: 50%; font-family: STIXGeneral-Italic;">h</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.131em; left: 0.255em;"><span class="mn" id="MathJax-Span-121" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1003.88em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.884em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-3"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="block" overflow="scroll"><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mrow><mi>Z</mi></mrow><mi>i</mi></msub></mrow></mfrac><msup><mrow><mi>e</mi></mrow><mrow><mo>−</mo><mstyle scriptlevel="1"><mfrac><mrow><msubsup><mrow><mo>∥</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∥</mo></mrow><mrow><mn>2</mn><mo>,</mo><mi>a</mi></mrow><mn>2</mn></msubsup></mrow><mrow><msup><mrow><mi>h</mi></mrow><mn>2</mn></msup></mrow></mfrac></mstyle></mrow></msup></mrow></math></script></div><div class="l">(2)</div></div><p> where <em>Z<sub>i</sub></em> is a normalization constant ensuring that Σ<em><sub>j</sub> w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) = 1, and <em>h</em> acts as a smoothing parameter controlling the decay of the exponential function. When <em>h</em> is very high, all the voxels <em>x<sub>j</sub></em> in <em>V<sub>i</sub></em> will have the same weight <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) with respect to the voxel <em>x<sub>i</sub></em>. The restored value <em>NL</em>(<em>u</em>)(<em>x<sub>i</sub></em>) will be then approximately the average of the intensity values of the voxels in <em>V<sub>i</sub></em> leading to strong smoothing of the image. When <em>h</em> is very low, the decay of the exponential function will be strong, thus only few voxels <em>x<sub>j</sub></em> in <em>V<sub>i</sub></em> with <em>u</em>(<em>N<sub>j</sub></em>) very similar to <em>u</em>(<em>N<sub>j</sub></em>) will have a significant weight. The restored value <em>NL</em>(<em>u</em>)(<em>x<sub>i</sub></em>) will tend to be the weighted average of some voxels with a similar neighborhood to current voxel <em>x<sub>i</sub></em> leading to a weak smoothing of the image. In Section III-B.1, a trade-off has then to be found, and we propose a method to automatically estimate the optimal value of <em>h</em>.</p><p id="P28" class="p p-last">In [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>], Buades <em>et al.</em> show that, for 2D natural images, the NL-means filter outperforms state-of-the-art denoising methods such as the Rudin-Osher-Fatemi Total Variation minimization scheme [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R4" rid="R4" class=" bibr popnode">4</a>], the Perona-Malik Anisotropic diffusion [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>] or translation invariant wavelet thresholding [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R48" rid="R48" class=" bibr popnode">48</a>]. Nevertheless, the main drawback of the NL-means filter is the computational burden due to its complexity, especially for 3D images. Indeed, for each voxel of the volume, distances between the intensity neighborhoods <strong>u</strong>(<em>N<sub>i</sub></em>) and <strong>u</strong>(<em>N<sub>j</sub></em>) for all the voxels <em>x<sub>j</sub></em> contained in <em>V<sub>i</sub></em> need to be computed. Let <em>N</em><sup>3</sup> denote the size of the 3D image, then the complexity of the filter is in the order of <img alt="An external file that holds a picture, illustration, etc.
Object name is halms169658ig2.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658ig2.jpg">((<em>N</em>(2<em>M</em>+1)(2<em>d</em>+1))<sup>3</sup>). For a 3D MRI of size 181 × 217 × 181 with the smallest possible value for <em>d</em> and <em>M</em> (<em>d</em> = 1 and <em>M</em> = 5), the computational time reaches up to 6 hours on 3 GHz CPU. This time is far beyond a reasonable duration expected for a denoising filter in a medical practice. For this reason, we propose several adaptations to reduce the computational burden which are detailed in Section III-B. We also show that these adaptations improve the quality of the denoising compared to the classical implementation.</p></div><div id="S7" class="sec sec-last"><h3 id="S7title">B. Improvements of the NL-means filter</h3><div id="S8" class="sec sec-first"><p></p><h4 id="S8title" class="inline">1.  Automatic tuning of the Smoothing parameter h </h4><p id="P29" class="p p-first">According to [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>], the smoothing parameter <em>h</em> depends on the standard deviation of the noise <em>σ</em>, and typically a good choice for 2D images is <em>h</em> ≈ 10<em>σ</em>. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD2" rid="FD2" class=" disp-formula">Equation 2</a> shows that <em>h</em> also needs to take into account |<em>N<sub>i</sub></em>|, if we want a filter independent of the neighborhood size. Indeed, the <em>L</em><sub>2</sub> norm increasing with |<em>N<sub>i</sub></em>|, <em>h</em> needs also to be increased to obtain an equivalent filter. The automatic tuning of the smoothing parameter <em>h</em> comes to determine the relationship <em>h</em><sup>2</sup> = <em>f</em>(<em>σ</em><sup>2</sup>, |<em>N<sub>i</sub></em>|, <em>β</em>) where <em>β</em> is a constant. Let us show how we can estimate this relationship:</p><ol class="enumerated" style="list-style-type:lower-alpha"><!--
list-behavior=enumerated
prefix-word=
mark-type=lower-alpha
max-label-size=0
--><li><p id="P30">In case of an additive white Gaussian noise, the standard deviation of noise can be estimated <em>via</em> pseudo-residuals <em>ε<sub>i</sub></em> as defined in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R49" rid="R49" class=" bibr popnode">49</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R50" rid="R50" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_394258650">50</a>]. For each voxel <em>x<sub>i</sub></em> of the volume Ω<sup>3</sup>, let us define:</p><p id="P98">
</p><div class="disp-formula" id="FD3"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="M4" overflow="scroll" role="math" style="width: 16.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.906em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.313em, 1012.86em, 5.043em, -999.997em); top: -3.425em; left: 0.003em;"><span class="mrow" id="MathJax-Span-123"><span class="mrow" id="MathJax-Span-124"><span class="msub" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-128" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-129" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="msqrt" id="MathJax-Span-130" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1000.86em, 4.841em, -999.997em); top: -3.979em; left: 1.111em;"><span class="mrow" id="MathJax-Span-131"><span class="mrow" id="MathJax-Span-132"><span class="mfrac" id="MathJax-Span-133"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-134" style="font-family: STIXGeneral-Regular;">6</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1000.46em, 4.136em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-135" style="font-family: STIXGeneral-Regular;">7</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.61em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.607em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.027em, 1000.91em, 3.38em, -999.997em); top: -4.685em; left: 1.111em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.003em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.406em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(1.767em, 1001.16em, 4.539em, -999.997em); top: -3.475em; left: 0.003em;"><span style="font-family: STIXSizeTwoSym;">√</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-136" style="padding-left: 0.204em;"><span class="mo" id="MathJax-Span-137" style="vertical-align: 1.968em;"><span style="display: inline-block; position: relative; width: 0.456em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.274em; left: 0.003em;">⎛<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.854em; left: 0.003em;">⎝<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.467em; left: 0.003em;">⎜<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.661em; left: 0.003em;">⎜<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-145" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-146" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">−</span><span class="mfrac" id="MathJax-Span-147" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-148" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.136em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-149" style="font-family: STIXGeneral-Regular;">6</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.61em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.607em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="munder" id="MathJax-Span-150" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.154em;"><span class="mo" id="MathJax-Span-151" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.62em, 4.438em, -999.997em); top: -2.82em; left: 0.003em;"><span class="mrow" id="MathJax-Span-152"><span class="msub" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-154"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.305em;"><span class="mi" id="MathJax-Span-156" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msub" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.456em;"><span class="mi" id="MathJax-Span-161" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-162" style="padding-left: 0.204em;"><span class="mi" id="MathJax-Span-163" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-164" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-169" style="font-family: STIXGeneral-Regular;">)</span></span></span><span class="mo" id="MathJax-Span-170" style="vertical-align: 1.968em;"><span style="display: inline-block; position: relative; width: 0.456em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.274em; left: 0.003em;">⎞<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.854em; left: 0.003em;">⎠<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.467em; left: 0.003em;">⎟<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.661em; left: 0.003em;">⎟<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.872em; border-left: 0px solid; width: 0px; height: 4.378em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-4"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="block" overflow="scroll"><mrow><msub><mrow><mi>ε</mi></mrow><mi>i</mi></msub><mo>=</mo><msqrt><mrow><mfrac><mn>6</mn><mn>7</mn></mfrac></mrow></msqrt><mrow><mo>(</mo><mrow><mi>u</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><munder><mo>∑</mo><mrow><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo>∈</mo><msub><mrow><mi>P</mi></mrow><mi>i</mi></msub></mrow></munder><mrow><mi>u</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow></mrow></math></script></div><div class="l">(3)</div></div><p></p><p id="P31"><em>P<sub>i</sub></em> being the 6-neighborhood at voxel <em>x<sub>i</sub></em> and the constant 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M5" overflow="scroll" role="math" style="width: 2.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.053em, 1002.02em, 1.313em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="msqrt" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.21em, 4.136em, -999.997em); top: -3.979em; left: 0.759em;"><span class="mrow" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="mn" id="MathJax-Span-177" style="font-family: STIXGeneral-Regular;">6</span><span class="mo" id="MathJax-Span-178" style="font-family: STIXGeneral-Regular;">/</span><span class="mn" id="MathJax-Span-179" style="font-family: STIXGeneral-Regular;">7</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.027em, 1001.31em, 3.38em, -999.997em); top: -3.979em; left: 0.759em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.003em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.809em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.406em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1000.76em, 4.136em, -999.997em); top: -3.879em; left: 0.003em;"><span style="font-family: STIXVariants;">√</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-5"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" overflow="scroll"><mrow><msqrt><mrow><mn>6</mn><mo>/</mo><mn>7</mn></mrow></msqrt></mrow></math></script> is used to ensure that 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M6" overflow="scroll" role="math" style="width: 5.597em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.488em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.414em, 1004.49em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral-Regular;">𝔼</span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral-Italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.456em;"><span class="mn" id="MathJax-Span-188" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.25em, 4.136em, -999.997em); top: -3.677em; left: 0.456em;"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-191" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="msup" id="MathJax-Span-192" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-193"><span class="mover" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mi" id="MathJax-Span-195" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1000.56em, 3.581em, -999.997em); top: -3.979em; left: 0.053em;"><span class="mo" id="MathJax-Span-196" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.483em; left: 0.607em;"><span class="mn" id="MathJax-Span-197" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-6"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" overflow="scroll"><mrow><mi mathvariant="double-struck">E</mi><mo stretchy="false">[</mo><msubsup><mrow><mi>ε</mi></mrow><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">]</mo><mo>=</mo><msup><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><mn>2</mn></msup></mrow></math></script> in homogeneous areas. Thus, the standard deviation of noise <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-198" role="math" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.104em, 1000.61em, 1.171em, -999.997em); top: -1.014em; left: 0.003em;"><span class="mrow" id="MathJax-Span-199"><span class="mover" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.51em, 4.169em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-201" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1000.56em, 3.61em, -999.997em); top: -4.012em; left: 0.053em;"><span class="mo" id="MathJax-Span-202" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.019em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-7"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em> is computed as the least square estimator:</p><p id="P99">
</p><div class="disp-formula" id="FD4"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="M7" overflow="scroll" role="math" style="width: 8.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.16em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.011em, 1007.16em, 4.085em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="msup" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-207"><span class="mover" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1000.56em, 3.581em, -999.997em); top: -3.979em; left: 0.053em;"><span class="mo" id="MathJax-Span-210" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.483em; left: 0.607em;"><span class="mn" id="MathJax-Span-211" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-212" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-213" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-214" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.976em, 1001.62em, 4.539em, -999.997em); top: -3.122em; left: 50%; margin-left: -0.854em;"><span class="mrow" id="MathJax-Span-215"><span class="mo" id="MathJax-Span-216" style="vertical-align: 0.859em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.274em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -2.921em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msup" id="MathJax-Span-217"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.759em;"><span class="mn" id="MathJax-Span-220" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="vertical-align: 0.859em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.274em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -2.921em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.82em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.817em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="munder" id="MathJax-Span-222" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.515em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.103em;"><span class="mo" id="MathJax-Span-223" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.51em, 4.236em, -999.997em); top: -2.669em; left: 0.003em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.282em; left: 0.507em;"><span class="mn" id="MathJax-Span-230" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-231" style="padding-left: 0.204em;"><span class="msubsup" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-family: STIXGeneral-Italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.456em;"><span class="mn" id="MathJax-Span-235" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.25em, 4.136em, -999.997em); top: -3.677em; left: 0.456em;"><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-8"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="block" overflow="scroll"><mrow><msup><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mo>∣</mo><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup><mo>∣</mo></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup></mrow></munder><mrow><msubsup><mrow><mi>ε</mi></mrow><mi>i</mi><mn>2</mn></msubsup></mrow></mrow></math></script></div><div class="l">(4)</div></div><p></p></li><li><p id="P32">Initially, the NL-means filter was defined with a Gaussian-weighted Euclidean distance, 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M8" overflow="scroll" role="math" style="width: 2.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.048em, 1002.27em, 1.515em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-238"><span class="mrow" id="MathJax-Span-239"><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.16em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-241"><span class="mo" id="MathJax-Span-242" style="font-family: STIXGeneral-Regular;">∥</span><span class="mo" id="MathJax-Span-243" style="font-family: STIXGeneral-Regular;">·</span><span class="mo" id="MathJax-Span-244" style="font-family: STIXGeneral-Regular;">∥</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.383em; left: 1.313em;"><span class="mn" id="MathJax-Span-245" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.96em, 4.236em, -999.997em); top: -3.727em; left: 1.313em;"><span class="mrow" id="MathJax-Span-246"><span class="mn" id="MathJax-Span-247" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-248" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-9"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" overflow="scroll"><mrow><msubsup><mrow><mo>∥</mo><mo>·</mo><mo>∥</mo></mrow><mrow><mn>2</mn><mo>,</mo><mi>a</mi></mrow><mn>2</mn></msubsup></mrow></math></script> defined in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>]. However, in order to make the filter independent of |<em>N<sub>i</sub></em>|, to simplify the complexity of the problem, and to reduce the computational time, we used the classical Euclidean distance 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M9" overflow="scroll" role="math" style="width: 2.119em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.716em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.048em, 1001.72em, 1.414em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="msubsup" id="MathJax-Span-253"><span style="display: inline-block; position: relative; width: 1.716em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.16em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-254"><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral-Regular;">∥</span><span class="mo" id="MathJax-Span-256" style="font-family: STIXGeneral-Regular;">·</span><span class="mo" id="MathJax-Span-257" style="font-family: STIXGeneral-Regular;">∥</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.383em; left: 1.313em;"><span class="mn" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.727em; left: 1.313em;"><span class="mn" id="MathJax-Span-259" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-10"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" overflow="scroll"><mrow><msubsup><mrow><mo>∥</mo><mo>·</mo><mo>∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></math></script> normalized by the number of elements:</p><p id="P100">
</p><div class="disp-formula" id="FD5"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="M10" overflow="scroll" role="math" style="width: 27.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.23em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.557em, 1022.18em, 4.085em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mfrac" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.36em, 4.337em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.754em;"><span class="mrow" id="MathJax-Span-265"><span class="mo" id="MathJax-Span-266" style="font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-271" style="font-family: STIXGeneral-Regular;">∣</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.62em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.615em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 7.009em; height: 0px;"><span style="position: absolute; clip: rect(3.027em, 1006.45em, 4.438em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-273"><span class="mo" id="MathJax-Span-274" style="vertical-align: 0.809em;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.274em; left: 0.003em;">∥<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.072em; left: 0.003em;">∥<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-275" style="font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-277"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-280" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-281" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-282" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">−</span><span class="mi" id="MathJax-Span-283" style="font-family: STIXGeneral; font-weight: bold; padding-left: 0.255em;">u</span><span class="mo" id="MathJax-Span-284" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-288" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-289" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-290" style="vertical-align: 0.809em;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.274em; left: 0.003em;">∥<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.072em; left: 0.003em;">∥<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.483em; left: 6.555em;"><span class="mn" id="MathJax-Span-291" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.627em; left: 6.555em;"><span class="mn" id="MathJax-Span-292" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-293" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-294" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-295" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.36em, 4.337em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.754em;"><span class="mrow" id="MathJax-Span-296"><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-302" style="font-family: STIXGeneral-Regular;">∣</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.62em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.615em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="munderover" id="MathJax-Span-303" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-304" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.11em, 4.388em, -999.997em); top: -2.82em; left: 0.053em;"><span class="mrow" id="MathJax-Span-305"><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-307" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-308" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1000.96em, 4.287em, -999.997em); top: -5.189em; left: 0.154em;"><span class="mrow" id="MathJax-Span-309"><span class="mo" id="MathJax-Span-310" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-312"><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.456em;"><span class="mi" id="MathJax-Span-314" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-315" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∣</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-316" style="padding-left: 0.204em;"><span class="msup" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 8.319em; height: 0px;"><span style="position: absolute; clip: rect(2.926em, 1007.82em, 4.438em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="mo" id="MathJax-Span-320" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-321"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.507em;"><span class="mrow" id="MathJax-Span-324"><span class="mo" id="MathJax-Span-325" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-330"><span class="mi" id="MathJax-Span-331" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-332" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-333" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-334" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">−</span><span class="msup" id="MathJax-Span-335" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.507em;"><span class="mrow" id="MathJax-Span-338"><span class="mo" id="MathJax-Span-339" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-340" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-341" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-342" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-343"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-347" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-348" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.584em; left: 7.865em;"><span class="mn" id="MathJax-Span-349" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-350" style="font-family: STIXGeneral-Regular;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 4.128em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-11"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="block" overflow="scroll"><mrow><mfrac><mn>1</mn><mrow><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac><msubsup><mrow><mo>∥</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></munderover><mrow><msup><mrow><mrow><mo stretchy="false">(</mo><msup><mrow><mi>u</mi></mrow><mrow><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msup><mrow><mi>u</mi></mrow><mrow><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>.</mo></mrow></math></script></div><div class="l">(5)</div></div><p></p><p id="P33">Finally, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD2" rid="FD2" class=" disp-formula">Equation 2</a> becomes:</p><p id="P101">
</p><div class="disp-formula" id="FD6"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="M11" overflow="scroll" role="math" style="width: 12.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.386em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.103em, 1010.39em, 3.531em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-355" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-356"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-357"><span class="mi" id="MathJax-Span-358" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-360" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-361" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-365" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-366" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-367" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-368" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1000.81em, 4.287em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.401em;"><span class="mrow" id="MathJax-Span-369"><span class="msub" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: STIXGeneral-Italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.96em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.96em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="msup" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 4.74em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.987em; left: 0.456em;"><span class="mrow" id="MathJax-Span-377"><span class="mo" id="MathJax-Span-378" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mstyle" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="mfrac" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 3.531em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1003.38em, 4.438em, -999.997em); top: -4.584em; left: 50%; margin-left: -1.711em;"><span class="mrow" id="MathJax-Span-382"><span class="msubsup" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.03em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-384"><span class="mo" id="MathJax-Span-385" style="vertical-align: 0.507em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.324em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-386" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-387" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-388"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-391" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-392" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-393" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-394" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-395" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-399" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-400" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-401" style="vertical-align: 0.507em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.324em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.282em; left: 3.128em;"><span class="mn" id="MathJax-Span-402" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.677em; left: 3.128em;"><span class="mn" id="MathJax-Span-403" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.82em, 4.488em, -999.997em); top: -3.425em; left: 50%; margin-left: -0.955em;"><span class="mrow" id="MathJax-Span-404"><span class="mn" id="MathJax-Span-405" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-406" style="font-size: 50%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-407"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-408"><span class="mover" id="MathJax-Span-409"><span style="display: inline-block; position: relative; width: 0.305em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mi" id="MathJax-Span-410" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.43em, 1000.3em, 3.884em, -999.997em); top: -4.03em; left: 0.053em;"><span class="mo" id="MathJax-Span-411" style=""><span><span style="font-size: 50%; font-family: STIXSizeOneSym;">ˆ</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.305em;"><span class="mn" id="MathJax-Span-412" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-413" style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-414"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-417" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-418" style="vertical-align: 0.607em;"><span style="display: inline-block; position: relative; width: 0.154em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.122em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1003.53em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.531em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 4.003em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-12"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="block" overflow="scroll"><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mrow><mi>Z</mi></mrow><mi>i</mi></msub></mrow></mfrac><msup><mrow><mi>e</mi></mrow><mrow><mo>−</mo><mstyle scriptlevel="1"><mfrac><mrow><msubsup><mrow><mo>∥</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><mi>β</mi><msup><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><mn>2</mn></msup><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac></mstyle></mrow></msup></mrow></math></script></div><div class="l">(6)</div></div><p></p><p id="P34">where only the adjusting constant <em>β</em> needs to be manually tuned. In the case of Gaussian noise, <em>β</em> is theoretically be close to 1 (see [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R51" rid="R51" class=" bibr popnode">51</a>] p. 21 for theoretical justification) if the estimation <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-419" role="math" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.104em, 1000.61em, 1.171em, -999.997em); top: -1.014em; left: 0.003em;"><span class="mrow" id="MathJax-Span-420"><span class="mover" id="MathJax-Span-421"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.51em, 4.169em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-422" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1000.56em, 3.61em, -999.997em); top: -4.012em; left: 0.053em;"><span class="mo" id="MathJax-Span-423" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.019em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-13"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em> of the standard deviation of the noise is correct. The adjustment of <em>β</em> will be discussed in section V-A.</p></li></ol></div><div id="S9" class="sec"><p></p><h4 id="S9title" class="inline">2.  Voxel selection in the search volume </h4><p id="P35" class="p p-first-last">To deal with computational burden, Mahmoudi and Sapiro [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R52" rid="R52" class=" bibr popnode">52</a>] recently proposed a method to preselect a subset of the most relevant voxels <em>x<sub>j</sub></em> in <em>V<sub>i</sub></em> to avoid useless weight computations. In other words, the main idea is to select only the voxels <em>x<sub>j</sub></em> in <em>V<sub>i</sub></em> that will have the highest weights <em>w</em>(<em>x<sub>i</sub></em>, <em>x<sub>j</sub></em>) in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD1" rid="FD1" class=" disp-formula">Equation 1</a> without having to compute all the Euclidean distances between <strong>u</strong>(<em>N<sub>i</sub></em>) and <strong>u</strong>(<em>N<sub>j</sub></em>). <em>A priori</em> neglecting the voxels which are expected to have small weights tends to speed up the filter and to improve the results (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T2/" target="table" class="fig-table-link figpopup" rid-figpopup="T2" rid-ob="ob-T2" co-legend-rid=""><span>Table II</span></a>). In [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R52" rid="R52" class=" bibr popnode">52</a>], this selection is based on the similarity of the mean value of <strong>u</strong>(<em>N<sub>i</sub></em>) and <strong>u</strong>(<em>N<sub>j</sub></em>), and on the similarity of the average over the neighborhoods <em>N<sub>i</sub></em> and <em>N<sub>j</sub></em> of the gradient orientation at pixel <em>x<sub>i</sub></em> and <em>x<sub>j</sub></em>. Intuitively, similar neighborhoods have the same mean and the same gradient orientation. The computation of the gradient orientation is very sensitive to noise and thus requires robust estimation techniques. This is too computationally expensive for medical applications. For this reason, in our implementation, the preselection of voxels in <em>V<sub>i</sub></em> is based on the mean and the variance of <strong>u</strong>(<em>N<sub>i</sub></em>) and <strong>u</strong>(<em>N<sub>j</sub></em>) which allows to decrease the computational burden. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F2/" target="figure" class="fig-table-link figpopup" rid-figpopup="F2" rid-ob="ob-F2" co-legend-rid="lgnd_F2"><span>Figure 2</span></a> shows that the maps of local means and local variances are simple estimators allowing to discriminate different tissue classes and edges in images. In this way, the maps of local means and local variances are precomputed in order to avoid repetitive calculations for the same neighborhood. The selection tests can be expressed as follows: 
</p><div class="disp-formula" id="FD7"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="M12" overflow="scroll" role="math" style="width: 34.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.623em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.313em, 1027.47em, 6.152em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-425"><span class="mrow" id="MathJax-Span-426"><span class="mi" id="MathJax-Span-427" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-428" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-429"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-432" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-433" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-434" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-439" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mrow" id="MathJax-Span-440" style="padding-left: 0.305em;"><span class="mo" id="MathJax-Span-441" style="vertical-align: 2.523em;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.274em; left: 0.003em;">⎧<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.255em; left: 0.003em;">⎩<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.51em; left: 0.003em;">⎨<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.417em; left: 0.003em;">⎪<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.653em; left: 0.003em;">⎪<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-442"><span class="mtable" id="MathJax-Span-443" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 22.18em; height: 0px;"><span style="position: absolute; clip: rect(2.674em, 1005.6em, 7.311em, -999.997em); top: -5.34em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 5.597em; height: 0px;"><span style="position: absolute; clip: rect(1.565em, 1005.6em, 4.589em, -999.997em); top: -4.181em; left: 0.003em;"><span class="mtd" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mrow" id="MathJax-Span-446"><span class="mstyle" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="mfrac" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-450" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.287em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.249em;"><span class="mrow" id="MathJax-Span-451"><span class="msub" id="MathJax-Span-452"><span style="display: inline-block; position: relative; width: 0.456em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-size: 50%; font-family: STIXGeneral-Italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mi" id="MathJax-Span-455" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.56em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.557em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="msup" id="MathJax-Span-456"><span style="display: inline-block; position: relative; width: 4.74em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.987em; left: 0.456em;"><span class="mrow" id="MathJax-Span-459"><span class="mo" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mstyle" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mfrac" id="MathJax-Span-463"><span style="display: inline-block; position: relative; width: 3.531em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1003.38em, 4.438em, -999.997em); top: -4.584em; left: 50%; margin-left: -1.711em;"><span class="mrow" id="MathJax-Span-464"><span class="msubsup" id="MathJax-Span-465"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.03em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-466"><span class="mo" id="MathJax-Span-467" style="vertical-align: 0.507em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.324em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-468" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-469" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-473" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-474" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-475" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-476" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-477" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-481" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-482" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-483" style="vertical-align: 0.507em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.324em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.282em; left: 3.128em;"><span class="mn" id="MathJax-Span-484" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.677em; left: 3.128em;"><span class="mn" id="MathJax-Span-485" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.82em, 4.488em, -999.997em); top: -3.425em; left: 50%; margin-left: -0.955em;"><span class="mrow" id="MathJax-Span-486"><span class="mn" id="MathJax-Span-487" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-488" style="font-size: 50%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-489"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-490"><span class="mover" id="MathJax-Span-491"><span style="display: inline-block; position: relative; width: 0.305em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mi" id="MathJax-Span-492" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.43em, 1000.3em, 3.884em, -999.997em); top: -4.03em; left: 0.053em;"><span class="mo" id="MathJax-Span-493" style=""><span><span style="font-size: 50%; font-family: STIXSizeOneSym;">ˆ</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.305em;"><span class="mn" id="MathJax-Span-494" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-495" style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-496"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-497"><span class="mi" id="MathJax-Span-498" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-499" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-500" style="vertical-align: 0.607em;"><span style="display: inline-block; position: relative; width: 0.154em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.122em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1003.53em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.531em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1000.46em, 4.136em, -999.997em); top: -2.165em; left: 0.003em;"><span class="mtd" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mn" id="MathJax-Span-593" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.345em;"></span></span><span style="position: absolute; clip: rect(2.674em, 1015.73em, 6.001em, -999.997em); top: -4.03em; left: 6.454em;"><span style="display: inline-block; position: relative; width: 15.728em; height: 0px;"><span style="position: absolute; clip: rect(2.825em, 1015.73em, 4.892em, -999.997em); top: -4.181em; left: 0.003em;"><span class="mtd" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mrow" id="MathJax-Span-503"><span class="mtext" id="MathJax-Span-504" style="font-family: STIXGeneral-Regular;">if</span><span class="mspace" id="MathJax-Span-505" style="height: 0.003em; vertical-align: 0.003em; width: 0.204em; display: inline-block; overflow: hidden;"></span><span class="msub" id="MathJax-Span-506"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.51em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral-Italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.727em; left: 0.507em;"><span class="mn" id="MathJax-Span-509" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-510" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-511" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-512"><span class="mfrac" id="MathJax-Span-513"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.329em, 1001.16em, 4.287em, -999.997em); top: -4.483em; left: 50%; margin-left: -0.552em;"><span class="mrow" id="MathJax-Span-514"><span class="mover" id="MathJax-Span-515"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1001.11em, 4.287em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-516"><span class="mi" id="MathJax-Span-517" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-518" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-519"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-520"><span class="mi" id="MathJax-Span-521" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-522" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-523" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.682em, 1001.16em, 4.035em, -999.997em); top: -4.332em; left: 0.003em;"><span class="mo" id="MathJax-Span-524" style=""><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; top: -3.979em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.011em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.103em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.204em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.305em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.406em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.557em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.658em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.759em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.859em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.16em, 4.388em, -999.997em); top: -3.526em; left: 50%; margin-left: -0.552em;"><span class="mrow" id="MathJax-Span-525"><span class="mover" id="MathJax-Span-526"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1001.11em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-527"><span class="mi" id="MathJax-Span-528" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-529" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-531"><span class="mi" id="MathJax-Span-532" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-533" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-534" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.682em, 1001.16em, 4.035em, -999.997em); top: -4.332em; left: 0.003em;"><span class="mo" id="MathJax-Span-535" style=""><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; top: -3.979em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.011em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.103em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.204em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.305em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.406em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.557em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.658em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.759em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.859em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.26em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.263em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-536" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-537" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-538"><span class="mfrac" id="MathJax-Span-539"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-540" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.632em, 1000.56em, 4.287em, -999.997em); top: -3.727em; left: 50%; margin-left: -0.249em;"><span class="mrow" id="MathJax-Span-541"><span class="msub" id="MathJax-Span-542"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.236em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-size: 50%; font-family: STIXGeneral-Italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.255em;"><span class="mn" id="MathJax-Span-545" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.66em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.658em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-546" style="height: 0.003em; vertical-align: 0.003em; width: 0.204em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-547" style="font-family: STIXGeneral-Regular;">and</span><span class="mspace" id="MathJax-Span-548" style="height: 0.003em; vertical-align: 0.003em; width: 0.204em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-552" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-553" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-554" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-555" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-556"><span class="mfrac" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 2.321em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1002.17em, 4.287em, -999.997em); top: -4.483em; left: 50%; margin-left: -1.106em;"><span class="mrow" id="MathJax-Span-558"><span class="mtext" id="MathJax-Span-559" style="font-size: 50%; font-family: STIXGeneral-Regular;">Var</span><span class="mo" id="MathJax-Span-560" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-561" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-562" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-564"><span class="mi" id="MathJax-Span-565" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-566" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-567" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-568" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1002.17em, 4.388em, -999.997em); top: -3.677em; left: 50%; margin-left: -1.106em;"><span class="mrow" id="MathJax-Span-569"><span class="mtext" id="MathJax-Span-570" style="font-size: 50%; font-family: STIXGeneral-Regular;">Var</span><span class="mo" id="MathJax-Span-571" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-572" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-573" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-574"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-577" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-578" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-579" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1002.32em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.321em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-580" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-581" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-582"><span class="mfrac" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-584" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.61em, 4.388em, -999.997em); top: -3.475em; left: 50%; margin-left: -0.3em;"><span class="mrow" id="MathJax-Span-585"><span class="msubsup" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-587"><span class="mi" id="MathJax-Span-588" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.131em; left: 0.305em;"><span class="mn" id="MathJax-Span-589" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.727em; left: 0.255em;"><span class="mn" id="MathJax-Span-590" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.71em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.708em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1004.09em, 4.136em, -999.997em); top: -2.165em; left: 0.003em;"><span class="mtd" id="MathJax-Span-594"><span class="mrow" id="MathJax-Span-595"><span class="mrow" id="MathJax-Span-596"><span class="mtext" id="MathJax-Span-597" style="font-family: STIXGeneral-Regular;">otherwise</span><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral-Regular;">.</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.035em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.559em; border-left: 0px solid; width: 0px; height: 5.753em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-14"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="block" overflow="scroll"><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow><mi>x</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msub><mrow><mi>Z</mi></mrow><mi>i</mi></msub></mrow></mfrac></mstyle><msup><mrow><mi>e</mi></mrow><mrow><mo>−</mo><mstyle scriptlevel="1"><mfrac><mrow><msubsup><mrow><mo>∥</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><mi>β</mi><msup><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><mn>2</mn></msup><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac></mstyle></mrow></msup></mrow></mtd><mtd columnalign="left"><mrow><mtext>if</mtext><mspace width="0.16667em"></mspace><msub><mrow><mi>μ</mi></mrow><mn>1</mn></msub><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow></mfrac></mstyle><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msub><mrow><mi>μ</mi></mrow><mn>1</mn></msub></mrow></mfrac></mstyle><mspace width="0.16667em"></mspace><mtext>and</mtext><mspace width="0.16667em"></mspace><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mn>0</mn></mtd><mtd columnalign="left"><mrow><mtext>otherwise</mtext><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></mrow></math></script></div><div class="l">(7)</div></div><p> where 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M13" overflow="scroll" role="math" style="width: 2.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.17em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1002.17em, 1.363em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-600"><span class="mrow" id="MathJax-Span-601"><span class="mover" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 2.17em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1002.12em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-603"><span class="mi" id="MathJax-Span-604" style="font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-605" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-606"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-607"><span class="mi" id="MathJax-Span-608" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-609" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-610" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1002.17em, 3.934em, -999.997em); top: -4.584em; left: 0.003em;"><span class="mo" id="MathJax-Span-611" style=""><span style="display: inline-block; position: relative; width: 2.17em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.003em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 1.867em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.255em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.507em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.809em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.061em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.313em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.615em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-15"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" overflow="scroll"><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow></math></script> and Var(<strong>u</strong>(<em>N<sub>i</sub></em>)) represents respectively the mean and the variance of the local neighborhood <em>N<sub>i</sub></em> of voxel <em>x<sub>i</sub></em>. As suggested in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R52" rid="R52" class=" bibr popnode">52</a>], with this kind of selection, the NL-means filter tends to better preserve the detailed regions while slightly spoiling the denoising of the flat regions. Indeed, in flat regions increasing the number of voxels tends to improve denoising because there are a large number of similar voxels. In more cluttered regions, increasing the number of voxels tends to remove the details during smoothing because there are very few similar voxels.</p></div><div id="S10" class="sec"><p></p><h4 id="S10title" class="inline">3.  Blockwise implementation </h4><p id="P36" class="p p-first">A blockwise implementation of the NL-means is developed as suggested in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>]. This approach consists in a) dividing the volume into blocks with overlapping supports, b) performing NL-means-like restoration of these blocks and c) restoring the voxels values based on the restored values of the blocks they belong to.</p><ol class="enumerated" style="list-style-type:lower-alpha"><!--
list-behavior=enumerated
prefix-word=
mark-type=lower-alpha
max-label-size=0
--><li><p id="P37">A partition of the volume Ω<sup>3</sup> into overlapping blocks <em>B<sub>i<sub>k</sub></sub></em> of size (2<em>α</em> + 1)<sup>3</sup> is performed, such as Ω<sup>3</sup> = ∪<em><sub>k</sub> B<sub>i<sub>k</sub></sub></em>, under the constraint that the intersections between the <em>B<sub>i<sub>k</sub></sub></em> are non-empty (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F3/" target="figure" class="fig-table-link figpopup" rid-figpopup="F3" rid-ob="ob-F3" co-legend-rid="lgnd_F3"><span>Fig 3</span></a>). These blocks are centered on voxels <em>x<sub>i<sub>k</sub></sub></em>which constitute a subset of Ω<sup>3</sup>. The <em>x<sub>i<sub>k</sub></sub></em> are equally distributed at positions <em>i<sub>k</sub></em> = (<em>k</em><sub>1</sub><em>n</em>, <em>k</em><sub>2</sub><em>n</em>, <em>k</em><sub>3</sub><em>n</em>), (<em>k</em><sub>1</sub>, <em>k</em><sub>2</sub>, <em>k</em><sub>3</sub>) ∈ ℕ<sup>3</sup> where <em>n</em> represents the distance between the centers of <em>B<sub>i<sub>k</sub></sub></em>. To ensure a global continuity in the denoised image, the support overlapping of blocks has to be non empty: 2<em>α</em> &gt; <em>n</em>.</p></li><li><p id="P38">For each block <em>B<sub>i<sub>k</sub></sub></em>, a NL-means-like restoration is performed as follows:</p><p id="P102">
</p><div class="disp-formula" id="FD8"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="M14" overflow="scroll" role="math" style="width: 17.14em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.813em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.414em, 1013.76em, 4.186em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-613"><span class="mrow" id="MathJax-Span-614"><span class="mi" id="MathJax-Span-615" style="font-family: STIXGeneral; font-weight: bold;">NL</span><span class="mo" id="MathJax-Span-616" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-617" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-618" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-619" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-620"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mrow" id="MathJax-Span-623"><span class="msub" id="MathJax-Span-624"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.2em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-625"><span class="mi" id="MathJax-Span-626" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.204em;"><span class="mi" id="MathJax-Span-627" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-628" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-629" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="munder" id="MathJax-Span-630" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.355em;"><span class="mo" id="MathJax-Span-631" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1002.02em, 4.539em, -999.997em); top: -2.82em; left: 0.003em;"><span class="mrow" id="MathJax-Span-632"><span class="msub" id="MathJax-Span-633"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-634"><span class="mi" id="MathJax-Span-635" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.456em;"><span class="mi" id="MathJax-Span-636" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-637" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msub" id="MathJax-Span-638"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-639"><span class="mi" id="MathJax-Span-640" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.456em;"><span class="mrow" id="MathJax-Span-641"><span class="msub" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 0.406em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.15em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.154em;"><span class="mi" id="MathJax-Span-645" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-646" style="padding-left: 0.204em;"><span class="mi" id="MathJax-Span-647" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-648" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-649"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-650"><span class="mi" id="MathJax-Span-651" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mrow" id="MathJax-Span-652"><span class="msub" id="MathJax-Span-653"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.2em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.204em;"><span class="mi" id="MathJax-Span-656" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-658" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-659"><span class="mi" id="MathJax-Span-660" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-661" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-662" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-663" style="font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-664" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-665"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-666"><span class="mi" id="MathJax-Span-667" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-668" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-669" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.934em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-16"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="block" overflow="scroll"><mrow><mi mathvariant="bold">NL</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo>∈</mo><msub><mrow><mi>V</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub></mrow></munder><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo>,</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></script></div><div class="l">(8)</div></div><p></p><p id="P39">with</p><p id="P103">
</p><div class="disp-formula" id="FD9"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="M15" overflow="scroll" role="math" style="width: 14.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.545em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.048em, 1011.54em, 3.632em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mi" id="MathJax-Span-673" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-674" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-675"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-676"><span class="mi" id="MathJax-Span-677" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mrow" id="MathJax-Span-678"><span class="msub" id="MathJax-Span-679"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.2em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-680"><span class="mi" id="MathJax-Span-681" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.204em;"><span class="mi" id="MathJax-Span-682" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-683" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-684" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-687" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-688" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-689" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-690" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-691" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1001.11em, 4.388em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.552em;"><span class="mrow" id="MathJax-Span-692"><span class="msub" id="MathJax-Span-693"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-family: STIXGeneral-Italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mrow" id="MathJax-Span-696"><span class="msub" id="MathJax-Span-697"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.2em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-698"><span class="mi" id="MathJax-Span-699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.204em;"><span class="mi" id="MathJax-Span-700" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.21em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.212em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="msup" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 4.992em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.987em; left: 0.456em;"><span class="mrow" id="MathJax-Span-704"><span class="mo" id="MathJax-Span-705" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mstyle" id="MathJax-Span-706"><span class="mrow" id="MathJax-Span-707"><span class="mfrac" id="MathJax-Span-708"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.128em, 1003.63em, 4.488em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.812em;"><span class="mrow" id="MathJax-Span-709"><span class="msubsup" id="MathJax-Span-710"><span style="display: inline-block; position: relative; width: 3.632em; height: 0px;"><span style="position: absolute; clip: rect(3.279em, 1003.28em, 4.488em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-711"><span class="mo" id="MathJax-Span-712" style="vertical-align: 0.557em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.173em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-713" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-714" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-715"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-716"><span class="mi" id="MathJax-Span-717" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mrow" id="MathJax-Span-718"><span class="msub" id="MathJax-Span-719"><span style="display: inline-block; position: relative; width: 0.406em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.15em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-720"><span class="mi" id="MathJax-Span-721" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.154em;"><span class="mi" id="MathJax-Span-722" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-723" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-724" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-725" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-726" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-728"><span class="mi" id="MathJax-Span-729" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mi" id="MathJax-Span-730" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-731" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-732" style="vertical-align: 0.557em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.173em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.383em; left: 3.329em;"><span class="mn" id="MathJax-Span-733" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.627em; left: 3.329em;"><span class="mn" id="MathJax-Span-734" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.82em, 4.488em, -999.997em); top: -3.425em; left: 50%; margin-left: -0.955em;"><span class="mrow" id="MathJax-Span-735"><span class="mn" id="MathJax-Span-736" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-737" style="font-size: 50%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-739"><span class="mover" id="MathJax-Span-740"><span style="display: inline-block; position: relative; width: 0.305em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mi" id="MathJax-Span-741" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.43em, 1000.3em, 3.884em, -999.997em); top: -4.03em; left: 0.053em;"><span class="mo" id="MathJax-Span-742" style=""><span><span style="font-size: 50%; font-family: STIXSizeOneSym;">ˆ</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.305em;"><span class="mn" id="MathJax-Span-743" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-744" style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-745"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-746"><span class="mi" id="MathJax-Span-747" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-748" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-749" style="vertical-align: 0.607em;"><span style="display: inline-block; position: relative; width: 0.154em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.122em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1003.73em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.732em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 4.316em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-17"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="block" overflow="scroll"><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo>,</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mrow><mi>Z</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub></mrow></mfrac><msup><mrow><mi>e</mi></mrow><mrow><mo>−</mo><mstyle scriptlevel="1"><mfrac><mrow><msubsup><mrow><mo>∥</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><mi>β</mi><msup><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><mn>2</mn></msup><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac></mstyle></mrow></msup></mrow></math></script></div><div class="l">(9)</div></div><p></p><p id="P40">where <em>Z<sub>i<sub>k</sub></sub></em> is a normalization constant ensuring that Σ<sub><em>B</em><sub><em>j</em></sub>∈ <em>Vi</em><sub><em>k</em></sub></sub> <em>w</em>(<em>B<sub>i<sub>k</sub></sub></em>, <em>B<sub>j</sub></em>) = 1 (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F1/" target="figure" class="fig-table-link figpopup" rid-figpopup="F1" rid-ob="ob-F1" co-legend-rid="lgnd_F1"><span>Fig. 1</span></a> (right)).</p></li><li><p id="P41">For a voxel <em>x<sub>i</sub></em> included in several blocks <em>B<sub>i<sub>k</sub></sub></em>, several estimations of the restored intensity <em>NL</em>(<em>u</em>)(<em>x<sub>i</sub></em>) are obtained in different <strong>NL</strong>(<em>u</em>)(<em>B<sub>i<sub>k</sub></sub></em>) (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F3/" target="figure" class="fig-table-link figpopup" rid-figpopup="F3" rid-ob="ob-F3" co-legend-rid="lgnd_F3"><span>Fig 3</span></a>). The estimations given by different <strong>NL</strong>(<em>u</em>)(<em>B<sub>i<sub>k</sub></sub></em>) for a voxel <em>x<sub>i</sub></em> are stored in a vector <strong>A</strong><em><sub>i</sub></em>. The final restored intensity of voxel <em>x<sub>i</sub></em> is then defined as:</p><p id="P104">
</p><div class="disp-formula" id="FD10"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="M16" overflow="scroll" role="math" style="width: 14.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.394em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.011em, 1011.34em, 4.085em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-751"><span class="mrow" id="MathJax-Span-752"><span class="mi" id="MathJax-Span-753" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-754" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-755" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-756" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-757" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-758" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-759"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-760"><span class="mi" id="MathJax-Span-761" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-762" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-763" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-764" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-765" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.666em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.249em;"><span class="mn" id="MathJax-Span-766" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.41em, 4.337em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.754em;"><span class="mrow" id="MathJax-Span-767"><span class="mo" id="MathJax-Span-768" style="font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-769"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-770"><span class="mi" id="MathJax-Span-771" style="font-family: STIXGeneral; font-weight: bold;">A</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.708em;"><span class="mi" id="MathJax-Span-772" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-773" style="font-family: STIXGeneral-Regular;">∣</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.67em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.666em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="munder" id="MathJax-Span-774" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.103em;"><span class="mo" id="MathJax-Span-775" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.57em, 4.388em, -999.997em); top: -2.82em; left: 0.003em;"><span class="mrow" id="MathJax-Span-776"><span class="mi" id="MathJax-Span-777" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-778" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msub" id="MathJax-Span-779"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-780"><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">A</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.507em;"><span class="mi" id="MathJax-Span-782" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-783" style="padding-left: 0.204em;"><span class="msub" id="MathJax-Span-784"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-785"><span class="mi" id="MathJax-Span-786" style="font-family: STIXGeneral; font-weight: bold;">A</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.708em;"><span class="mi" id="MathJax-Span-787" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-788" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-789" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-790" style="font-family: STIXGeneral-Regular;">)</span></span><span class="mo" id="MathJax-Span-791" style="font-family: STIXGeneral-Regular;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-18"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="block" overflow="scroll"><mrow><mi>N</mi><mi>L</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mo>∣</mo><msub><mrow><mi mathvariant="bold">A</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac><munder><mo>∑</mo><mrow><mi>p</mi><mo>∈</mo><msub><mrow><mi mathvariant="bold">A</mi></mrow><mi>i</mi></msub></mrow></munder><mrow><msub><mrow><mi mathvariant="bold">A</mi></mrow><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><mo>.</mo></mrow></math></script></div><div class="l">(10)</div></div><p></p></li></ol><p id="P42" class="p p-last">The main advantage of this approach is to significantly reduce the complexity of the algorithm. Indeed, for a volume Ω<sup>3</sup> of size <em>N</em><sup>3</sup>, the global complexity is 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M17" overflow="scroll" role="math" style="width: 14.619em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.797em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.515em, 1011.75em, 2.926em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-793"><span class="mrow" id="MathJax-Span-794"><span class="mi" id="MathJax-Span-795" style="font-family: STIXGeneral-Italic;">𝒪</span><span class="mo" id="MathJax-Span-796" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-797"><span style="display: inline-block; position: relative; width: 3.833em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1003.38em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-798"><span class="mrow" id="MathJax-Span-799"><span class="mo" id="MathJax-Span-800" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-801" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-802" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-803" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">+</span><span class="mn" id="MathJax-Span-804" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">1</span><span class="mo" id="MathJax-Span-805" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 3.43em;"><span class="mn" id="MathJax-Span-806" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 4.186em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1003.68em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-808"><span class="mrow" id="MathJax-Span-809"><span class="mo" id="MathJax-Span-810" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-811" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-812" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-813" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">+</span><span class="mn" id="MathJax-Span-814" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">1</span><span class="mo" id="MathJax-Span-815" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 3.732em;"><span class="mn" id="MathJax-Span-816" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msup" id="MathJax-Span-817"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1001.92em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-818"><span class="mrow" id="MathJax-Span-819"><span class="mo" id="MathJax-Span-820" style="font-family: STIXGeneral-Regular;">(</span><span class="mstyle" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mfrac" id="MathJax-Span-823"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.531em, 1000.96em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.451em;"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-826" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-827" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.727em; left: 50%; margin-left: -0.098em;"><span class="mi" id="MathJax-Span-828" style="font-size: 50%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.06em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.061em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-829" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 1.968em;"><span class="mn" id="MathJax-Span-830" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-831" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-19"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" overflow="scroll"><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>α</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow><mn>3</mn></msup><msup><mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>M</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow><mn>3</mn></msup><msup><mrow><mrow><mo stretchy="false">(</mo><mstyle scriptlevel="1"><mfrac><mrow><mi>N</mi><mo>−</mo><mi>n</mi></mrow><mi>n</mi></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mrow><mn>3</mn></msup><mo stretchy="false">)</mo></mrow></math></script>. For instance, with <em>n</em> = 2, the complexity is divided by a factor 8. The voxels selection principle can also be applied to the blockwise implementation: 
</p><div class="disp-formula" id="FD11"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="M18" overflow="scroll" role="math" style="width: 36.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.236em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.313em, 1029.09em, 6.253em, -999.997em); top: -4.03em; left: 0.003em;"><span class="mrow" id="MathJax-Span-833"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-836" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-837"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-838"><span class="mi" id="MathJax-Span-839" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mrow" id="MathJax-Span-840"><span class="msub" id="MathJax-Span-841"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.2em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-842"><span class="mi" id="MathJax-Span-843" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.204em;"><span class="mi" id="MathJax-Span-844" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-845" style="font-family: STIXGeneral-Regular;">,</span><span class="msub" id="MathJax-Span-846" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-847"><span class="mi" id="MathJax-Span-848" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-849" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-850" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-851" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mrow" id="MathJax-Span-852" style="padding-left: 0.305em;"><span class="mo" id="MathJax-Span-853" style="vertical-align: 2.573em;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.274em; left: 0.003em;">⎧<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.355em; left: 0.003em;">⎩<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.459em; left: 0.003em;">⎨<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.366em; left: 0.003em;">⎪<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.552em; left: 0.003em;">⎪<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-854"><span class="mtable" id="MathJax-Span-855" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 23.138em; height: 0px;"><span style="position: absolute; clip: rect(2.775em, 1006.05em, 7.563em, -999.997em); top: -5.491em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.051em; height: 0px;"><span style="position: absolute; clip: rect(1.515em, 1006.05em, 4.892em, -999.997em); top: -4.231em; left: 0.003em;"><span class="mtd" id="MathJax-Span-856"><span class="mrow" id="MathJax-Span-857"><span class="mrow" id="MathJax-Span-858"><span class="mstyle" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="mfrac" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-862" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.71em, 4.488em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-863"><span class="msub" id="MathJax-Span-864"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-865"><span class="mi" id="MathJax-Span-866" style="font-size: 50%; font-family: STIXGeneral-Italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mrow" id="MathJax-Span-867"><span class="msub" id="MathJax-Span-868"><span style="display: inline-block; position: relative; width: 0.406em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.15em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-869"><span class="mi" id="MathJax-Span-870" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.154em;"><span class="mi" id="MathJax-Span-871" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.86em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.859em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="msup" id="MathJax-Span-872"><span style="display: inline-block; position: relative; width: 4.992em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-873"><span class="mi" id="MathJax-Span-874" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.987em; left: 0.456em;"><span class="mrow" id="MathJax-Span-875"><span class="mo" id="MathJax-Span-876" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mstyle" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mfrac" id="MathJax-Span-879"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.128em, 1003.63em, 4.488em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.812em;"><span class="mrow" id="MathJax-Span-880"><span class="msubsup" id="MathJax-Span-881"><span style="display: inline-block; position: relative; width: 3.632em; height: 0px;"><span style="position: absolute; clip: rect(3.279em, 1003.28em, 4.488em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-882"><span class="mo" id="MathJax-Span-883" style="vertical-align: 0.557em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.173em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-884" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-885" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-887"><span class="mi" id="MathJax-Span-888" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mrow" id="MathJax-Span-889"><span class="msub" id="MathJax-Span-890"><span style="display: inline-block; position: relative; width: 0.406em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.15em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-891"><span class="mi" id="MathJax-Span-892" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.154em;"><span class="mi" id="MathJax-Span-893" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-894" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-895" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-896" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-897" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-899"><span class="mi" id="MathJax-Span-900" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mi" id="MathJax-Span-901" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-902" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-903" style="vertical-align: 0.557em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.173em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.383em; left: 3.329em;"><span class="mn" id="MathJax-Span-904" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.627em; left: 3.329em;"><span class="mn" id="MathJax-Span-905" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.82em, 4.488em, -999.997em); top: -3.425em; left: 50%; margin-left: -0.955em;"><span class="mrow" id="MathJax-Span-906"><span class="mn" id="MathJax-Span-907" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-908" style="font-size: 50%; font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-909"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-910"><span class="mover" id="MathJax-Span-911"><span style="display: inline-block; position: relative; width: 0.305em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mi" id="MathJax-Span-912" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.43em, 1000.3em, 3.884em, -999.997em); top: -4.03em; left: 0.053em;"><span class="mo" id="MathJax-Span-913" style=""><span><span style="font-size: 50%; font-family: STIXSizeOneSym;">ˆ</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.305em;"><span class="mn" id="MathJax-Span-914" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-915" style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span class="msub" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-917"><span class="mi" id="MathJax-Span-918" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-919" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-920" style="vertical-align: 0.607em;"><span style="display: inline-block; position: relative; width: 0.154em; height: 0px;"><span style="position: absolute; top: -3.627em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.122em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.374em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">∣</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1003.73em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 3.732em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.085em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1000.46em, 4.136em, -999.997em); top: -2.114em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1020"><span class="mrow" id="MathJax-Span-1021"><span class="mn" id="MathJax-Span-1022" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.496em;"></span></span><span style="position: absolute; clip: rect(2.724em, 1016.18em, 6.253em, -999.997em); top: -4.181em; left: 6.958em;"><span style="display: inline-block; position: relative; width: 16.182em; height: 0px;"><span style="position: absolute; clip: rect(2.674em, 1016.18em, 4.892em, -999.997em); top: -4.131em; left: 0.003em;"><span class="mtd" id="MathJax-Span-921"><span class="mrow" id="MathJax-Span-922"><span class="mrow" id="MathJax-Span-923"><span class="mtext" id="MathJax-Span-924" style="font-family: STIXGeneral-Regular;">if</span><span class="mspace" id="MathJax-Span-925" style="height: 0.003em; vertical-align: 0.003em; width: 0.204em; display: inline-block; overflow: hidden;"></span><span class="msub" id="MathJax-Span-926"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.51em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-927"><span class="mi" id="MathJax-Span-928" style="font-family: STIXGeneral-Italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.727em; left: 0.507em;"><span class="mn" id="MathJax-Span-929" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-930" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-931" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-932"><span class="mfrac" id="MathJax-Span-933"><span style="display: inline-block; position: relative; width: 1.515em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.329em, 1001.36em, 4.488em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.703em;"><span class="mrow" id="MathJax-Span-934"><span class="mover" id="MathJax-Span-935"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1001.36em, 4.488em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-936"><span class="mi" id="MathJax-Span-937" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-938" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-939"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-940"><span class="mi" id="MathJax-Span-941" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mrow" id="MathJax-Span-942"><span class="msub" id="MathJax-Span-943"><span style="display: inline-block; position: relative; width: 0.406em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.15em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-944"><span class="mi" id="MathJax-Span-945" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.154em;"><span class="mi" id="MathJax-Span-946" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-947" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.682em, 1001.36em, 4.035em, -999.997em); top: -4.332em; left: 0.003em;"><span class="mo" id="MathJax-Span-948" style=""><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; top: -3.979em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.212em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.103em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.204em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.305em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.406em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.507em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.607em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.708em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.809em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.91em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.011em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.111em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.11em, 4.388em, -999.997em); top: -3.526em; left: 50%; margin-left: -0.552em;"><span class="mrow" id="MathJax-Span-949"><span class="mover" id="MathJax-Span-950"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1001.06em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-951"><span class="mi" id="MathJax-Span-952" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-953" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-954"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-955"><span class="mi" id="MathJax-Span-956" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mrow" id="MathJax-Span-957"><span class="mi" id="MathJax-Span-958" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-959" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.682em, 1001.11em, 4.035em, -999.997em); top: -4.332em; left: 0.003em;"><span class="mo" id="MathJax-Span-960" style=""><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; top: -3.979em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.96em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.103em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.204em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.305em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.406em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.507em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.658em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.759em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.859em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.51em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.515em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-961" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-962" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-963"><span class="mfrac" id="MathJax-Span-964"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-965" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.632em, 1000.56em, 4.287em, -999.997em); top: -3.727em; left: 50%; margin-left: -0.249em;"><span class="mrow" id="MathJax-Span-966"><span class="msub" id="MathJax-Span-967"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.236em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-968"><span class="mi" id="MathJax-Span-969" style="font-size: 50%; font-family: STIXGeneral-Italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.255em;"><span class="mn" id="MathJax-Span-970" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.66em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.658em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-971" style="height: 0.003em; vertical-align: 0.003em; width: 0.204em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-972" style="font-family: STIXGeneral-Regular;">and</span><span class="mspace" id="MathJax-Span-973" style="height: 0.003em; vertical-align: 0.003em; width: 0.204em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-974"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-975"><span class="mi" id="MathJax-Span-976" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-977" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-978" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-979" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-980" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-981"><span class="mfrac" id="MathJax-Span-982"><span style="display: inline-block; position: relative; width: 2.573em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1002.42em, 4.488em, -999.997em); top: -4.635em; left: 50%; margin-left: -1.207em;"><span class="mrow" id="MathJax-Span-983"><span class="mtext" id="MathJax-Span-984" style="font-size: 50%; font-family: STIXGeneral-Regular;">Var</span><span class="mo" id="MathJax-Span-985" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-986" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-987" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-988"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mrow" id="MathJax-Span-991"><span class="msub" id="MathJax-Span-992"><span style="display: inline-block; position: relative; width: 0.406em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.15em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-993"><span class="mi" id="MathJax-Span-994" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.154em;"><span class="mi" id="MathJax-Span-995" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-996" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-997" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1002.17em, 4.388em, -999.997em); top: -3.677em; left: 50%; margin-left: -1.106em;"><span class="mrow" id="MathJax-Span-998"><span class="mtext" id="MathJax-Span-999" style="font-size: 50%; font-family: STIXGeneral-Regular;">Var</span><span class="mo" id="MathJax-Span-1000" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1001" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1002" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1003"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1004"><span class="mi" id="MathJax-Span-1005" style="font-size: 50%; font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.305em;"><span class="mi" id="MathJax-Span-1006" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1007" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1008" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1002.57em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.573em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1009" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-1010" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1011"><span class="mfrac" id="MathJax-Span-1012"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-1013" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.61em, 4.388em, -999.997em); top: -3.475em; left: 50%; margin-left: -0.3em;"><span class="mrow" id="MathJax-Span-1014"><span class="msubsup" id="MathJax-Span-1015"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1016"><span class="mi" id="MathJax-Span-1017" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.131em; left: 0.305em;"><span class="mn" id="MathJax-Span-1018" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.727em; left: 0.255em;"><span class="mn" id="MathJax-Span-1019" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.71em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.708em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1004.09em, 4.136em, -999.997em); top: -2.114em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1023"><span class="mrow" id="MathJax-Span-1024"><span class="mrow" id="MathJax-Span-1025"><span class="mtext" id="MathJax-Span-1026" style="font-family: STIXGeneral-Regular;">otherwise</span><span class="mo" id="MathJax-Span-1027" style="font-family: STIXGeneral-Regular;">.</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.186em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.035em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.622em; border-left: 0px solid; width: 0px; height: 5.878em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-20"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="block" overflow="scroll"><mrow><mi>w</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo>,</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msub><mrow><mi>Z</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub></mrow></mfrac></mstyle><msup><mrow><mi>e</mi></mrow><mrow><mo>−</mo><mstyle scriptlevel="1"><mfrac><mrow><msubsup><mrow><mo>∥</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><mi>β</mi><msup><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><mn>2</mn></msup><mo>∣</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo>∣</mo></mrow></mfrac></mstyle></mrow></msup></mrow></mtd><mtd columnalign="left"><mrow><mtext>if</mtext><mspace width="0.16667em"></mspace><msub><mrow><mi>μ</mi></mrow><mn>1</mn></msub><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow></mfrac></mstyle><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msub><mrow><mi>μ</mi></mrow><mn>1</mn></msub></mrow></mfrac></mstyle><mspace width="0.16667em"></mspace><mtext>and</mtext><mspace width="0.16667em"></mspace><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mn>0</mn></mtd><mtd columnalign="left"><mrow><mtext>otherwise</mtext><mo>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></mrow></math></script></div><div class="l">(11)</div></div><p> where 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M19" overflow="scroll" role="math" style="width: 3.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1002.42em, 1.414em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1029"><span class="mrow" id="MathJax-Span-1030"><span class="mover" id="MathJax-Span-1031"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1002.32em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1032"><span class="mi" id="MathJax-Span-1033" style="font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1034" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1035"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1036"><span class="mi" id="MathJax-Span-1037" style="font-family: STIXGeneral-Italic;">B</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mrow" id="MathJax-Span-1038"><span class="msub" id="MathJax-Span-1039"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.2em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1040"><span class="mi" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.204em;"><span class="mi" id="MathJax-Span-1042" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1043" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1002.42em, 3.934em, -999.997em); top: -4.584em; left: 0.003em;"><span class="mo" id="MathJax-Span-1044" style=""><span style="display: inline-block; position: relative; width: 2.422em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.003em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 2.119em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.255em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.507em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.759em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.061em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.313em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.565em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.817em;">⎯<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-21"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" overflow="scroll"><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>B</mi></mrow><mrow><msub><mrow><mi>i</mi></mrow><mi>k</mi></msub></mrow></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow></math></script> and Var(<strong>u</strong>(<em>B<sub>i<sub>k</sub></sub></em>)) represent respectively the mean and the variance of the intensity function, for the block <em>B<sub>i<sub>k</sub></sub></em> centered on the voxel <em>x<sub>i<sub>k</sub></sub></em>.</p></div><div id="S11" class="sec sec-last"><p></p><h4 id="S11title" class="inline">4.  Parallel computation </h4><p id="P43" class="p p-first-last">Another way to reduce the computational time is to distribute the operations on several processors via a cluster or a grid. The intrinsic nature of the NL-means filter makes it perfectly suited for parallelization and multithreading implementation. One of the main advantage of this filter, when compared to others method such as Anisotropic Diffusion or Total Variation minimization, is that the operations are performed without any iterative schemes. Thus, the parallelization of the NL-means filter is straightforward to perform and very efficient. We divide the volume into sub-volumes, each of them being treated separately by one processor. A server with 8 Xeon processors at 3 GHz and a Intel(R) Pentium(R) D CPU 3.40GHz were used in our experiments.</p></div></div></div><div id="S12" class="tsec sec"><h2 class="head no_bottom_margin" id="S12title">IV. Materials</h2><div id="S13" class="sec sec-first"><h3 id="S13title">A. The BrainWeb Database</h3><p id="P44" class="p p-first">In order to evaluate the performances of the NL-means filter on 3D MR images, tests were performed on the BrainWeb database<sup><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FN2" rid="FN2" class=" fn">1</a></sup> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R2" rid="R2" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474439">2</a>]. Two images were simulated: T1-w MR image using SFLASH sequence (volume size = 181 × 217 × 181) and T2-w MR image with MS from SFLASH sequence (volume size = 181 × 217 × 181). As reported previously, it is a known fact that the MR images are corrupted by a Rician noise [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R53" rid="R53" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474436">53</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R54" rid="R54" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474431">54</a>], which can be well approximated by a white Gaussian noise in high intensity areas, typically in brain tissues [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R38" rid="R38" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474426">38</a>]. In order to verify if this approximation can be used for a NL-means based denoising, experiments are performed on phantom images with Gaussian and Rician noise.</p><div id="S14" class="sec"><p></p><h4 id="S14title" class="inline">1.  Gaussian Noise </h4><p id="P45" class="p p-first">A white Gaussian noise was added on the “ground truth”, and the notations of BrainWeb are used: a noise of 3% is equivalent to 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M20" overflow="scroll" role="math" style="width: 5.144em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.136em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.666em, 1004.09em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1046"><span class="mrow" id="MathJax-Span-1047"><span class="mi" id="MathJax-Span-1048" style="font-family: STIXGeneral-Italic;">𝒩</span><span class="mo" id="MathJax-Span-1049" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-1050" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-1051" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1052" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">ν</span><span class="mstyle" id="MathJax-Span-1053"><span class="mrow" id="MathJax-Span-1054"><span class="mfrac" id="MathJax-Span-1055"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-1056" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.76em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-1057"><span class="mn" id="MathJax-Span-1058" style="font-size: 50%; font-family: STIXGeneral-Regular;">100</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.86em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.859em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1059" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-22"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" overflow="scroll"><mrow><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>ν</mi><mstyle scriptlevel="1"><mfrac><mn>3</mn><mrow><mn>100</mn></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></math></script>, where <em>ν</em> is the value of the brightest tissue in the image (150 for T1-w and 250 for T2-w). Several images were simulated to validate the performances of the denoising on various images (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F4/" target="figure" class="fig-table-link figpopup" rid-figpopup="F4" rid-ob="ob-F4" co-legend-rid="lgnd_F4"><span>Fig. 4</span></a>):</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P46">T1-w MR images for 4 levels of noise 3%, 9%, 15% and 21%.</p></li><li><p id="P47">T2-w MR images with Multiple Sclerosis (MS) lesions for 4 levels of noise 3%, 9%, 15% and 21%.</p></li></ul><p id="P48" class="p p-last">T2-w images were used in order to show that our approach and its calibration are not specific to T1-w MRI sequences. Moreover, the tests on T2-w MRI with MS show how the NL-means filter could be useful in a pathological context due to its preservation of anatomic and pathologic structures.</p></div><div id="S15" class="sec sec-last"><p></p><h4 id="S15title" class="inline">2.  Rician Noise </h4><p id="P49" class="p p-first">The Rician noise was build from white Gaussian noise in the complex domain. Firstly, two images are computed:</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P50"><em>I<sub>r</sub></em>(<em>x<sub>i</sub></em>) = <em>I</em><sub>0</sub>(<em>x<sub>i</sub></em>) + <em>η</em><sub>1</sub>(<em>x<sub>i</sub></em>), <em>η</em><sub>1</sub>(<em>x<sub>i</sub></em>) ~ <img alt="An external file that holds a picture, illustration, etc.
Object name is halms169658ig1.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658ig1.jpg">(0, <em>σ</em>)</p></li><li><p id="P51"><em>I<sub>i</sub></em>(<em>x<sub>i</sub></em>) = <em>η</em><sub>2</sub>(<em>x<sub>i</sub></em>), <em>η</em><sub>2</sub>(<em>x<sub>i</sub></em>) ~ <img alt="An external file that holds a picture, illustration, etc.
Object name is halms169658ig1.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658ig1.jpg">(0, <em>σ</em>)</p></li></ul><p id="P52">where <em>I</em><sub>0</sub> is the “ground truth” and <em>σ</em> is the standard deviation of the added white Gaussian noise. Then, the noisy image is computed as: 
</p><div class="disp-formula" id="FD12"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="M21" overflow="scroll" role="math" style="width: 13.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.789em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.111em, 1010.79em, 3.279em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1061"><span class="mrow" id="MathJax-Span-1062"><span class="msub" id="MathJax-Span-1063"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1064"><span class="mi" id="MathJax-Span-1065" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1067" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1068"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1069"><span class="mi" id="MathJax-Span-1070" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1072" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1073" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="msqrt" id="MathJax-Span-1074" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 7.21em; height: 0px;"><span style="position: absolute; clip: rect(2.926em, 1006.1em, 4.337em, -999.997em); top: -3.979em; left: 1.061em;"><span class="mrow" id="MathJax-Span-1075"><span class="mrow" id="MathJax-Span-1076"><span class="msub" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1078"><span class="mi" id="MathJax-Span-1079" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1080" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msup" id="MathJax-Span-1081"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1001.31em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1082"><span class="mrow" id="MathJax-Span-1083"><span class="mo" id="MathJax-Span-1084" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1085"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1086"><span class="mi" id="MathJax-Span-1087" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1089" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 1.363em;"><span class="mn" id="MathJax-Span-1090" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1091" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">+</span><span class="msub" id="MathJax-Span-1092" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1093"><span class="mi" id="MathJax-Span-1094" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msup" id="MathJax-Span-1096"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1001.31em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1097"><span class="mrow" id="MathJax-Span-1098"><span class="mo" id="MathJax-Span-1099" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1100"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1101"><span class="mi" id="MathJax-Span-1102" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1104" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 1.363em;"><span class="mn" id="MathJax-Span-1105" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.027em, 1006.15em, 3.38em, -999.997em); top: -4.383em; left: 1.061em;"><span style="display: inline-block; position: relative; width: 6.152em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.003em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 5.648em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.406em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.859em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.263em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.716em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 2.17em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 2.573em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 3.027em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 3.48em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 3.884em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 4.337em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 4.791em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 5.194em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.271em, 1001.11em, 4.438em, -999.997em); top: -3.677em; left: 0.003em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.441em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-23"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="block" overflow="scroll"><mrow><msub><mrow><mi>I</mi></mrow><mi>N</mi></msub><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msqrt><mrow><msub><mrow><mi>I</mi></mrow><mi>r</mi></msub><msup><mrow><mrow><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msub><mrow><mi>I</mi></mrow><mi>i</mi></msub><msup><mrow><mrow><mo stretchy="false">(</mo><msub><mrow><mi>x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mn>2</mn></msup></mrow></msqrt></mrow></math></script></div><div class="l">(12)</div></div><p></p><p id="P53" class="p">The notation 3% for the Rician noise means that the Gaussian noise used in complex domain is equivalent to 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M22" overflow="scroll" role="math" style="width: 5.144em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.136em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.666em, 1004.09em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1107"><span class="mrow" id="MathJax-Span-1108"><span class="mi" id="MathJax-Span-1109" style="font-family: STIXGeneral-Italic;">𝒩</span><span class="mo" id="MathJax-Span-1110" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-1111" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-1112" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1113" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">ν</span><span class="mstyle" id="MathJax-Span-1114"><span class="mrow" id="MathJax-Span-1115"><span class="mfrac" id="MathJax-Span-1116"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-1117" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.76em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-1118"><span class="mn" id="MathJax-Span-1119" style="font-size: 50%; font-family: STIXGeneral-Regular;">100</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.86em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.859em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1120" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-24"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" overflow="scroll"><mrow><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>ν</mi><mstyle scriptlevel="1"><mfrac><mn>3</mn><mrow><mn>100</mn></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></math></script>, where <em>ν</em> is the value of the brightest tissue in the image (150 for T1-w). According to the Peak Signal to Noise Ratio (PSNR) (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD13" rid="FD13" class=" disp-formula">Eq. 13</a>) between “ground truth” and noisy images, for a same level of noise, the Rician noise is stronger than the Gaussian noise (see Tab. I). Several images were simulated (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F5/" target="figure" class="fig-table-link figpopup" rid-figpopup="F5" rid-ob="ob-F5" co-legend-rid="lgnd_F5"><span>Fig. 5</span></a>):</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P54">T1-w MR images for 4 levels of noise 3%, 9%, 15% and 21%.</p></li></ul></div></div><div id="S16" class="sec sec-last"><h3 id="S16title">B. Real Data</h3><div id="S17" class="sec sec-first"><p></p><h4 id="S17title" class="inline">1.  T1-w high field MRI Data </h4><p id="P55" class="p p-first-last">To show the efficiency of the NL-means filter on real data, tests were performed on image acquired with a high field MR system (Bruker 3 Tesla). The data used was a 256 × 256 × 256 T1-w image.</p></div><div id="S18" class="sec sec-last"><p></p><h4 id="S18title" class="inline">2.  T2-w with Multiple Sclerosis lesions </h4><p id="P97" class="p p-first-last">In a pathological context, the denoising step is crucial especially when the structures of interest have a small size: the integrity of pathological structures must be preserved by the denoising method. As said earlier, one objective of denoising is to include such processing in complex medical imaging workflows. This kind of workflows is widely used to process large cohort of subjects in many neurological diseases such as MS lesions. The data used for MS lesions qualitative validation was a T2-w MR image from an axial dual-echo, turbo spin-echo sequence (Philips 1.5 Tesla).</p></div></div></div><div id="S19" class="tsec sec"><h2 class="head no_bottom_margin" id="S19title">V. Validation on a Phantom data set with added Gaussian Noise</h2><p id="P56" class="p p-first">In the following, let us define:</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P57"><strong>NL-means</strong> is the standard voxelwise implementation with automatic tuning of the smoothing parameter.</p></li><li><p id="P58"><strong>Optimized NL-means</strong> is a voxelwise implementation with automatic tuning of the smoothing parameter, voxel selection and multithreading.</p></li><li><p id="P59"><strong>Blockwise NL-means</strong> is the standard blockwise implementation with automatic tuning of the smoothing parameter.</p></li><li><p id="P60"><strong>Optimized Blockwise NL-means</strong> is a blockwise implementation with automatic tuning of the smoothing parameter, block selection and multithreading.</p></li></ul><p id="P61">In this section different aspects of NL-means filter implementation were investigated. First, the impact of the automatic tuning of the filtering parameter (Section V-A) and the influence of the size of the search volume and the neighborhood were studied (Section V-B). Then, the impact of voxels selection and blockwise implementation is analyzed <em>via</em> the comparison of the <strong>NL-means</strong>, <strong>Optimized NL-means</strong>, <strong>Blockwise NL-means</strong> and <strong>Optimized Blockwise NL-means</strong> filters (Sections V-C and V-D). Finally, we compare the proposed <strong>Optimized Blockwise NL-means</strong> filter with other well-established denoising methods: Anisotropic Diffusion filter [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>] (implemented in VTK<sup><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FN3" rid="FN3" class=" fn">2</a></sup>) and Rudin-Osher-Fatemi Total Variation (TV) minimization process [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R4" rid="R4" class=" bibr popnode">4</a>] (3D extension of the Megawave 2 implementation<sup><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FN4" rid="FN4" class=" fn">3</a></sup>) (Section V-G). The different variants of the NL-means filter can be freely tested at: <a href="http://www.irisa.fr/visages/benchmarks" data-ga-action="click_feat_suppl" ref="reftype=extlink&amp;article-id=2881565&amp;issue-id=187433&amp;journal-id=469&amp;FROM=Article%7CBody&amp;TO=External%7CLink%7CURI" target="_blank">http://www.irisa.fr/visages/benchmarks</a></p><p id="P62">In the following, several criteria are used to quantify the performances of each method: the PSNR obtained for different noise levels, histogram comparisons between the denoised images and the “ground truth”, and finally visual assessment. For the sake of clarity, the PSNR and the histograms are estimated only in a region of interest obtained by removing the background. For 8-bit encoded images, the PSNR is defined as follows: 
</p><div class="disp-formula" id="FD13"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="M23" overflow="scroll" role="math" style="width: 12.452em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.033em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.011em, 1010.03em, 3.38em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1122"><span class="mrow" id="MathJax-Span-1123"><span class="mi" id="MathJax-Span-1124" style="font-family: STIXGeneral-Italic;">PSNR</span><span class="mo" id="MathJax-Span-1125" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1126" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">20</span><span class="msub" id="MathJax-Span-1127" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.26em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1128"><span class="mrow" id="MathJax-Span-1129"><span class="mo" id="MathJax-Span-1130" style="font-family: STIXGeneral-Regular;">log</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.727em; left: 1.263em;"><span class="mrow" id="MathJax-Span-1131"><span class="mn" id="MathJax-Span-1132" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">10</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1133" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.128em, 1001.46em, 4.136em, -999.997em); top: -4.635em; left: 50%; margin-left: -0.754em;"><span class="mrow" id="MathJax-Span-1134"><span class="mn" id="MathJax-Span-1135" style="font-family: STIXGeneral-Regular;">255</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1002.57em, 4.136em, -999.997em); top: -3.274em; left: 50%; margin-left: -1.258em;"><span class="mrow" id="MathJax-Span-1136"><span class="mi" id="MathJax-Span-1137" style="font-family: STIXGeneral-Italic;">RMSE</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1002.67em, 1.212em, -999.997em); top: -1.258em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-25"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="block" overflow="scroll"><mrow><mi mathvariant="italic">PSNR</mi><mo>=</mo><mn>20</mn><msub><mrow><mrow><mo>log</mo></mrow></mrow><mrow><mn>10</mn></mrow></msub><mfrac><mrow><mn>255</mn></mrow><mrow><mi mathvariant="italic">RMSE</mi></mrow></mfrac></mrow></math></script></div><div class="l">(13)</div></div><p> where the RMSE is the root mean square error estimated between the ground truth and the denoised image.</p><p id="P63">In this section, the central parameters of interest are:</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P64"><em>β</em> defining the smoothing parameter <em>h: h</em><sup>2</sup> = 2<em>β<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1138" role="math" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.104em, 1000.61em, 1.171em, -999.997em); top: -1.014em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1139"><span class="mover" id="MathJax-Span-1140"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.51em, 4.169em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1141" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1000.56em, 3.61em, -999.997em); top: -4.012em; left: 0.053em;"><span class="mo" id="MathJax-Span-1142" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.019em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-26"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup>|<em>N<sub>i</sub></em>| (see section III-B.1).</p></li><li><p id="P65"><em>M</em> related to |<em>V<sub>i</sub></em>|: |<em>V<sub>i</sub></em>| = (2<em>M</em> + 1)<sup>3</sup>.</p></li><li><p id="P66"><em>d</em> related to <em>|N</em><sub>i</sub>|: |<em>N<sub>i</sub></em>| = (2<em>d</em> + 1)<sup>3</sup>.</p></li><li><p id="P67"><em>μ</em><sub>1</sub> and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M24" overflow="scroll" role="math" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.053em, 1001.01em, 1.464em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1144"><span class="mrow" id="MathJax-Span-1145"><span class="msubsup" id="MathJax-Span-1146"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1147"><span class="mi" id="MathJax-Span-1148" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-27"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></math></script> corresponding to the thresholds involving in the voxel selection.</p></li></ul><p id="P68">In each experiment (Sections V-A, V-B and V-C), we let one parameter vary while remaining the others constant, with default values: <em>β</em> = 1, <em>M</em> = 5, <em>d</em> = 1 and <em>μ</em><sub>1</sub> = 0.95, 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M25" overflow="scroll" role="math" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.565em, 1003.53em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1152"><span class="mrow" id="MathJax-Span-1153"><span class="msubsup" id="MathJax-Span-1154"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1155"><span class="mi" id="MathJax-Span-1156" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1159" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1160" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">0.5</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-28"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>0.5</mn></mrow></math></script>. Concerning the blockwise implementation the default parameters are <em>n</em> = 2 and <em>α</em> = 1.</p><p id="P69">Our experiments have shown that all the versions of the NL-means filter (<strong>NL-means</strong>, <strong>Optimized NL-means</strong>, <strong>Blockwise NL-means</strong> and <strong>Optimized Blockwise NL-means</strong>) tend to have a similar behavior with respect to the variation of the parameters. In that context, all the results are displayed with the proposed <strong>Optimized Blockwise NL-means</strong> filter, even if equivalent conclusions can be drawn with the <strong>NL-means</strong>, <strong>Optimized NL-means</strong> and <strong>Blockwise NL-means</strong> filters.</p><p id="P70" class="p">Validation was performed on T1-w and T2-w MRI, but the results concerning the study of the parameter influences are shown for T1-w MRI only. The results on T2-w MRI are shown in section V-F in order to underline that the parameters calibrated for T1-w MRI work fine on T2-w MRI.</p><div id="S20" class="sec"><h3 id="S20title">A. Influence of the automatic tuning of smoothing parameter h</h3><p id="P71" class="p p-first-last"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F6/" target="figure" class="fig-table-link figpopup" rid-figpopup="F6" rid-ob="ob-F6" co-legend-rid="lgnd_F6"><span>Figure 6</span></a> shows the influence of the automatic determination of the smoothing parameter <em>h</em><sup>2</sup> = 2<em>β<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1161" role="math" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.104em, 1000.61em, 1.171em, -999.997em); top: -1.014em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1162"><span class="mover" id="MathJax-Span-1163"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.51em, 4.169em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1164" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1000.56em, 3.61em, -999.997em); top: -4.012em; left: 0.053em;"><span class="mo" id="MathJax-Span-1165" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.019em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-29"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup>|<em>N<sub>i</sub></em>|. As described in III-B.1, <em>h</em> is a function of the global standard deviation of the noise <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1166" role="math" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.104em, 1000.61em, 1.171em, -999.997em); top: -1.014em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1167"><span class="mover" id="MathJax-Span-1168"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.51em, 4.169em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1169" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1000.56em, 3.61em, -999.997em); top: -4.012em; left: 0.053em;"><span class="mo" id="MathJax-Span-1170" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.019em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-30"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em> in the volume esimated from pseudo-residuals (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD4" rid="FD4" class=" disp-formula">Eq. 4</a>). Here, <em>β</em> allows to adjust the automatic estimation of <em>h</em> in order to determine the optimal smoothing parameter 2<em>β<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1171" role="math" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.104em, 1000.61em, 1.171em, -999.997em); top: -1.014em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1172"><span class="mover" id="MathJax-Span-1173"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px;"><span style="position: absolute; clip: rect(3.458em, 1000.51em, 4.169em, -999.997em); top: -4.012em; left: 0.003em;"><span class="mi" id="MathJax-Span-1174" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1000.56em, 3.61em, -999.997em); top: -4.012em; left: 0.053em;"><span class="mo" id="MathJax-Span-1175" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.019em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-31"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup>|<em>N<sub>i</sub></em>| for each level of noise (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R6" rid="R6" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474437">6</a>). For low levels of noise the best value of <em>β</em> is close to 0.5. For high levels of noise this value is 1. These results show that the estimation of the standard deviation of the noise is correctly performed by pseudo-residuals. These observations underline (a) how efficient the automatic estimation of the smoothing parameter <em>h</em> is, and (b) how the NL-means can be used without manual parameter tuning.</p></div><div id="S21" class="sec"><h3 id="S21title">B. Influence of the size of the search volume and the neighborhood</h3><p id="P72" class="p p-first-last"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F7/" target="figure" class="fig-table-link figpopup" rid-figpopup="F7" rid-ob="ob-F7" co-legend-rid="lgnd_F7"><span>Figure 7</span></a> shows the influence of the size of the search volume and the local neighborhood. Increasing the number of voxels in the search volume <em>V<sub>i</sub></em> does not seem to affect the PSNR when <em>M</em> is greater than 5. Indeed, the theoretic definition of the NL-means filter states that the weighted average (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD1" rid="FD1" class=" disp-formula">Eq. 1</a>) computed for the restoration of voxel <em>x<sub>i</sub></em> should be performed on all voxels <em>x<sub>j</sub></em> ∈ Ω<sup>3</sup>. Practically, the limit <em>M</em> = 5 prevents useless computations. Moreover, increasing <em>d</em> degrades the denoising process. When <em>d</em> increases the NL-means filter drastically slows down. That is why we have not investigated the impact of <em>d</em> for d &gt; 3.</p></div><div id="S22" class="sec"><h3 id="S22title">C. Influence of the voxel selection</h3><p id="P73" class="p p-first">The selection of the voxels in the search volume <em>V<sub>i</sub></em> is achieved by supposing that only the voxels whose the neighborhood is similar to the neighborhood of the voxel under study could be considered (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD1" rid="FD1" class=" disp-formula">Eq. 1</a>). To do so, as defined in III-B.2, the weight <em>w</em>(<em>x<sub>i</sub>, x<sub>j</sub></em>) is calculated only for voxels such that: 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M26" overflow="scroll" role="math" style="width: 7.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.9em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.363em, 1005.9em, 3.43em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1177"><span class="mrow" id="MathJax-Span-1178"><span class="msub" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.51em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1180"><span class="mi" id="MathJax-Span-1181" style="font-family: STIXGeneral-Italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.727em; left: 0.507em;"><span class="mn" id="MathJax-Span-1182" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1183" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-1184" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1185"><span class="mfrac" id="MathJax-Span-1186"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.329em, 1001.16em, 4.287em, -999.997em); top: -4.483em; left: 50%; margin-left: -0.552em;"><span class="mrow" id="MathJax-Span-1187"><span class="mover" id="MathJax-Span-1188"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1001.11em, 4.287em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1189"><span class="mi" id="MathJax-Span-1190" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1191" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1192"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1193"><span class="mi" id="MathJax-Span-1194" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1195" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1196" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.682em, 1001.16em, 4.035em, -999.997em); top: -4.332em; left: 0.003em;"><span class="mo" id="MathJax-Span-1197" style=""><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; top: -3.979em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.011em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.103em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.204em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.305em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.406em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.557em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.658em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.759em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.859em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.16em, 4.388em, -999.997em); top: -3.526em; left: 50%; margin-left: -0.552em;"><span class="mrow" id="MathJax-Span-1198"><span class="mover" id="MathJax-Span-1199"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.48em, 1001.11em, 4.388em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1200"><span class="mi" id="MathJax-Span-1201" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1202" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1204"><span class="mi" id="MathJax-Span-1205" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1206" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1207" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.682em, 1001.16em, 4.035em, -999.997em); top: -4.332em; left: 0.003em;"><span class="mo" id="MathJax-Span-1208" style=""><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; top: -3.979em; left: 0.003em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 1.011em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.103em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.204em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.305em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.406em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.557em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.658em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.759em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.979em; left: 0.859em;"><span style="font-size: 50%; font-family: STIXGeneral-Regular;">⎯</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.26em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.263em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1209" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-1210" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1211"><span class="mfrac" id="MathJax-Span-1212"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-1213" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.632em, 1000.56em, 4.287em, -999.997em); top: -3.727em; left: 50%; margin-left: -0.249em;"><span class="mrow" id="MathJax-Span-1214"><span class="msub" id="MathJax-Span-1215"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.236em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1216"><span class="mi" id="MathJax-Span-1217" style="font-size: 50%; font-family: STIXGeneral-Italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.255em;"><span class="mn" id="MathJax-Span-1218" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.66em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.658em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.253em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-32"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" overflow="scroll"><mrow><msub><mrow><mi>μ</mi></mrow><mn>1</mn></msub><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow></mfrac></mstyle><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msub><mrow><mi>μ</mi></mrow><mn>1</mn></msub></mrow></mfrac></mstyle></mrow></math></script> and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M27" overflow="scroll" role="math" style="width: 8.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.059em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.565em, 1007.06em, 3.43em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1220"><span class="mrow" id="MathJax-Span-1221"><span class="msubsup" id="MathJax-Span-1222"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1223"><span class="mi" id="MathJax-Span-1224" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1227" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-1228" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1229"><span class="mfrac" id="MathJax-Span-1230"><span style="display: inline-block; position: relative; width: 2.321em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1002.17em, 4.287em, -999.997em); top: -4.483em; left: 50%; margin-left: -1.106em;"><span class="mrow" id="MathJax-Span-1231"><span class="mtext" id="MathJax-Span-1232" style="font-size: 50%; font-family: STIXGeneral-Regular;">Var</span><span class="mo" id="MathJax-Span-1233" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1234" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1235" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1236"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1237"><span class="mi" id="MathJax-Span-1238" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1239" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1240" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1241" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1002.17em, 4.388em, -999.997em); top: -3.677em; left: 50%; margin-left: -1.106em;"><span class="mrow" id="MathJax-Span-1242"><span class="mtext" id="MathJax-Span-1243" style="font-size: 50%; font-family: STIXGeneral-Regular;">Var</span><span class="mo" id="MathJax-Span-1244" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1245" style="font-size: 50%; font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1246" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1247"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1248"><span class="mi" id="MathJax-Span-1249" style="font-size: 50%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mi" id="MathJax-Span-1250" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1251" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1252" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1002.32em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.321em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1253" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">&lt;</span><span class="mstyle" id="MathJax-Span-1254" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1255"><span class="mfrac" id="MathJax-Span-1256"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.2em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.098em;"><span class="mn" id="MathJax-Span-1257" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.61em, 4.388em, -999.997em); top: -3.475em; left: 50%; margin-left: -0.3em;"><span class="mrow" id="MathJax-Span-1258"><span class="msubsup" id="MathJax-Span-1259"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1000.25em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-size: 50%; font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -4.131em; left: 0.305em;"><span class="mn" id="MathJax-Span-1262" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.3em, 4.136em, -999.997em); top: -3.727em; left: 0.255em;"><span class="mn" id="MathJax-Span-1263" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.71em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.708em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-33"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>&lt;</mo><mstyle scriptlevel="1"><mfrac><mn>1</mn><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow></math></script>. The influence of the limits <em>μ</em><sub>1</sub> and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M28" overflow="scroll" role="math" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.053em, 1001.01em, 1.464em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1265"><span class="mrow" id="MathJax-Span-1266"><span class="msubsup" id="MathJax-Span-1267"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1268"><span class="mi" id="MathJax-Span-1269" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1270" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1271" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-34"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></math></script> is studied in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F8/" target="figure" class="fig-table-link figpopup" rid-figpopup="F8" rid-ob="ob-F8" co-legend-rid="lgnd_F8"><span>Figure 8</span></a>. In a first experiment <em>μ</em><sub>1</sub> varies according to <em>γ</em> such as <em>μ</em><sub>1</sub> = 1 − <em>γ</em> while 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M29" overflow="scroll" role="math" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.565em, 1003.53em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1273"><span class="mrow" id="MathJax-Span-1274"><span class="msubsup" id="MathJax-Span-1275"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1276"><span class="mi" id="MathJax-Span-1277" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1280" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1281" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">0.5</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-35"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>0.5</mn></mrow></math></script>. In a second experiment 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M30" overflow="scroll" role="math" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.053em, 1001.01em, 1.464em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1283"><span class="mrow" id="MathJax-Span-1284"><span class="msubsup" id="MathJax-Span-1285"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1286"><span class="mi" id="MathJax-Span-1287" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1288" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1289" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-36"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></math></script> varies according to <em>γ</em> following 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M31" overflow="scroll" role="math" style="width: 5.597em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.488em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.565em, 1004.49em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1291"><span class="mrow" id="MathJax-Span-1292"><span class="msubsup" id="MathJax-Span-1293"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1294"><span class="mi" id="MathJax-Span-1295" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1296" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1297" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1298" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1299" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">1</span><span class="mo" id="MathJax-Span-1300" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">−</span><span class="mi" id="MathJax-Span-1301" style="font-family: STIXGeneral-Italic; padding-left: 0.255em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-37"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>1</mn><mo>−</mo><mi>γ</mi></mrow></math></script> while <em>μ</em><sub>1</sub> = 0.95.</p><p id="P74" class="p p-last"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F8/" target="figure" class="fig-table-link figpopup" rid-figpopup="F8" rid-ob="ob-F8" co-legend-rid="lgnd_F8"><span>Figure 8</span></a> (left) shows that a restrictive selection based on the mean (low values of <em>γ</em>) increases the PSNR. In other words, the number of voxels taken into account in the weighted average is drastically reduced, as well as the computational time (also see Tab. II). The optimal limits were obtained for <em>μ</em><sub>1</sub> = 0.95 while 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M32" overflow="scroll" role="math" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.565em, 1003.53em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1303"><span class="mrow" id="MathJax-Span-1304"><span class="msubsup" id="MathJax-Span-1305"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1306"><span class="mi" id="MathJax-Span-1307" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1308" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1309" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1310" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1311" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">0.5</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-38"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>0.5</mn></mrow></math></script>. Concerning the variance (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F8/" target="figure" class="fig-table-link figpopup" rid-figpopup="F8" rid-ob="ob-F8" co-legend-rid="lgnd_F8"><span>Figure 8</span></a>, right), we observe that a too restrictive selection degrades the PSNR. In addition, a too permissive selection does not increase the PSNR while increasing uselessly the computational burden. A compromise was found by fixing 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M33" overflow="scroll" role="math" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.565em, 1003.53em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1313"><span class="mrow" id="MathJax-Span-1314"><span class="msubsup" id="MathJax-Span-1315"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.43em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1316"><span class="mi" id="MathJax-Span-1317" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.607em;"><span class="mn" id="MathJax-Span-1318" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 0.507em;"><span class="mn" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1320" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1321" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">0.5</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-39"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>0.5</mn></mrow></math></script>. There is a clear dependency between the bounds for the mean and the variance. An optimal trade-off was determined experimentally.</p></div><div id="S23" class="sec"><h3 id="S23title">D. Influence of the blockwise implementation</h3><p id="P75" class="p p-first-last">Tab. II shows that the blockwise approach of the NL-means filter, with and without voxels selection (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#FD11" rid="FD11" class=" disp-formula">Eq. 11</a>), allows to drastically reduce the computational time. With a distance between the block centers <em>n</em> = 2, the blockwise approach divides this time by a factor 2<sup>3</sup> = 8 (see Tab. II). However, computational time reduction needs to be balanced with a slight decrease of the PSNR (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F9/" target="figure" class="fig-table-link figpopup" rid-figpopup="F9" rid-ob="ob-F9" co-legend-rid="lgnd_F9"><span>Fig. 9</span></a>, left). For the optimized versions, the voxels/blocks selection in the search volume has several impacts. First, by reducing the average number of voxels/blocks used in the weighted averages, this decreases the computational time compared to the non-optimized versions (see Tab. II). Second, the selection of the most relevant voxels/blocks increases the quality of denoising for all the noise levels (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F9/" target="figure" class="fig-table-link figpopup" rid-figpopup="F9" rid-ob="ob-F9" co-legend-rid="lgnd_F9"><span>Fig. 9</span></a> (left) and Tab. II).</p></div><div id="S24" class="sec"><h3 id="S24title">E. Multithreading</h3><p id="P76" class="p p-first">As described in section III-B.4, the multithreading in the case of the NL-means filter is particularly adapted due its non iterative nature. For the classical pixelwise NL-means implementation, the parallelization allows to divide the computational time by a factor close to the numbers of CPU. As eight processors were used for our experiments, the computational time with multithreading is about 8 times smaller (see Tab. II, 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M34" overflow="scroll" role="math" style="width: 5.698em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.589em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.716em, 1004.54em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1323"><span class="mrow" id="MathJax-Span-1324"><span class="mstyle" id="MathJax-Span-1325"><span class="mrow" id="MathJax-Span-1326"><span class="mfrac" id="MathJax-Span-1327"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1001.26em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-1328"><span class="mn" id="MathJax-Span-1329" style="font-size: 50%; font-family: STIXGeneral-Regular;">21790</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1001.01em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.502em;"><span class="mrow" id="MathJax-Span-1330"><span class="mn" id="MathJax-Span-1331" style="font-size: 50%; font-family: STIXGeneral-Regular;">2780</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.36em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.363em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1332" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1333" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">7.84</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-40"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" overflow="scroll"><mrow><mstyle scriptlevel="1"><mfrac><mrow><mn>21790</mn></mrow><mrow><mn>2780</mn></mrow></mfrac></mstyle><mo>=</mo><mn>7.84</mn></mrow></math></script> and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M35" overflow="scroll" role="math" style="width: 5.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.337em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.666em, 1004.29em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1335"><span class="mrow" id="MathJax-Span-1336"><span class="mstyle" id="MathJax-Span-1337"><span class="mrow" id="MathJax-Span-1338"><span class="mfrac" id="MathJax-Span-1339"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.96em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.502em;"><span class="mrow" id="MathJax-Span-1340"><span class="mn" id="MathJax-Span-1341" style="font-size: 50%; font-family: STIXGeneral-Regular;">3169</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.76em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-1342"><span class="mn" id="MathJax-Span-1343" style="font-size: 50%; font-family: STIXGeneral-Regular;">436</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.11em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.111em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1344" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1345" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">7.27</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-41"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" overflow="scroll"><mrow><mstyle scriptlevel="1"><mfrac><mrow><mn>3169</mn></mrow><mrow><mn>436</mn></mrow></mfrac></mstyle><mo>=</mo><mn>7.27</mn></mrow></math></script>). For the blockwise implementations the speedup is less 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M36" overflow="scroll" role="math" style="width: 5.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.337em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.716em, 1004.29em, 3.027em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1347"><span class="mrow" id="MathJax-Span-1348"><span class="mstyle" id="MathJax-Span-1349"><span class="mrow" id="MathJax-Span-1350"><span class="mfrac" id="MathJax-Span-1351"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1001.01em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.502em;"><span class="mrow" id="MathJax-Span-1352"><span class="mn" id="MathJax-Span-1353" style="font-size: 50%; font-family: STIXGeneral-Regular;">1800</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.71em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-1354"><span class="mn" id="MathJax-Span-1355" style="font-size: 50%; font-family: STIXGeneral-Regular;">251</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.11em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.111em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1356" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1357" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">7.17</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-42"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" overflow="scroll"><mrow><mstyle scriptlevel="1"><mfrac><mrow><mn>1800</mn></mrow><mrow><mn>251</mn></mrow></mfrac></mstyle><mo>=</mo><mn>7.17</mn></mrow></math></script> and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M37" overflow="scroll" role="math" style="width: 5.093em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.085em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.666em, 1004.03em, 2.976em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1359"><span class="mrow" id="MathJax-Span-1360"><span class="mstyle" id="MathJax-Span-1361"><span class="mrow" id="MathJax-Span-1362"><span class="mfrac" id="MathJax-Span-1363"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1000.71em, 4.136em, -999.997em); top: -4.332em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-1364"><span class="mn" id="MathJax-Span-1365" style="font-size: 50%; font-family: STIXGeneral-Regular;">328</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.46em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.249em;"><span class="mrow" id="MathJax-Span-1366"><span class="mn" id="MathJax-Span-1367" style="font-size: 50%; font-family: STIXGeneral-Regular;">63</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1000.86em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.859em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1368" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-1369" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">5.37</span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-43"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" overflow="scroll"><mrow><mstyle scriptlevel="1"><mfrac><mrow><mn>328</mn></mrow><mrow><mn>63</mn></mrow></mfrac></mstyle><mo>=</mo><mn>5.37</mn></mrow></math></script>). The difference of speedup between the classical NL-means and the blockwise NL-means filters have two origins.</p><ul class="unordered" style="list-style-type:disc"><!--
list-behavior=unordered
prefix-word=
mark-type=disc
max-label-size=0
--><li><p id="P77">First, in blockwise version several threads could write at the same memory location (i.e. vector <em>A<sub>i</sub></em>) at the same time. In multi-treading programming this kind of possibilities requires a lock which protects the memory location during the writing. Unfortunately, to lock a memory location speeds down the computational process.</p></li><li><p id="P78">Second, as the required computation time is shorter for the blockwise than for the voxelwise implementation, the relative contribution of the non-multithreaded operations in the overall computation time (opening and closing of file, computation of the local maps, etc.) is much higher in the blockwise compared to the voxelwise implementation. As a consequence, the speed-up factor will be higher in the latter</p></li></ul><p id="P79">In order to underline that the utilization of 8-CPUs is not required by our filter, the denoising have been also performed on a more common architecture: a DualCore Intel(R) Pentium(R) D CPU 3.40GHz. The results show that our filter takes less than 3 minutes to denoise a volume 181 × 217 × 181 voxels on this architecture.</p><p id="P80" class="p p-last">To conclude, the different improvements included in the proposed <strong>Optimized Blockwise NL-means</strong> filter (i.e., blockwise approach and blocks selection) allow to speed up the denoising procedure, compared to <strong>NL-means</strong> filter, by a factor of 66 on 1 Xeon at 3GHz, 44 on 8× Xeon at 3GHz and 31 on a DualCore at 3.40GHz.</p></div><div id="S25" class="sec"><h3 id="S25title">F. Optimized Blockwise NL-means filter on T2-w MRI with MS</h3><p id="P81" class="p p-first-last"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F9/" target="figure" class="fig-table-link figpopup" rid-figpopup="F9" rid-ob="ob-F9" co-legend-rid="lgnd_F9"><span>Figure 9</span></a> (right) presents the results obtained by the different NL-means filter versions on T2-w MRI with MS lesions. The optimal parameters (i.e. the default parameters described in section V), experimentally determined on T1-w MRI, and the automatic tuning of <em>h</em> were used on T2-w MRI. The <strong>Optimized NL-means</strong> and <strong>Optimized Blockwise NL-means</strong> filters outperform the <strong>NL-means</strong> and <strong>Blockwise NL-means</strong> filters also on T2-w MRI. The most important difference between the optimized and non-optimized versions are observed on T2-w MRI, which could be explained by the higher level of noise in the simulated T2-w MRI compared to T1- w MRI. Actually, the variance of noise varies with respect to the highest intensity tissues which is 150 in T1-w and 250 in T2-w. For 9% the variance of noise is 13.5 in T1-w images and is 22.5 in T2-w images because the highest tissue intensity is superior in T2-w images. These results suggest that the parameters experimentally tuned on T1-w images can be used for T2-w images. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F10/" target="figure" class="fig-table-link figpopup" rid-figpopup="F10" rid-ob="ob-F10" co-legend-rid="lgnd_F10"><span>Figure 10</span></a> shows an example of denoising obtained by the optimized blockwise NL-means and the blockwise NL-means filters. The MS lesions are visually more preserved with the optimized version; this was confirmed by an experienced MRI reader.</p></div><div id="S26" class="sec sec-last"><h3 id="S26title">G. Comparison with other denoising methods</h3><div id="S27" class="sec sec-first"><p></p><h4 id="S27title" class="inline">1.  Focus on two classical denoising approaches </h4><div id="S28" class="sec sec-first"><p></p><h5 id="S28title" class="inline">a.  Anisotropic Diffusion filtering </h5><p id="P82" class="p p-first">As reported in Section II, the Anisotropic Diffusion filter (AD) was introduced to overcome the blurring effect of the Gaussian smoothing approach. First introduced by Perona and Malik [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>], in this approach the image <em>u</em> is only convolved in the direction orthogonal to the gradient of the image which ensures the preservation of edges. The iterative denoising process of initial image <em>u</em><sub>0</sub> can be expressed as: 
</p><div class="disp-formula" id="FD14"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="M38" overflow="scroll" role="math" style="width: 14.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.545em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.422em, 1011.34em, 5.345em, -999.997em); top: -4.131em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1371"><span class="mrow" id="MathJax-Span-1372"><span class="mrow" id="MathJax-Span-1373"><span class="mo" id="MathJax-Span-1374" style="vertical-align: -0.602em;"><span style="font-family: STIXSizeThreeSym;">{</span></span><span class="mrow" id="MathJax-Span-1375"><span class="mtable" id="MathJax-Span-1376" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 10.335em; height: 0px;"><span style="position: absolute; clip: rect(2.321em, 1010.28em, 5.144em, -999.997em); top: -3.979em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 10.335em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1010.28em, 4.438em, -999.997em); top: -4.735em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1377"><span class="mrow" id="MathJax-Span-1378"><span class="mrow" id="MathJax-Span-1379"><span class="mstyle" id="MathJax-Span-1380"><span class="mrow" id="MathJax-Span-1381"><span class="mfrac" id="MathJax-Span-1382"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1001.31em, 4.236em, -999.997em); top: -4.383em; left: 50%; margin-left: -0.653em;"><span class="mrow" id="MathJax-Span-1383"><span class="mo" id="MathJax-Span-1384" style="font-size: 50%; font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-1385" style="font-size: 50%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1386" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1387" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1388" style="font-size: 50%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1389" style="font-size: 50%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1390" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.41em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.199em;"><span class="mrow" id="MathJax-Span-1391"><span class="mo" id="MathJax-Span-1392" style="font-size: 50%; font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-1393" style="font-size: 50%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.41em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.414em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1394" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mtext" id="MathJax-Span-1395" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">div</span><span class="mo" id="MathJax-Span-1396" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1397" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-1398" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1399" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1400" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1401" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1402" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1403" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-1404" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1405" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1406" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1407" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1408" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1409" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1410" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1005.85em, 4.337em, -999.997em); top: -3.122em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1411"><span class="mrow" id="MathJax-Span-1412"><span class="mrow" id="MathJax-Span-1413"><span class="mi" id="MathJax-Span-1414" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1415" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1416" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1417" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-1418" style="font-family: STIXGeneral-Regular; padding-left: 0.204em;">0</span><span class="mo" id="MathJax-Span-1419" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1420" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="msub" id="MathJax-Span-1421" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1422"><span class="mi" id="MathJax-Span-1423" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="mn" id="MathJax-Span-1424" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1425" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1426" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1427" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.136em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.372em; border-left: 0px solid; width: 0px; height: 3.378em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-44"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" display="block" overflow="scroll"><mrow><mrow><mo>{</mo><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><mstyle scriptlevel="1"><mfrac><mrow><mo>∂</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac></mstyle><mo>=</mo><mtext>div</mtext><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∇</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mi>u</mi></mrow><mn>0</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mtd></mtr></mtable></mrow></mrow></mrow></math></script></div><div class="l">(14)</div></div><p> where ∇ <em>u</em>(<em>x, t</em>) is the image gradient at voxel <em>x</em> and iteration <em>t</em>, 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M39" overflow="scroll" role="math" style="width: 2.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.103em, 1001.62em, 1.464em, -999.997em); top: -1.006em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1429"><span class="mrow" id="MathJax-Span-1430"><span class="mstyle" id="MathJax-Span-1431"><span class="mrow" id="MathJax-Span-1432"><span class="mfrac" id="MathJax-Span-1433"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1001.31em, 4.236em, -999.997em); top: -4.383em; left: 50%; margin-left: -0.653em;"><span class="mrow" id="MathJax-Span-1434"><span class="mo" id="MathJax-Span-1435" style="font-size: 50%; font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-1436" style="font-size: 50%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1437" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1438" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1439" style="font-size: 50%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1440" style="font-size: 50%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1441" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.41em, 4.136em, -999.997em); top: -3.677em; left: 50%; margin-left: -0.199em;"><span class="mrow" id="MathJax-Span-1442"><span class="mo" id="MathJax-Span-1443" style="font-size: 50%; font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-1444" style="font-size: 50%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1001.41em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.414em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.011em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-45"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" overflow="scroll"><mrow><mstyle scriptlevel="1"><mfrac><mrow><mo>∂</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mo>∂</mo><mi>t</mi></mrow></mfrac></mstyle></mrow></math></script> is the partial temporal deviation of <em>u</em>(<em>x, t</em>) and</p><p id="P83" class="p p-last">
</p><div class="disp-formula" id="FD15"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="M40" overflow="scroll" role="math" style="width: 17.543em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.115em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.011em, 1014.12em, 2.876em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1446"><span class="mrow" id="MathJax-Span-1447"><span class="mi" id="MathJax-Span-1448" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-1449" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1450" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1451" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1452" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1453" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1454" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1455" style="font-family: STIXGeneral-Italic; padding-left: 0.305em;">g</span><span class="mo" id="MathJax-Span-1456" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-1457" style="font-family: STIXGeneral-Regular;">∥</span><span class="mo" id="MathJax-Span-1458" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">∇</span><span class="mi" id="MathJax-Span-1459" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1460" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1461" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1462" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1463" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1464" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1465" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">∥</span><span class="mo" id="MathJax-Span-1466" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1467" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="msup" id="MathJax-Span-1468" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.329em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1469"><span class="mi" id="MathJax-Span-1470" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.534em; left: 0.456em;"><span class="mrow" id="MathJax-Span-1471"><span class="mo" id="MathJax-Span-1472" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mstyle" id="MathJax-Span-1473"><span class="mrow" id="MathJax-Span-1474"><span class="mfrac" id="MathJax-Span-1475"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.48em, 1001.92em, 4.236em, -999.997em); top: -4.383em; left: 50%; margin-left: -1.006em;"><span class="mrow" id="MathJax-Span-1476"><span class="mo" id="MathJax-Span-1477" style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span><span class="mo" id="MathJax-Span-1478" style="font-size: 50%; font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-1479" style="font-size: 50%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1480" style="font-size: 50%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1481" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1482" style="font-size: 50%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1483" style="font-size: 50%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1484" style="font-size: 50%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1485" style="font-size: 50%; font-family: STIXGeneral-Regular;">∥</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.71em, 4.136em, -999.997em); top: -3.526em; left: 50%; margin-left: -0.35em;"><span class="mrow" id="MathJax-Span-1486"><span class="msup" id="MathJax-Span-1487"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1488"><span class="mi" id="MathJax-Span-1489" style="font-size: 50%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.131em; left: 0.406em;"><span class="mn" id="MathJax-Span-1490" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1002.07em, 1.212em, -999.997em); top: -1.207em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 2.069em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 2.066em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-46"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" display="block" overflow="scroll"><mrow><mi>c</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mo stretchy="false">∥</mo><mo>∇</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">∥</mo><mo stretchy="false">)</mo><mo>=</mo><msup><mrow><mi>e</mi></mrow><mrow><mo>−</mo><mstyle scriptlevel="1"><mfrac><mrow><mo>∥</mo><mo>∇</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∥</mo></mrow><mrow><msup><mrow><mi>K</mi></mrow><mn>2</mn></msup></mrow></mfrac></mstyle></mrow></msup></mrow></math></script></div><div class="l">(15)</div></div><p> where <em>K</em> is the diffusivity parameter. The AD filter method produces a good preservation of edges [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R34" rid="R34" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474434">34</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R35" rid="R35" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474438">35</a>]. Nonetheless, the main disadvantage of Ad filter is to poorly denoise the constant regions (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a>).</p></div><div id="S29" class="sec sec-last"><p></p><h5 id="S29title" class="inline">b.  Total Variation minimization scheme </h5><p id="P84" class="p p-first">The difficult task to preserve edges while correctly denoising constant areas has been addressed also by Rudin, Osher and Fatemi. They proposed to minimize the Total Variation (TV) norm subject to noise constraints [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R4" rid="R4" class=" bibr popnode">4</a>], that is: 
</p><div class="disp-formula" id="FD16"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="M41" overflow="scroll" role="math" style="width: 13.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.738em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.119em, 1010.74em, 4.69em, -999.997em); top: -3.627em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1492"><span class="mrow" id="MathJax-Span-1493"><span class="mover" id="MathJax-Span-1494"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.053em;"><span class="mi" id="MathJax-Span-1495" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1000.56em, 3.581em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1496" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1497" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-1498" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">arg</span><span class="munder" id="MathJax-Span-1499" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.666em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.57em, 4.136em, -999.997em); top: -3.979em; left: 0.053em;"><span class="mrow" id="MathJax-Span-1500"><span class="mo" id="MathJax-Span-1501" style="font-family: STIXGeneral-Regular;">min</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.67em, 4.236em, -999.997em); top: -3.173em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1502"><span class="mi" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msup" id="MathJax-Span-1505"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1506"><span class="mi" id="MathJax-Span-1507" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.282em; left: 0.507em;"><span class="mn" id="MathJax-Span-1508" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1509" style="padding-left: 0.204em;"><span class="mo" id="MathJax-Span-1510" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.456em;"></span></span><span class="mrow" id="MathJax-Span-1511"><span class="mo" id="MathJax-Span-1512" style="font-family: STIXGeneral-Regular;">∣</span><span class="mo" id="MathJax-Span-1513" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-1514" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1515" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1516" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1517" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1518" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">∣</span><span class="mi" id="MathJax-Span-1519" style="font-family: STIXGeneral-Italic; padding-left: 0.305em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-1520" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.632em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-47"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" display="block" overflow="scroll"><mrow><mover accent="true"><mi>u</mi><mo>^</mo></mover><mo>=</mo><mo>arg</mo><munder><mrow><mo>min</mo></mrow><mrow><mi>u</mi><mo>∈</mo><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup></mrow></munder><mrow><mo>∫</mo><mrow><mo>∣</mo><mo>∇</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∣</mo><mi>d</mi><mi>x</mi></mrow></mrow></mrow></math></script></div><div class="l">(16)</div></div><p> subject to</p><p id="P85" class="p p-last">
</p><div class="disp-formula" id="FD17"><div class="f">∫<sub>Ω<sup>3</sup></sub>(<em>u</em>(<em>x</em>)−<em>u</em><sub>0</sub>(<em>x</em>))<em>d</em><em>x</em> =&nbsp;0 and ∫<sub>Ω<sup>3</sup></sub>∣<em>u</em>(<em>x</em>)−<em>u</em><sub>0</sub>(<em>x</em>)∣<sup>2</sup><em>d</em><em>x</em> =&nbsp;σ<sup>2</sup></div><div class="l">(17)</div></div><p> where <em>u</em><sub>0</sub> is the original noisy image, <em>u</em> is the restored image and <em>σ</em> the standard deviation of the noise. In this model, the TV minimization tends to smooth inside the image structures while keeping the integrity of boundaries. The TV minimization scheme can be expressed as an unconstrained problem: 
</p><div class="disp-formula" id="FD18"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="M43" overflow="scroll" role="math" style="width: 28.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.986em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(2.523em, 1022.78em, 5.244em, -999.997em); top: -4.131em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1522"><span class="mrow" id="MathJax-Span-1523"><span class="mover" id="MathJax-Span-1524"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.053em;"><span class="mi" id="MathJax-Span-1525" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1000.56em, 3.581em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1526" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1527" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-1528" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">arg</span><span class="munder" id="MathJax-Span-1529" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.666em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.57em, 4.136em, -999.997em); top: -3.979em; left: 0.053em;"><span class="mrow" id="MathJax-Span-1530"><span class="mo" id="MathJax-Span-1531" style="font-family: STIXGeneral-Regular;">min</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.67em, 4.236em, -999.997em); top: -3.173em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1532"><span class="mi" id="MathJax-Span-1533" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msup" id="MathJax-Span-1535"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1536"><span class="mi" id="MathJax-Span-1537" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.282em; left: 0.507em;"><span class="mn" id="MathJax-Span-1538" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1539" style="padding-left: 0.204em;"><span class="mo" id="MathJax-Span-1540" style="vertical-align: -0.602em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mrow" id="MathJax-Span-1541"><span class="mrow" id="MathJax-Span-1542"><span class="msub" id="MathJax-Span-1543"><span style="display: inline-block; position: relative; width: 1.515em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1001.06em, 5.043em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1544" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.456em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.072em; left: 0.607em;"><span class="mrow" id="MathJax-Span-1545"><span class="msup" id="MathJax-Span-1546"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1547"><span class="mi" id="MathJax-Span-1548" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.282em; left: 0.507em;"><span class="mn" id="MathJax-Span-1549" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1550"><span class="mo" id="MathJax-Span-1551" style="font-family: STIXGeneral-Regular;">∣</span><span class="mo" id="MathJax-Span-1552" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-1553" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1554" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1555" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1556" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1557" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">∣</span><span class="mi" id="MathJax-Span-1558" style="font-family: STIXGeneral-Italic; padding-left: 0.305em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-1559" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1560" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-1561" style="font-family: STIXGeneral-Italic; padding-left: 0.255em;">λ</span><span class="mrow" id="MathJax-Span-1562" style="padding-left: 0.204em;"><span class="msub" id="MathJax-Span-1563"><span style="display: inline-block; position: relative; width: 1.515em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1001.06em, 5.043em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1564" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.456em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.072em; left: 0.607em;"><span class="mrow" id="MathJax-Span-1565"><span class="msup" id="MathJax-Span-1566"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1567"><span class="mi" id="MathJax-Span-1568" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">Ω</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.282em; left: 0.507em;"><span class="mn" id="MathJax-Span-1569" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1570"><span class="mo" id="MathJax-Span-1571" style="vertical-align: 0.91em;"><span style="display: inline-block; position: relative; width: 0.255em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.274em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -2.87em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1572" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1573" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1574" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1575" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1576" style="font-family: STIXGeneral-Regular; padding-left: 0.255em;">−</span><span class="msub" id="MathJax-Span-1577" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1578"><span class="mi" id="MathJax-Span-1579" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="mn" id="MathJax-Span-1580" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1581" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1582" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1583" style="font-family: STIXGeneral-Regular;">)</span><span class="msup" id="MathJax-Span-1584" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.15em, 4.337em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1585"><span class="mo" id="MathJax-Span-1586" style="font-family: STIXGeneral-Regular;">∣</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.255em;"><span class="mn" id="MathJax-Span-1587" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1588" style="font-family: STIXGeneral-Italic; padding-left: 0.305em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mi" id="MathJax-Span-1589" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1590" style="vertical-align: -0.602em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.136em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.191em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-48"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" display="block" overflow="scroll"><mrow><mover accent="true"><mi>u</mi><mo>^</mo></mover><mo>=</mo><mo>arg</mo><munder><mrow><mo>min</mo></mrow><mrow><mi>u</mi><mo>∈</mo><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup></mrow></munder><mrow><mo>[</mo><mrow><mrow><msub><mo>∫</mo><mrow><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup></mrow></msub><mrow><mo>∣</mo><mo>∇</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∣</mo><mi>d</mi><mi>x</mi></mrow></mrow><mo>+</mo><mi>λ</mi><mrow><msub><mo>∫</mo><mrow><msup><mrow><mi mathvariant="normal">Ω</mi></mrow><mn>3</mn></msup></mrow></msub><mrow><mo>∣</mo><mi>u</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mrow><mi>u</mi></mrow><mn>0</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mrow><mo>∣</mo></mrow><mn>2</mn></msup><mi>d</mi><mi>x</mi></mrow></mrow></mrow><mo>]</mo></mrow></mrow></math></script></div><div class="l">(18)</div></div><p> where <em>λ</em> is a Lagrange multiplier which controls the balance between the TV norm and the fidelity term. Thus, <em>λ</em> acts as the filtering parameter. Indeed, for high values for <em>λ</em> the fidelity term is encouraged. For small values for <em>λ</em> the regularity term is desired. In practice, the TV minimization scheme tends to remove texture and small image structures as seen in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R36" rid="R36" class=" bibr popnode">36</a>]. To solve this problem, iterative total variation schemes have been recently developed [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R55" rid="R55" class=" bibr popnode">55</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R56" rid="R56" class=" bibr popnode">56</a>].</p></div></div><div id="S30" class="sec sec-last"><p></p><h4 id="S30title" class="inline">2.  Quantitative and qualitative comparison </h4><p id="P86" class="p p-first">The main difficulty to achieve this comparison is related to the tuning of smoothing parameters in order to obtain the best results for AD filter and TV minimization scheme. In order not to penalize AD filter and TV minimization scheme, an exhaustive search for all parameters into a certain range. Then, the best results obtained with AD filter and TV minimization have been selected, whereas the fully-automatic results have been mentioned for the NL-means filters. The results of the NL-means filters are not “optimal” due to the non perfect estimation of the noise standard deviation. For AD filter, the parameter K varies from 0.05 to 1 with a step of 0.05 and the number of iterations varies from 1 to 10. For TV minimization, the parameter <em>λ</em> varies from 0.01 to 1 with step of 0.01 and the number of iterations varies from 1 to 10. The results obtained for 9% of Gaussian noise are presented <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F11/" target="figure" class="fig-table-link figpopup" rid-figpopup="F11" rid-ob="ob-F11" co-legend-rid="lgnd_F11"><span>Fig. 11</span></a>, but this screening have been performed for the four levels of noise. It is important to underline that the results giving the best PSNR are used, but these results do not necessary give the best visual output. Indeed, the best PSNR for AD filter is obtained for a visually under-smoothed image since this method tends to spoil the edges. To obtain a high PSNR, the denoised image needs to balance edge preserving and noise removing. For AD filter, this trade-off leads to inhomogeneities in flat areas in denoised image (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a>). For TV minimization, the best PSNR is obtained with a visually under-smoothed image since noise is present in denoised image (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a>).</p><div id="S31" class="sec"><p></p><h5 id="S31title" class="inline">a.  PSNR comparison </h5><p id="P87" class="p p-first-last">As presented in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F12/" target="figure" class="fig-table-link figpopup" rid-figpopup="F12" rid-ob="ob-F12" co-legend-rid="lgnd_F12"><span>Fig. 12</span></a> (left), our block optimized NL-means filter produces the best PSNR values whatever the noise level. On average, a gain of 1.85 dB is measured compared to TV and Anisotropic Diffusion methods. The PSNR value between the noisy image and the ground truth is called “No processing” and is used as reference.</p></div><div id="S32" class="sec"><p></p><h5 id="S32title" class="inline">b.  Histogram comparison </h5><p id="P88" class="p p-first-last">To better understand how these differences in the PSNR values between the three methods can be explained, the histograms of the denoised images were compared to the histogram of the ground truth. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F12/" target="figure" class="fig-table-link figpopup" rid-figpopup="F12" rid-ob="ob-F12" co-legend-rid="lgnd_F12"><span>Figure 12</span></a> (right) shows that the <strong>Optimized Blockwise NL-means</strong> filter is the only method able to retrieve a histogram similar to the ground truth. The NL-means-based restoration schemes clearly distinguish the three main peaks representing the white matter, the gray matter and the cerebrospinal fluid. The sharpness of the peaks shows how the <strong>Optimized Blockwise NL-means</strong> filter increases the contrast between denoised biological structures (see also <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a>). The distances between these histograms are estimated with the Bhattacharyya coefficient (<em>BC</em>) defined as: 
</p><div class="disp-formula" id="FD19"><div class="f"><span class="MathJax_Preview"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="M44" overflow="scroll" role="math" style="width: 13.007em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.486em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.607em, 1010.49em, 3.934em, -999.997em); top: -2.518em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1592"><span class="mrow" id="MathJax-Span-1593"><span class="mi" id="MathJax-Span-1594" style="font-family: STIXGeneral-Italic;">B</span><span class="mi" id="MathJax-Span-1595" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1596" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1597" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-1598" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1599" style="font-family: STIXGeneral-Italic; padding-left: 0.204em;">q</span><span class="mo" id="MathJax-Span-1600" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1601" style="font-family: STIXGeneral-Regular; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1602" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.21em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1603" style="font-family: STIXSizeOneSym; vertical-align: -0.502em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.16em, 4.236em, -999.997em); top: -2.82em; left: 0.053em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1606" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-1607" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1001.01em, 4.136em, -999.997em); top: -5.189em; left: 0.103em;"><span class="mrow" id="MathJax-Span-1608"><span class="mn" id="MathJax-Span-1609" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">255</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1610" style="padding-left: 0.204em;"><span class="msqrt" id="MathJax-Span-1611"><span style="display: inline-block; position: relative; width: 4.287em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1003.28em, 4.337em, -999.997em); top: -3.979em; left: 0.91em;"><span class="mrow" id="MathJax-Span-1612"><span class="mrow" id="MathJax-Span-1613"><span class="mi" id="MathJax-Span-1614" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-1615" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1616" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1617" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1618" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-1619" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1620" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1621" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.027em, 1003.38em, 3.38em, -999.997em); top: -3.979em; left: 0.91em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 0.003em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.979em; left: 2.876em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.406em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 0.809em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.212em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 1.615em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 2.019em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.979em; left: 2.472em;">‾<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1000.96em, 4.388em, -999.997em); top: -3.828em; left: 0.003em;"><span style="font-family: STIXGeneral-Regular;">√</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.523em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.878em;"></span></span></nobr></span></div><script type="math/mml" id="MathJax-Element-49"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" display="block" overflow="scroll"><mrow><mi>B</mi><mi>C</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>255</mn></mrow></munderover><mrow><msqrt><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mi>q</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></msqrt></mrow></mrow></math></script></div><div class="l">(19)</div></div><p> where <em>p</em> and <em>q</em> are the two histograms be to compared and <em>b</em> is the bin index. A <em>BC</em> close to 1 means <em>p</em> and <em>q</em> are very similar. Each histogram of denoised images is compared to the “ground truth” one (see Tab. III). The distance between the histogram of the noisy image and the histogram of the “ground truth” is used as a reference. The BC distance shows that the restored histogram obtained with the <strong>Optimized Blockwise NL-means</strong> filter is the closest to the “ground truth”, as visually assessed in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F12/" target="figure" class="fig-table-link figpopup" rid-figpopup="F12" rid-ob="ob-F12" co-legend-rid="lgnd_F12"><span>Figure 12</span></a> (right). Finally, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T3/" target="table" class="fig-table-link figpopup" rid-figpopup="T3" rid-ob="ob-T3" co-legend-rid=""><span>Table III</span></a> suggests that the NL-means-based approach could improve the registration of images, since the Mutual Information (<em>MI</em>) computed between the restored image and the “ground truth” is higher in comparison with AD filter and TV minimization. The <em>MI</em> is a similarity measure commonly used in image registration.</p></div><div id="S33" class="sec sec-last"><p></p><h5 id="S33title" class="inline">c.  Visual Assessment </h5><p id="P89" class="p p-first-last"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Figures 13</span></a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F14/" target="figure" class="fig-table-link figpopup" rid-figpopup="F14" rid-ob="ob-F14" co-legend-rid="lgnd_F14"><span style="position: relative;text-decoration:none;">​<span class="figpopup-sensitive-area" style="left: -1.5em;">and14</span></span><span>14</span></a> show the restored images and the removed noise obtained with the three compared methods. As shown in the previous analysis, we observe that the homogeneity of white matter is higher when the image is denoised with the <strong>Optimized Blockwise NL-means</strong> filter. Moreover, focusing on the structure of the removed noise, it clearly appears that NL-means-based restoration schemes better preserves the high frequency components of the image corresponding to anatomical structures while removing efficiently the high frequencies due to noise. According to the “method noise” introduced in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R57" rid="R57" class=" bibr popnode">57</a>], the NL-means is a better denoising method since the removed noise is the most similar to a white Gaussian noise. Finally, the difference between the “ground truth” and the denoised image is presented in order to show which structures are removed during the denoising process. In <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a>, this difference shows that (a) the AD filter tends to spoil the edges especially on the skull, (b) the TV minimization slightly better preserves the edges but does not remove all the noise, and (c) the <strong>Optimized Blockwise NL-means</strong> filter visually better preserves the edges while efficiently removing the noise (especially for white matter).</p></div></div></div></div><div id="S34" class="tsec sec"><h2 class="head no_bottom_margin" id="S34title">VI. Validation on a Phantom data set with added Rician Noise</h2><p id="P90" class="p p-first">In this section, the same experiments are performed on phantom data set corrupted by Rician noise in order to study the impact of the Gaussian assumption. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T4/" target="table" class="fig-table-link figpopup" rid-figpopup="T4" rid-ob="ob-T4" co-legend-rid=""><span>Table IV</span></a> shows the computation time and the denoising performance of the different compared NL-means filters. These results show that the optimized NL-means versions outperform the classical ones also for Rician noise. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F15/" target="figure" class="fig-table-link figpopup" rid-figpopup="F15" rid-ob="ob-F15" co-legend-rid="lgnd_F15"><span>Figure 15</span></a> presents the comparison with AD filter and TV minimization in terms of PSNR values and histogram analysis. As for the AD filter and TV minimization, the NL-means-based denoising is able to correctly restore an image corrupted by Rician noise using a Gaussian approximation. When the histograms are compared, low values of intensity (&lt; 20) are incorrectly restored for all the filters; the Gaussian approximation is not appropriate in that case. Nevertheless, it seems the underlying assumption is well suited to high values (&gt; 60).</p><p id="P91" class="p p-last">As for Gaussian noise, the NL-means-based restoration clearly emphasizes the three main peaks corresponding to the white matter, the gray matter and the cerebrospinal fluid. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F16/" target="figure" class="fig-table-link figpopup" rid-figpopup="F16" rid-ob="ob-F16" co-legend-rid="lgnd_F16"><span>Figure 16</span></a> shows the visual results obtained when the methods are compared on phantom data with Rician noise. Compared to <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/" target="figure" class="fig-table-link figpopup" rid-figpopup="F13" rid-ob="ob-F13" co-legend-rid="lgnd_F13"><span>Fig. 13</span></a>, the denoising of background is worse in the Rician case, but the cerebral structures are correctly restored with the NL-means filter especially the white matter (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F16/" target="figure" class="fig-table-link figpopup" rid-figpopup="F16" rid-ob="ob-F16" co-legend-rid="lgnd_F16"><span>Fig. 16</span></a>). Finally, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F17/" target="figure" class="fig-table-link figpopup" rid-figpopup="F17" rid-ob="ob-F17" co-legend-rid="lgnd_F17"><span>Figure 17</span></a> shows the PSNR results of the parameter screening for the AD filter and the TV minimization at 9% of Rician noise. All these results on Rician noise show that the PNSR values slightly decrease due to more pronounced noise compared to Gaussian case for a same level (see IV-A.2 for explanation), but the general performance of the filters is preserved.</p></div><div id="S35" class="tsec sec"><h2 class="head no_bottom_margin" id="S35title">VII. Experiments on clinical data</h2><div id="S36" class="sec sec-first"><h3 id="S36title">A. High field MRI</h3><p id="P92" class="p p-first-last">The restoration results presented in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F18/" target="figure" class="fig-table-link figpopup" rid-figpopup="F18" rid-ob="ob-F18" co-legend-rid="lgnd_F18"><span>Fig. 18</span></a> show good preservation of the cerebellum contours. Fully automatic segmentation and quantitative analysis of such structures are still a challenge, and improved restoration schemes could greatly improve these processings.</p></div><div id="S37" class="sec sec-last"><h3 id="S37title">B. MS pathological context</h3><p id="P93" class="p p-first-last"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F19/" target="figure" class="fig-table-link figpopup" rid-figpopup="F19" rid-ob="ob-F19" co-legend-rid="lgnd_F19"><span>Figure 19</span></a> shows that the optimized blockwise NL-means filter preserves the lesions while removing the noise. The impact on further processing is not the scope of this paper and is not studied here. Nevertheless, visually the lesions appears more contrasted and as seen on the difference image the proposed NL-means approach does not include any structure of lesion in the estimated noise image. This was confirmed by an experienced neurologist.</p></div></div><div id="S38" class="tsec sec"><h2 class="head no_bottom_margin" id="S38title">VIII. Discussion and Conclusion</h2><p id="P94" class="p p-first">This paper presents an optimized blockwise version of the Non Local (NL-) means filter, applied to 3D medical data. Validation was performed on the BrainWeb dataset [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R2" rid="R2" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474432">2</a>] and showed that the proposed <strong>Optimized Blockwise NL-means</strong> filter outperforms the classical implementation of the NL-means filter and some state-of-the-art techniques, such as the Anisotropic Diffusion approach [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R3" rid="R3" class=" bibr popnode">3</a>] and the Total Variation minimization process [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R4" rid="R4" class=" bibr popnode">4</a>] on both Gaussian and Rician noise. These first results show that the image-redundancy assumption required for NL-means based restoration holds for 3D MRI. Compared to the classical NL-means filter, our implementation (with voxel preselection, multithreading and blockwise implementation) considerably decreases the required computational time (up to a factor of 60 on a Xeon at 3GHz) and increases the PSNR value of the denoised image. Nevertheless, the problem of the computational burden can still be investigated with other faster implementations such as the “plain multiscale” scheme also suggested in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R1" rid="R1" class=" bibr popnode">1</a>]. Further works should be pursued for comparing NL-means based restoration with recent promising denoising methods, such as Total Variation in wavelet domain [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R43" rid="R43" class=" bibr popnode">43</a>] or adaptive estimation method [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R28" rid="R28" class=" bibr popnode">28</a>], [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R50" rid="R50" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_394258651">50</a>]. Moreover, the efficiency of the technique limiting the staircasing effect proposed in [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/?report=printable#R58" rid="R58" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_146474442">58</a>] needs to be studied for MRI.</p><p id="P95">We show on sample pathological cases (patients with MS lesions) that the filter preserves the major visual signature of the given pathology. However, the impact on specific pathologies needs to be further investigated.</p><p id="P96" class="p p-last">Finally, the impact of the NL-means-based denoising on the performances of post-processing algorithms, like segmentation and registration schemes also should be studied. Nonetheless, the first results presented on the Mutual Information (<em>MI</em>) suggest that the proposed <strong>Optimized Blockwise NL-means</strong> filter could improve the image registration process. Indeed, the <em>MI</em> computed between the restored image and the “ground truth” is higher with the <strong>Optimized Blockwise NL-means</strong> filter than with the Anisotropic Diffusion approach and the Total Variation minimization process.</p></div><div id="idm140650596682128" class="tsec sec"><h2 class="head no_bottom_margin" id="idm140650596682128title">Footnotes</h2><!--back/fn-group--><div class="fm-sec half_rhythm small"><p class="fn sec" id="FN2"><sup>1</sup><a href="http://www.bic.mni.mcgill.ca/brainweb/" data-ga-action="click_feat_suppl" ref="reftype=extlink&amp;article-id=2881565&amp;issue-id=187433&amp;journal-id=469&amp;FROM=Article%7CBody&amp;TO=External%7CLink%7CURI" target="_blank">http://www.bic.mni.mcgill.ca/brainweb/</a></p><p class="fn sec" id="FN3"><sup>2</sup><a href="http://www.vtk.org/" data-ga-action="click_feat_suppl" ref="reftype=extlink&amp;article-id=2881565&amp;issue-id=187433&amp;journal-id=469&amp;FROM=Article%7CBody&amp;TO=External%7CLink%7CURI" target="_blank">www.vtk.org</a></p><p class="fn sec" id="FN4"><sup>3</sup><a href="http://www.cmla.ens-cachan.fr/Cmla/Megawave/index.html" data-ga-action="click_feat_suppl" ref="reftype=extlink&amp;article-id=2881565&amp;issue-id=187433&amp;journal-id=469&amp;FROM=Article%7CBody&amp;TO=External%7CLink%7CURI" target="_blank">http://www.cmla.ens-cachan.fr/Cmla/Megawave/index.html</a></p></div></div><div id="idm140650596675904" class="tsec sec"><h2 class="head no_bottom_margin" id="idm140650596675904title">References</h2><div class="ref-list-sec sec" id="reference-list"><div class="ref-cit-blk half_rhythm" id="R1">1. <span class="mixed-citation">Buades A, Coll B, Morel JM. A review of image denoising algorithms, with a new one. <span><span class="ref-journal">Multiscale Modeling &amp; Simulation. </span>2005;<span class="ref-vol">4</span>(2):490–530.</span></span></div><div class="ref-cit-blk half_rhythm" id="R2">2. <span class="mixed-citation">Collins D, Zijdenbos A, Kollokian V, Sled J, Kabani N, Holmes C, Evans A. Design and construction of a realistic digital brain phantom. <span><span class="ref-journal">IEEE Trans Med Imaging. </span>1998;<span class="ref-vol">17</span>(3):463–468.</span> [PubMed: 9735909]</span></div><div class="ref-cit-blk half_rhythm" id="R3">3. <span class="mixed-citation">Perona P, Malik J. Scale-space and edge detection using anisotropic diffusion. <span><span class="ref-journal">IEEE Trans Pattern Anal Mach Intell. </span>1990;<span class="ref-vol">12</span>(7):629–639.</span></span></div><div class="ref-cit-blk half_rhythm" id="R4">4. <span class="mixed-citation">Rudin L, Osher S, Fatemi E. Nonlinear total variation based noise removal algorithms. <span><span class="ref-journal">Physica D. </span>1992;<span class="ref-vol">60</span>:259–268.</span></span></div><div class="ref-cit-blk half_rhythm" id="R5">5. <span class="mixed-citation">Mazziotta J, Toga A, Evans A, Fox P, Lancaster J, Zilles K, Woods R, Paus T, Simpson G, Pike B, Holmes C, Collins L, Thompson P, MacDonald D, Iacoboni M, Schormann T, Amunts K, Palomero-Gallagher N, Geyer S, Parsons L, Narr K, Kabani N, Le Goualher G, Boomsma D, Cannon T, Kawashima R, Mazoyer B. A probabilistic atlas and reference system for the human brain: International consortium for brain mapping (icbm) <span><span class="ref-journal">Philos Trans R Soc Lond B Biol Sci. </span>2001 Aug;<span class="ref-vol">356</span>(1412):1293–1322.</span> <span class="nowrap">[PMCID: PMC1088516]</span> [PubMed: 11545704]</span></div><div class="ref-cit-blk half_rhythm" id="R6">6. <span class="mixed-citation">Zijdenbos A, Forghani R, Evans A. Automatic” pipeline” analysis of 3D MRI data for clinical trials: application to multiple sclerosis. <span><span class="ref-journal">IEEE Trans Med Imaging. </span>2002 Oct;<span class="ref-vol">21</span>(10):1280–1291.</span> [PubMed: 12585710]</span></div><div class="ref-cit-blk half_rhythm" id="R7">7. <span class="mixed-citation">Geman S, Geman D. Stochastic relaxation, Gibbs distribution, and the Bayesian restoration of images. <span><span class="ref-journal">IEEE Trans PAMI. </span>1984;<span class="ref-vol">6</span>:721–741.</span> [PubMed: 22499653]</span></div><div class="ref-cit-blk half_rhythm" id="R8">8. <span class="mixed-citation">Mumford SJD. Optimal approximations by piecewise smooth functions and variational problems. <span><span class="ref-journal">Comm Pure and Appl Math. </span>1989;<span class="ref-vol">42</span>:577–685.</span></span></div><div class="ref-cit-blk half_rhythm" id="R9">9. <span class="mixed-citation">Tschumperlé D.  <span class="ref-journal">ECCV.</span> Graz: 2006. Curvature-preserving regularization of multi-valued images using PDE’s; pp. 428–433.</span></div><div class="ref-cit-blk half_rhythm" id="R10">10. <span class="mixed-citation">Black M, Sapiro G. Edges as outliers: Anisotropic smoothing using local image statistics. Scale-Space Theories in Computer Vision, Second International Conference, Scale-Space ‘99, Proceedings; Corfu, Greece. September 26–27, 1999; 1999. pp. 259–270.</span></div><div class="ref-cit-blk half_rhythm" id="R11">11. <span class="mixed-citation">Saint-Marc P, Chen JS, Medioni G. Adaptive smoothing: a general tool for early vision. <span><span class="ref-journal">IEEE Transactions on Pattern Analysis and Machine Intelligence. </span>1991 Jun;<span class="ref-vol">13</span>(6):514–529.</span></span></div><div class="ref-cit-blk half_rhythm" id="R12">12. <span class="mixed-citation">Donoho D, Johnstone I. Ideal spatial adaptation by wavelet shrinkage. <span><span class="ref-journal">Biometrika. </span>1994;<span class="ref-vol">81</span>(3):425–455.</span></span></div><div class="ref-cit-blk half_rhythm" id="R13">13. <span class="mixed-citation">Donoho D. De-noising by soft-thresholding. <span><span class="ref-journal">IEEE Transactions on Information Theory. </span>1995;<span class="ref-vol">41</span>(3):613–627.</span></span></div><div class="ref-cit-blk half_rhythm" id="R14">14. <span class="mixed-citation">Portilla J, Simoncelli E. Image restoration using Gaussian scale mixtures in the wavelet domain. ICIP ‘03: International Conference on Image Processing; 2003. pp. 965–968.</span></div><div class="ref-cit-blk half_rhythm" id="R15">15. <span class="mixed-citation">Tomasi C, Manduchi R. Bilateral filtering for gray and color images. ICCV ‘98: Proceedings of the Sixth International Conference on Computer Vision; Washington, DC, USA: IEEE Computer Society; 1998. p. 839.</span></div><div class="ref-cit-blk half_rhythm" id="R16">16. <span class="mixed-citation">Smith S, Brady J. SUSAN–A New Approach to Low Level Image Processing. <span><span class="ref-journal">International Journal of Computer Vision. </span>1997 May;<span class="ref-vol">23</span>(1):45–78.</span></span></div><div class="ref-cit-blk half_rhythm" id="R17">17. <span class="mixed-citation">Elad M. On the origin of the bilateral filter and ways to improve it. <span><span class="ref-journal">IEEE Transactions on Image Processing. </span>2002 Oct;<span class="ref-vol">11</span>(10):1141–1151.</span> [PubMed: 18249686]</span></div><div class="ref-cit-blk half_rhythm" id="R18">18. <span class="mixed-citation">van de Weije J, van den Boomgaard R. Local mode filtering. CVPR ‘01: IEEE Computer Society Conference on Computer Vision and Pattern Recognition; 8–14 December; Kauai, HI, USA. 2001. pp. 428–433.</span></div><div class="ref-cit-blk half_rhythm" id="R19">19. <span class="mixed-citation">Chan T, Zhou H. Total variation improved wavelet thresholding in image compression. ICIP; 2000. </span></div><div class="ref-cit-blk half_rhythm" id="R20">20. <span class="mixed-citation">Durand S, Froment J. Reconstruction of wavelet coefficients using total variation minimization. <span><span class="ref-journal">SIAM J Sci Comput. </span>2002;<span class="ref-vol">24</span>(5):1754–1767.</span></span></div><div class="ref-cit-blk half_rhythm" id="R21">21. <span class="mixed-citation">Lintner S, Malgouyres F. Solving a variational image restoration model which involves <em>L</em><sup>∞</sup> constraints. <span><span class="ref-journal">Inverse Problems. </span>2004;<span class="ref-vol">20</span>(3):815–831.</span></span></div><div class="ref-cit-blk half_rhythm" id="R22">22. <span class="mixed-citation">Mrazek P, Weickert J, Bruhn A. On robust estimation and smoothing with spatial and tonal kernels. <span><span class="ref-journal">Preprint. </span>2004;<span class="ref-vol">51</span></span></span></div><div class="ref-cit-blk half_rhythm" id="R23">23. <span class="mixed-citation">Barash D. A fundamental relationship between bilateral filtering, adaptive smoothing, and the nonlinear diffusion equation. <span><span class="ref-journal">IEEE Trans Pattern Anal Mach Intell. </span>2002 Jun;<span class="ref-vol">24</span>(6):844–847.</span></span></div><div class="ref-cit-blk half_rhythm" id="R24">24. <span class="mixed-citation">Sapiro G. From active contours to anisotropic diffusion: connections between basic PDE’s in image processing. ICIP ‘96: International Conference on Image Processing; 1996. pp. 477–480.</span></div><div class="ref-cit-blk half_rhythm" id="R25">25. <span class="mixed-citation">Polzehl SVJ. Adaptive weights smoothing with application to image restoration. <span><span class="ref-journal">J Roy Stat Soc B. </span>2000;<span class="ref-vol">62</span>:335–354.</span></span></div><div class="ref-cit-blk half_rhythm" id="R26">26. <span class="mixed-citation">Katkovnik V, Egiazarian K, Astola J. Adaptive window size image de-noising based on intersection of confidence intervals (ICI) rule. <span><span class="ref-journal">J Math Imaging Vis. </span>2002 May;<span class="ref-vol">16</span>(3):223–235.</span></span></div><div class="ref-cit-blk half_rhythm" id="R27">27. <span class="mixed-citation">Kervrann C. An adaptive window approach for image smoothing and structures preserving. Computer Vision - ECCV 2004, 8th European Conference on Computer Vision, Proceedings, Part III; Prague, Czech Republic. May 11–14, 2004; 2004. pp. 132–144.</span></div><div class="ref-cit-blk half_rhythm" id="R28">28. <span class="mixed-citation">Kervrann C, Boulanger J. Unsupervised patch-based image regularization and representation. Proc. European Conf. Comp. Vision (ECCV ‘06); Graz, Austria. May 2006..</span></div><div class="ref-cit-blk half_rhythm" id="R29">29. <span class="mixed-citation">Kervrann C, Boulanger J. Optimal spatial adaptation for patch-based image denoising. IEEE Trans. on Image Processing; 2006.  [PubMed: 17022255]</span></div><div class="ref-cit-blk half_rhythm" id="R30">30. <span class="mixed-citation">Zhu S, Wu Y, Mumford D. Filters, random fields and maximum entropy (frame): Towards a unified theory for texture modeling. <span><span class="ref-journal">Int J Comput Vision. </span>1998;<span class="ref-vol">27</span>(2):107–126.</span></span></div><div class="ref-cit-blk half_rhythm" id="R31">31. <span class="mixed-citation">Freeman W, Pasztor E, Carmichael O. Learning low-level vision. <span><span class="ref-journal">Int J Comput Vision. </span>2000 Oct;<span class="ref-vol">40</span>(1):25–47.</span></span></div><div class="ref-cit-blk half_rhythm" id="R32">32. <span class="mixed-citation">Roth S, Black M. Fields of experts: A framework for learning image priors. 2005 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR 2005); 20–26 June 2005; San Diego, CA, USA. 2005. pp. 860–867.</span></div><div class="ref-cit-blk half_rhythm" id="R33">33. <span class="mixed-citation">Awate S, Whitaker R. Higher-order image statistics for unsupervised, information-theoretic, adaptive, image filtering. IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR 2005); San Diego, CA, USA: IEEE Computer Society; Jun, 2005. pp. 44–51.</span></div><div class="ref-cit-blk half_rhythm" id="R34">34. <span class="mixed-citation">Gerig G, Kikinis R, Kübler O, Jolesz F. Nonlinear anisotropic filtering of MRI data. <span><span class="ref-journal">IEEE Transactions on Medical Imaging. </span>1992 Jun;<span class="ref-vol">11</span>(2):221–232.</span> [PubMed: 18218376]</span></div><div class="ref-cit-blk half_rhythm" id="R35">35. <span class="mixed-citation">Weickert J, ter Haar Romeny BM, Viergever MA. Efficient and reliable schemes for nonlinear diffusion filtering. <span><span class="ref-journal">IEEE Transactions on Image Processing. </span>1998;<span class="ref-vol">7</span>(3):398–410.</span> [PubMed: 18276260]</span></div><div class="ref-cit-blk half_rhythm" id="R36">36. <span class="mixed-citation">Keeling S. Total variation based convex filters for medical imaging. <span><span class="ref-journal">Appl Math Comput. </span>2003;<span class="ref-vol">139</span>(1):101–119.</span></span></div><div class="ref-cit-blk half_rhythm" id="R37">37. <span class="mixed-citation">Wong W, Chung A, Yu S. Trilateral filtering for biomedical images. IEEE International Symposium on Biomedical Imaging: From Nano to Macro; Arlington, VA, USA. 15–18 April 2004; 2004. pp. 820–823.</span></div><div class="ref-cit-blk half_rhythm" id="R38">38. <span class="mixed-citation">Nowak R. Wavelet-based Rician noise removal for magnetic resonance imaging. <span><span class="ref-journal">IEEE Transactions on Image Processing. </span>1999 Oct;<span class="ref-vol">8</span>(10):1408–1419.</span> [PubMed: 18267412]</span></div><div class="ref-cit-blk half_rhythm" id="R39">39. <span class="mixed-citation">Wood J, Johnson K. Wavelet packet denoising of magnetic resonance images: importance of Rician noise at low SNR. <span><span class="ref-journal">Magn Reson Med. </span>1999 Mar;<span class="ref-vol">41</span>(3):631–635.</span> [PubMed: 10204890]</span></div><div class="ref-cit-blk half_rhythm" id="R40">40. <span class="mixed-citation">Zaroubi S, Goelman G. Complex denoising of MR data via wavelet analysis: application for functional MRI. <span><span class="ref-journal">Magn Reson Imaging. </span>2000 Jan;<span class="ref-vol">18</span>(1):59–68.</span> [PubMed: 10642103]</span></div><div class="ref-cit-blk half_rhythm" id="R41">41. <span class="mixed-citation">Alexander ME, Baumgartner R, Summers AR, Windischberger C, Klarhoefer M, Moser E, Somorjai RL. A wavelet-based method for improving signal-to-noise ratio and contrast in MR images. <span><span class="ref-journal">Magn Reson Imaging. </span>2000 Feb;<span class="ref-vol">18</span>(2):169–180.</span> [PubMed: 10722977]</span></div><div class="ref-cit-blk half_rhythm" id="R42">42. <span class="mixed-citation">Bao P, Zhang L. Noise reduction for magnetic resonance images via adaptive multiscale products thresholding. <span><span class="ref-journal">IEEE Trans Med Imaging. </span>2003 Sep;<span class="ref-vol">22</span>(9):1089–1099.</span> [PubMed: 12956264]</span></div><div class="ref-cit-blk half_rhythm" id="R43">43. <span class="mixed-citation">Ogier A, Hellier P, Barillot C. Restoration of 3D medical images with total variation scheme on wavelet domains (TVW). Proceedings of SPIE Medical Imaging 2006: Image Processing; San Diego, USA. February 2006..</span></div><div class="ref-cit-blk half_rhythm" id="R44">44. <span class="mixed-citation">Wang Y, Zhou H. Total variation wavelet-based medical image denoising. <span><span class="ref-journal">International Journal of Biomedical Imaging. </span>2006;<span class="ref-vol">2006</span>:6.</span> Article ID 89 095. <span class="nowrap">[PMCID: PMC2324055]</span> [PubMed: 23165057]</span></div><div class="ref-cit-blk half_rhythm" id="R45">45. <span class="mixed-citation">McDonnell M. Box-filtering techniques. <span><span class="ref-journal">Computer Vision, Graphics, and Image Processing. </span>1981 Sep;<span class="ref-vol">17</span>(1):65–70.</span></span></div><div class="ref-cit-blk half_rhythm" id="R46">46. <span class="mixed-citation">Yaroslavsky L.  In: <span class="ref-journal">Digital Picture Processing - An Introduction.</span> Verlag S, editor. 1985. </span></div><div class="ref-cit-blk half_rhythm" id="R47">47. <span class="mixed-citation">Lee J. Digital image smoothing and the sigma filter. <span><span class="ref-journal">Computer Vision, Graphics and Image Processing. </span>1983;<span class="ref-vol">24</span>:255–269.</span></span></div><div class="ref-cit-blk half_rhythm" id="R48">48. <span class="mixed-citation">Coifman R, Donoho D.  <span class="ref-journal">Lecture Notes in Statistics: Wavelets and Statistics.</span> New York: Feb, 1995. Translation invariant de-noising; pp. 125–150.</span></div><div class="ref-cit-blk half_rhythm" id="R49">49. <span class="mixed-citation">Gasser T, Sroka L, Steinmetz C. Residual variance and residual pattern in nonlinear regression. <span><span class="ref-journal">Biometrika. </span>1986;<span class="ref-vol">73</span>(3):625–633.</span></span></div><div class="ref-cit-blk half_rhythm" id="R50">50. <span class="mixed-citation">Boulanger J, Kervrann C, Bouthemy P. Adaptive spatio-temporal restoration for 4D fluoresence microscopic imaging. Int. Conf. on Medical Image Computing and Computer Assisted Intervention (MICCAI’ 05); Palm Springs, USA. October 2005.. [PubMed: 16685931]</span></div><div class="ref-cit-blk half_rhythm" id="R51">51. <span class="mixed-citation">Buades A, Coll B, Morel J-M. Image and movie denoising by nonlocal means. <span><span class="ref-journal">CMLA, Tech Rep. </span>2006;<span class="ref-vol">25</span></span></span></div><div class="ref-cit-blk half_rhythm" id="R52">52. <span class="mixed-citation">Mahmoudi M, Sapiro G. Fast image and video denoising via nonlocal means of similar neighborhoods. <span><span class="ref-journal">Signal Processing Letters, IEEE. </span>2005;<span class="ref-vol">12</span>(12):839–842.</span></span></div><div class="ref-cit-blk half_rhythm" id="R53">53. <span class="mixed-citation">Gudbjartsson H, Patz S. The Rician distribution of noisy MRI data. <span><span class="ref-journal">Magnetic Resonance in Medicine. </span>1995;<span class="ref-vol">34</span>:910–914.</span> <span class="nowrap">[PMCID: PMC2254141]</span> [PubMed: 8598820]</span></div><div class="ref-cit-blk half_rhythm" id="R54">54. <span class="mixed-citation">Macovski A. Noise in MRI. <span><span class="ref-journal">Magnetic Resonance in Medicine. </span>1996;<span class="ref-vol">36</span>:494–497.</span> [PubMed: 8875425]</span></div><div class="ref-cit-blk half_rhythm" id="R55">55. <span class="mixed-citation">Osher S, Burger M, Goldfarb D, Xu J, Yin W. An iterative regularization method for total variation-based image restoration. <span><span class="ref-journal">Multiscale Model Simul. </span>2005;<span class="ref-vol">4</span>(2):460–489.</span></span></div><div class="ref-cit-blk half_rhythm" id="R56">56. <span class="mixed-citation">Tadmor E, Nezzar S, Vese L. A multiscale image representation using hierarchical (BV, <em>L</em><sup>2</sup>) decompositions. <span><span class="ref-journal">Multiscale Model Simul. </span>2004;<span class="ref-vol">2</span>(4):554–579.</span></span></div><div class="ref-cit-blk half_rhythm" id="R57">57. <span class="mixed-citation">Buades A, Coll B, Morel J-M.  <span class="ref-journal">A non local algorithm for image denoising.</span> San Diego, USA: IEEE Computer Society; Jun, 2005. pp. 60–65.</span></div><div class="ref-cit-blk half_rhythm" id="R58">58. <span class="mixed-citation">Buades A, Coll B, Morel JM. The staircasing effect in neighborhood filters and its solution. <span><span class="ref-journal">IEEE Transactions on Image Processing. </span>2006;<span class="ref-vol">15</span>(6):1499–1505.</span> [PubMed: 16764274]</span></div></div></div><div id="idm140650562172432" class="tsec sec print-view"><h2 class="head no_bottom_margin" id="idm140650562172432title">Figures and Tables</h2><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F1"><h3>Fig. 1</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530088896" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f1.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f1.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f1.jpg"></div><div id="largeobj_idm140650530088896" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F1/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><p id="__p4">Left: <strong>Classical voxelwise NL-means filter:</strong> 2D illustration of the NL-means principle. The restored value of voxel <em>x<sub>i</sub></em> (in red) is the weighted average of all intensities of voxels <em>x<sub>j</sub></em> in the search volume <em>V<sub>i</sub></em>, based on the similarity of their intensity neighborhoods <strong>u</strong>(<em>N<sub>i</sub></em>) and <strong>u</strong>(<em>N<sub>j</sub></em>). In this example, we set <em>d</em> = 1 and <em>M</em> = 8. Right: <strong>Blockwise NL-means filter:</strong> 2D illustration of the blockwise NL-means principle. The restored value of the block <em>B<sub>i<sub>k</sub></sub></em> is the weighted average of all the blocks <em>B<sub>j</sub></em> in the search volume <em>V<sub>i<sub>k</sub></sub></em>. In this example, we set <em>α</em> = 1 and <em>M</em> = 8.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F2"><h3>Fig. 2</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530078016" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f2.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f2.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f2.jpg"></div><div id="largeobj_idm140650530078016" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F2/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><p id="__p5">Left: noisy image with 9 % of Gaussian noise (see Section IV). Center: map of the mean of <strong>u</strong>(<em>N<sub>i</sub></em>) denoted 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M45" overflow="scroll" role="math" style="width: 2.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.192em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(-0.055em, 1002.19em, 1.328em, -999.997em); top: -0.976em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1623"><span class="mrow" id="MathJax-Span-1624"><span class="mover" id="MathJax-Span-1625"><span style="display: inline-block; position: relative; width: 2.192em; height: 0px;"><span style="position: absolute; clip: rect(3.113em, 1002.13em, 4.323em, -999.997em); top: -3.972em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1626"><span class="mi" id="MathJax-Span-1627" style="font-family: STIXGeneral; font-weight: bold;">u</span><span class="mo" id="MathJax-Span-1628" style="font-family: STIXGeneral-Regular;">(</span><span class="msub" id="MathJax-Span-1629"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.75em, 4.15em, -999.997em); top: -3.972em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1630"><span class="mi" id="MathJax-Span-1631" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.799em; left: 0.694em;"><span class="mi" id="MathJax-Span-1632" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-1633" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.517em, 1002.19em, 3.92em, -999.997em); top: -4.548em; left: 0.003em;"><span class="mo" id="MathJax-Span-1634" style=""><span style="display: inline-block; position: relative; width: 2.192em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.972em; left: 0.003em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.972em; left: 1.846em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.972em; left: 0.233em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.972em; left: 0.521em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.972em; left: 0.809em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.972em; left: 1.04em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.972em; left: 1.328em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.972em; left: 1.616em;">⎯<span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.982em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-50"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" overflow="scroll"><mrow><mover accent="true"><mrow><mi mathvariant="bold">u</mi><mo stretchy="false">(</mo><msub><mrow><mi>N</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>¯</mo></mover></mrow></math></script>. Right map of the variance of <strong>u</strong>(<em>N<sub>i</sub></em>) denoted Var(<strong>u</strong>(<em>N<sub>i</sub></em>)). In these examples, we set <em>N<sub>i</sub></em> = 5 × 5 × 5 voxels.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F3"><h3>Fig. 3</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530068592" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f3.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f3.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f3.jpg"></div><div id="largeobj_idm140650530068592" class="largeobj-link align_right" style=""><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F3/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Blockwise NL-means Filter</strong><p id="__p6">For each block <em>B<sub>i<sub>k</sub></sub></em>centered on voxel <em>x<sub>i<sub>k</sub></sub></em>, a NL-means like restoration is performed from blocks <em>B<sub>j</sub></em>. In this way, for a voxel <em>x<sub>i</sub></em> included in several blocks, several estimations are obtained. The restored value of voxel <em>x<sub>i</sub></em> is the average of the different estimations stored in vector <strong>A</strong><em><sub>i</sub></em>. In this example <em>α</em> = 1, <em>n</em> = 2 and |<strong>A</strong><em><sub>i</sub></em>| = 3.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F4"><h3>Fig. 4</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530065200" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f4.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f4.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f4.jpg"></div><div id="largeobj_idm140650530065200" class="largeobj-link align_right" style=""><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F4/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Synthetic data used for validation with Gaussian Nnoise</strong><p id="__p7">Example of the Brainweb Database. Top: T1-w images without any noise (left), and corrupted with a white Gaussian noise at 9% (right). Bottom: T2-w images with MS lesions without noise (left), and corrupted with a white Gaussian noise at 9% (right).</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F5"><h3>Fig. 5</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530061936" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f5.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f5.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f5.jpg"></div><div id="largeobj_idm140650530061936" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F5/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Synthetic data used for validation with Rician noise</strong><p id="__p8">Example of the Brainweb Database. T1-w images without any noise (left), and corrupted with a Rician noise at 9% (right).</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F6"><h3>Fig. 6</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530051408" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f6.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f6.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f6.jpg"></div><div id="largeobj_idm140650530051408" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F6/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Calibration of the smoothing parameter</strong><p id="__p9"><em>h</em>: Influence of the smoothing parameter 2<em>β<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1635" role="math" style="width: 0.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.003em, 1000.58em, 1.164em, -999.997em); top: -0.984em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1636"><span class="mover" id="MathJax-Span-1637"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(3.429em, 1000.53em, 4.184em, -999.997em); top: -4.004em; left: 0.003em;"><span class="mi" id="MathJax-Span-1638" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.081em, 1000.58em, 3.603em, -999.997em); top: -4.004em; left: 0.061em;"><span class="mo" id="MathJax-Span-1639" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-51"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup>|<em>N<sub>i</sub></em>| on the PSNR, according to <em>β</em> and for several levels of noise. For low levels of noise the best value of <em>β</em> is close to 0.5. For high levels of noise this value is 1. The default value of <em>β</em> is set to 1, thus the estimation of <em>h</em> is <em>h</em><sup>2</sup> = 2<em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1640" role="math" style="width: 0.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.003em, 1000.58em, 1.164em, -999.997em); top: -0.984em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1641"><span class="mover" id="MathJax-Span-1642"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(3.429em, 1000.53em, 4.184em, -999.997em); top: -4.004em; left: 0.003em;"><span class="mi" id="MathJax-Span-1643" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.081em, 1000.58em, 3.603em, -999.997em); top: -4.004em; left: 0.061em;"><span class="mo" id="MathJax-Span-1644" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-52"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup>. These results are obtained with <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1645" role="math" style="width: 0.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.003em, 1000.58em, 1.164em, -999.997em); top: -0.984em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1646"><span class="mover" id="MathJax-Span-1647"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(3.429em, 1000.53em, 4.184em, -999.997em); top: -4.004em; left: 0.003em;"><span class="mi" id="MathJax-Span-1648" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.081em, 1000.58em, 3.603em, -999.997em); top: -4.004em; left: 0.061em;"><span class="mo" id="MathJax-Span-1649" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-53"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup> = 3.42% at 3%, <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1650" role="math" style="width: 0.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.003em, 1000.58em, 1.164em, -999.997em); top: -0.984em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1651"><span class="mover" id="MathJax-Span-1652"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(3.429em, 1000.53em, 4.184em, -999.997em); top: -4.004em; left: 0.003em;"><span class="mi" id="MathJax-Span-1653" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.081em, 1000.58em, 3.603em, -999.997em); top: -4.004em; left: 0.061em;"><span class="mo" id="MathJax-Span-1654" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-54"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup> = 7.93% at 9%, <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1655" role="math" style="width: 0.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.003em, 1000.58em, 1.164em, -999.997em); top: -0.984em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1656"><span class="mover" id="MathJax-Span-1657"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(3.429em, 1000.53em, 4.184em, -999.997em); top: -4.004em; left: 0.003em;"><span class="mi" id="MathJax-Span-1658" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.081em, 1000.58em, 3.603em, -999.997em); top: -4.004em; left: 0.061em;"><span class="mo" id="MathJax-Span-1659" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-55"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup> = 12.72% at 15% and <em><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="MathJax-Span-1660" role="math" style="width: 0.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.003em, 1000.58em, 1.164em, -999.997em); top: -0.984em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1661"><span class="mover" id="MathJax-Span-1662"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(3.429em, 1000.53em, 4.184em, -999.997em); top: -4.004em; left: 0.003em;"><span class="mi" id="MathJax-Span-1663" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.081em, 1000.58em, 3.603em, -999.997em); top: -4.004em; left: 0.061em;"><span class="mo" id="MathJax-Span-1664" style=""><span style="font-family: STIXSizeOneSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-56"><math><mover accent="true"><mi>σ</mi><mo>̂</mo></mover></math></script></em><sup>2</sup> = 17.44% at 21%.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F7"><h3>Fig. 7</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530041280" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f7.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f7.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f7.jpg"></div><div id="largeobj_idm140650530041280" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F7/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Influence of the size |<em>V<sub>i</sub></em>| = (2<em>M</em> + 1)<sup>3</sup> and |<em>N<sub>i</sub></em>| = (2<em>d</em> + 1)<sup>3</sup> for denoising</strong><p id="__p10">Influence of the size of the search volume and the size of the neighborhood on the PSNR, for several levels of noise. Left: Variation of the size <em>M</em> of the search volume <em>V<sub>i</sub></em> for <em>d</em> = 1. Right: Variation of the size <em>d</em> of the neighborhood <em>N<sub>i</sub></em> for <em>M</em> = 5. These results show that the limit <em>M</em> = 5 prevents useless computation. Moreover, increasing <em>d</em> degrades and drastically slows down the algorithm.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F8"><h3>Fig. 8</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530023184" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f8.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f8.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f8.jpg"></div><div id="largeobj_idm140650530023184" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F8/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Influence of the limits of the voxels selection</strong><p id="__p11">Influence of the limits <em>μ</em><sub>1</sub> and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M46" overflow="scroll" role="math" style="width: 1.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1001.04em, 1.443em, -999.997em); top: -0.976em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1666"><span class="mrow" id="MathJax-Span-1667"><span class="msubsup" id="MathJax-Span-1668"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.52em, 4.15em, -999.997em); top: -3.972em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1669"><span class="mi" id="MathJax-Span-1670" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -4.317em; left: 0.579em;"><span class="mn" id="MathJax-Span-1671" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -3.684em; left: 0.521em;"><span class="mn" id="MathJax-Span-1672" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.982em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-57"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></math></script> on the PSNR, for several level of noise. Left: 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M47" overflow="scroll" role="math" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.574em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.501em, 1003.52em, 2.941em, -999.997em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1674"><span class="mrow" id="MathJax-Span-1675"><span class="msubsup" id="MathJax-Span-1676"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.52em, 4.15em, -999.997em); top: -3.972em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1677"><span class="mi" id="MathJax-Span-1678" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -4.317em; left: 0.579em;"><span class="mn" id="MathJax-Span-1679" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -3.684em; left: 0.521em;"><span class="mn" id="MathJax-Span-1680" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-1681" style="font-family: STIXGeneral-Regular; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-1682" style="font-family: STIXGeneral-Regular; padding-left: 0.291em;">0.5</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-58"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>0.5</mn></mrow></math></script>, while <em>μ</em><sub>1</sub> varies with <em>γ</em>. A restrictive selection based on the mean (low values of <em>γ</em>) increases the PSNR. The optimal limits are obtained for <em>μ</em><sub>1</sub> = 0.95. Right: <em>μ</em><sub>1</sub> = 0.95 and 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M48" overflow="scroll" role="math" style="width: 1.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.003em, 1001.04em, 1.443em, -999.997em); top: -0.976em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1684"><span class="mrow" id="MathJax-Span-1685"><span class="msubsup" id="MathJax-Span-1686"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.52em, 4.15em, -999.997em); top: -3.972em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1687"><span class="mi" id="MathJax-Span-1688" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -4.317em; left: 0.579em;"><span class="mn" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -3.684em; left: 0.521em;"><span class="mn" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.982em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-59"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup></mrow></math></script> varies accordingly to <em>γ</em>. A too restrictive selection (low values of <em>γ</em>) degrades the PSNR. In addition, a too permissive selection (high values of <em>γ</em>) does not increase the PSNR while concurrently increasing uselessly the computational burden. A good compromise is found by fixing 
<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 78%;"><nobr><span class="math" id="M49" overflow="scroll" role="math" style="width: 4.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.574em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.501em, 1003.52em, 2.941em, -999.997em); top: -2.474em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1692"><span class="mrow" id="MathJax-Span-1693"><span class="msubsup" id="MathJax-Span-1694"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.52em, 4.15em, -999.997em); top: -3.972em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1695"><span class="mi" id="MathJax-Span-1696" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -4.317em; left: 0.579em;"><span class="mn" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.344em, 1000.41em, 4.15em, -999.997em); top: -3.684em; left: 0.521em;"><span class="mn" id="MathJax-Span-1698" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-1699" style="font-family: STIXGeneral-Regular; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-1700" style="font-family: STIXGeneral-Regular; padding-left: 0.291em;">0.5</span></span></span><span style="display: inline-block; width: 0px; height: 2.48em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr></span><script type="math/mml" id="MathJax-Element-60"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" overflow="scroll"><mrow><msubsup><mrow><mi>σ</mi></mrow><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>0.5</mn></mrow></math></script>.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F9"><h3>Fig. 9</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530017872" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f9.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f9.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f9.jpg"></div><div id="largeobj_idm140650530017872" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F9/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Impact of the blockwise implementation and voxels selection</strong><p id="__p12">Comparison of the different implementations of the NL-means filter, with <em>α</em> = 1. Left: on T1-w images. For the <strong>Optimized Blockwise NL-means</strong> filter, as for the <strong>Optimized NL-means</strong> filter, the selection of voxels/blocks in the search volume improves the quality of denoising and decreases the computational burden (see Tab. II). The reduction of computational time brought by the blockwise approach needs to be balanced with a slight decrease in quality of denoising. Right: on T2-w images with MS lesions. The same conclusions can be drawn for this kind of images. These results suggest that the parameters tuning determined experimentally on T1-w images are not T1-specific.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F10"><h3>Fig. 10</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530012816" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f10.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f10.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f10.jpg"></div><div id="largeobj_idm140650530012816" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F10/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison of the optimized and non-optimized blockwise NL-means on T2-w images</strong><p id="__p13">NL-means restoration of T2-w Brainweb data with MS lesions. From left to right: “Ground truth”, noised image at 9% of Gaussian noise, restored images by the <strong>Optimized Blockwise NL-means</strong> filter and by the <strong>Blockwise NL-means</strong> filter. The <strong>Optimized Blockwise NL-means</strong> filter preserves efficiently the contours of the MS lesions.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F11"><h3>Fig. 11</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650530008976" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f11.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f11.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f11.jpg"></div><div id="largeobj_idm140650530008976" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F11/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><p id="__p14">Result for AD filter and TV minimization on phantom images with Gaussian noise at 9%. For AD filter K varies from 0.05 to 1 with step of 0.05 and the number of iterations varies from 1 to 10. For TV minimization <em>λ</em> varies from 0.01 to 1 with step of 0.01 and the number of iterations varies from 1 to 10</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F12"><h3>Fig. 12</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596612752" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f12.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f12.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f12.jpg"></div><div id="largeobj_idm140650596612752" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F12/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison between Anisotropic Diffusion, Total Variation and Optimized Blockwise NL-means denoising</strong><p id="__p15">the PSNR values and histograms for different denoising methods on BrainWeb at 9% of Gaussian noise. Left: the PSNR experiment shows that the <strong>Optimized Blockwise NL-means</strong> filter outperforms the well-established Total Variation minimization process and the Anisotropic Diffusion approach. Right: Contrary to others methods, the NL-means based restoration clearly distinguishes the three main peaks representing the white matter, the gray matter and the cerebrospinal fluid. The sharpness of the peaks shows how the <strong>Optimized Blockwise NL-means</strong> filter increases the contrast between denoised biological structures.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F13"><h3>Fig. 13</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596608016" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f13.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f13.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f13.jpg"></div><div id="largeobj_idm140650596608016" class="largeobj-link align_right" style=""><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F13/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison with Anisotropic Diffusion, Total Variation and NL-means denoising on synthetic T1-w images</strong><p id="__p16">Top: zooms on T1-w BrainWeb images. Left: the “ground truth”. Right: the noisy images with 9% of Gaussian noise. Middle: the results of restoration obtained with the different methods and the images of the removed noise (i.e. the difference (centered on 128) between the noisy image and the denoised image. Bottom: the difference (centered on 128) between the denoised image and the ground truth. Left: Anisotropic Diffusion denoising. Left: Anisotropic Diffusion denoising. Middle: Total Variation minimization process. Right: <strong>Optimized Blockwise NL-means</strong> filter. The NL-means based restoration better preserves the anatomical structure in the image while efficiently removing the noise as it can be seen in the image of removed noise.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F14"><h3>Fig. 14</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596603504" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f14.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f14.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f14.jpg"></div><div id="largeobj_idm140650596603504" class="largeobj-link align_right" style=""><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F14/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison with Anisotropic Diffusion, Total Variation and NL-means denoising on synthetic T1-w images</strong><p id="__p17">Top: zooms on T1-w BrainWeb images. Left: the “ground truth”. Right: the noisy images with 21% of Gaussian noise. Middle: the results of restoration obtained with the different methods and the images of the removed noise (i.e. the difference (centered on 128) between the noisy image and the denoised image. Bottom: the difference (centered on 128) between the denoised image and the ground truth. Left: Anisotropic Diffusion denoising. Middle: Total Variation minimization process. Right: <strong>Optimized Blockwise NL-means</strong> filter.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F15"><h3>Fig. 15</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596597456" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f15.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f15.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f15.jpg"></div><div id="largeobj_idm140650596597456" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F15/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison with Anisotropic Diffusion, Total Variation and Optimized Blockwise NL-means denoising</strong><p id="__p18">PSNR values and histograms for different denoising methods on BrainWeb at 9% of Rician noise. Left: the PSNR study shows that the <strong>Optimized Blockwise NL-means</strong> filter outperforms the well-established Total Variation minimization process and the Anisotropic Diffusion approach. Right: When the histograms are compared low values of intensity (<em>&lt;</em> 20) are incorrectly restored for all the filters; the Gaussian approximation is not appropriate in that case. Nevertheless, it seems the underlying assumption is well suited to high values (<em>&gt;</em> 60). Contrary to others methods, the NL-means based restoration clearly emphasizes the three main peaks representing the white matter, the gray matter and the cerebrospinal fluid. The sharpness of the peaks shows how the <strong>Optimized Blockwise NL-means</strong> filter increases the contrast between denoised biological structures.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F16"><h3>Fig. 16</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596592784" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f16.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f16.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f16.jpg"></div><div id="largeobj_idm140650596592784" class="largeobj-link align_right" style=""><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F16/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison with Anisotropic Diffusion, Total Variation and NL-means denoising on synthetic T1-w images</strong><p id="__p19">Top: zooms on T1-w BrainWeb images. Left: the “ground truth”. Right: the noisy images with 9% of Rician noise. Middle: the results of restoration obtained with the different methods and the images of the removed noise (i.e. the difference (centered on 128) between the noisy image and the denoised image. Bottom: the “Method Noise” which is the difference (centered on 128) between the denoised image and the ground truth. Left: Anisotropic Diffusion denoising. Middle: Total Variation minimization process. Right: <strong>Optimized Blockwise NL-means</strong> filter. The NL-means based restoration better preserves the anatomical structure in the image while efficiently removing the noise, it can be seen in the image of removed noise.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F17"><h3>Fig. 17</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596588944" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f17.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f17.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f17.jpg"></div><div id="largeobj_idm140650596588944" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F17/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><p id="__p20">Result for AD filter and TV minimization on phantom images with 9% of Rician noise. For AD filter K varies from 0.05 to 1 with step of 0.05 and the number of iterations varies from 1 to 10. For TV minimization <em>λ</em> varies from 0.01 to 1 with step of 0.01 and the number of iterations varies from 1 to 10.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F18"><h3>Fig. 18</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596584240" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f18.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f18.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f18.jpg"></div><div id="largeobj_idm140650596584240" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F18/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>NL-means filter on a real T1-w MRI</strong><p id="__p21">Fully-automatic restoration obtained with the <strong>Optimized Blockwise NL-means</strong> filter on a 3 Tesla T1-w MRI data of 256<sup>3</sup> voxels in less than 3 minutes on a Intel(R) Pentium(R) D CPU 3.40GHz with 2Go of RAM. From left to right: Original image, denoised image, and difference image with gray values centered on 128. The whole image is shown on top, and a detail is displayed on bottom.</p></div></div></div><div class="print-obj whole_rhythm"><!--fig mode="anchored" f5--><div class="fig  anchored whole_rhythm" id="F19"><h3>Fig. 19</h3><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596579952" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.
Object name is halms169658f19.jpg" title="An external file that holds a picture, illustration, etc.
Object name is halms169658f19.jpg" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/halms169658f19.jpg"></div><div id="largeobj_idm140650596579952" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/figure/F19/?report=objectonly">Open in a separate window</a></div><!--caption a7--><div class="caption"><!--caption a8--><strong>NL-means filter on a real T2-w MRI with MS</strong><p id="__p22">Fully-automatic restoration obtained with the <strong>Optimized Blockwise NL-means</strong> filter on a 1.5T T2-w MRI data with MS lesions of 512 × 512 × 28 voxels in less than 2 minute on a Intel(R) Pentium(R) D CPU 3.40GHz with 2Go of RAM. From left to right: Original image, denoised image, and difference image with gray values centered on 128. The whole image is shown on top, and a detail is exposed on bottom.</p></div></div></div><div class="print-obj whole_rhythm"><!--table-wrap mode="anchored" t5--><div class="table-wrap table anchored whole_rhythm" id="T1"><h3>TABLE I</h3><!--caption a7--><div class="caption"><!--caption a8--><strong>Peak Signal to Noise Ratio (PSNR) between “Ground Truth” and noisy images for Gaussian and Rician noises</strong><p id="__p23">For a same level of noise, the Rician noise is stronger than the Gaussian noise.</p></div><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596576400" class="xtable"><table frame="box" rules="cols" class="rendered small default_table"><thead><tr><th valign="bottom" align="center" rowspan="1" colspan="1">Noise level</th><th valign="bottom" align="center" rowspan="1" colspan="1">PSNR with Gaussian noise in dB</th><th valign="bottom" align="center" rowspan="1" colspan="1">PSNR with Rician noise in dB</th></tr><tr><th colspan="3" valign="bottom" align="left" rowspan="1"><hr></th></tr></thead><tbody><tr><td align="center" valign="top" rowspan="1" colspan="1">3%</td><td align="center" valign="top" rowspan="1" colspan="1">35.09</td><td align="center" valign="top" rowspan="1" colspan="1">35.05</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">9%</td><td align="center" valign="top" rowspan="1" colspan="1">25.64</td><td align="center" valign="top" rowspan="1" colspan="1">25.57</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">15%</td><td align="center" valign="top" rowspan="1" colspan="1">21.30</td><td align="center" valign="top" rowspan="1" colspan="1">21.17</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">21%</td><td align="center" valign="top" rowspan="1" colspan="1">18.49</td><td align="center" valign="top" rowspan="1" colspan="1">18.29</td></tr></tbody></table></div><div id="largeobj_idm140650596576400" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T1/?report=objectonly">Open in a separate window</a></div></div></div><div class="print-obj whole_rhythm"><!--table-wrap mode="anchored" t5--><div class="table-wrap table anchored whole_rhythm" id="T2"><h3>TABLE II</h3><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison of different implementations of the NL-means filters in terms of computational time and denoising quality</strong><p id="__p24">The time is obtained with multithreading on 8 CPUs at 3GHZ and Intel(R) Pentium(R) D CPU 3.40GHZ and without multithreading on 1 CPU at 3GHZ. These results are obtained on a T1-w BrainWeb image with 9% of Gaussian noise (<em>σ</em> = 13.5). The parameters used are the default parameters. The average number of voxels/blocks used in <em>V<sub>i</sub></em> to denoise <em>u</em>(<em>x<sub>i</sub></em>) shows the impact of voxels/blocks selection. For the non-optimized implementations all the voxels/blocks in <em>V<sub>i</sub></em> are taken into account to denoise <em>u</em>(<em>x<sub>i</sub></em>). Thus, the number of voxels/blocks used are |<em>V<sub>i</sub></em>| = (2<em>M</em> + 1)<sup>3</sup> = 11<sup>3</sup>. For the optimized implementations the voxel selection allows to drastically reduce this number.</p></div><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650596546432" class="xtable"><table frame="box" rules="all" class="rendered small default_table"><thead><tr><th valign="top" rowspan="2" align="center" colspan="1"><em>Gaussian Noise</em></th><th colspan="3" valign="bottom" align="center" rowspan="1">Computational time (in s)</th><th valign="top" align="center" rowspan="1" colspan="1">PSNR (in dB)</th><th valign="top" rowspan="2" align="center" colspan="1">Average number of voxels/blocks used in <em>V<sub>i</sub></em> to denoise <em>x<sub>i</sub></em></th></tr><tr><th valign="bottom" align="center" rowspan="1" colspan="1">Xeon 3GHz</th><th valign="bottom" align="center" rowspan="1" colspan="1">8 × Xeon 3GHz</th><th valign="bottom" align="center" rowspan="1" colspan="1">DualCore 3.40 GHz</th><th valign="bottom" align="center" rowspan="1" colspan="1"></th></tr></thead><tbody><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">21790</td><td align="center" valign="top" rowspan="1" colspan="1">2780</td><td align="center" valign="top" rowspan="1" colspan="1">4208</td><td align="center" valign="top" rowspan="1" colspan="1">32.59</td><td align="center" valign="top" rowspan="1" colspan="1">11<sup>3</sup> = 1331 voxels</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>Blockwise NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">1800</td><td align="center" valign="top" rowspan="1" colspan="1">251</td><td align="center" valign="top" rowspan="1" colspan="1">734</td><td align="center" valign="top" rowspan="1" colspan="1">31.73</td><td align="center" valign="top" rowspan="1" colspan="1">11<sup>3</sup> = 1331 blocks</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>Optimized NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">3169</td><td align="center" valign="top" rowspan="1" colspan="1">436</td><td align="center" valign="top" rowspan="1" colspan="1">778</td><td align="center" valign="top" rowspan="1" colspan="1">34.44</td><td align="center" valign="top" rowspan="1" colspan="1">174.8 voxels</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>Optimized Blockwise NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">328</td><td align="center" valign="top" rowspan="1" colspan="1">63</td><td align="center" valign="top" rowspan="1" colspan="1">135</td><td align="center" valign="top" rowspan="1" colspan="1">33.75</td><td align="center" valign="top" rowspan="1" colspan="1">174.8 blocks</td></tr></tbody></table></div><div id="largeobj_idm140650596546432" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T2/?report=objectonly">Open in a separate window</a></div></div></div><div class="print-obj whole_rhythm"><!--table-wrap mode="anchored" t5--><div class="table-wrap table anchored whole_rhythm" id="T3"><h3>TABLE III</h3><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison of histograms obtained with the three different methods at 9% of Gaussian noise</strong><p id="__p25">This Table presents (a) the Bhattacharyya coefficient computed between the histograms of denoised images and the “ground truth” one and (b) the mutual information computed between the denoised images and the “ground truth” The distance between the noisy image and the “ground truth” is used as a reference. Compared to AD filter and TV minimization, the <strong>Optimized Blockwise NL-means</strong> filter allows to obtain a denoised image whose histogram is more closer to “ground truth” histogram.</p></div><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650598258304" class="xtable"><table frame="box" rules="all" class="rendered small default_table"><thead><tr><th valign="bottom" align="left" rowspan="1" colspan="1"></th><th valign="bottom" align="center" rowspan="1" colspan="1">Bhattacharyya Coefficient</th><th valign="bottom" align="center" rowspan="1" colspan="1">Mutual Information</th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="1" colspan="1">Noisy image</td><td align="center" valign="top" rowspan="1" colspan="1">0.9388</td><td align="center" valign="top" rowspan="1" colspan="1">1.282</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Anisotropic diffusion</td><td align="center" valign="top" rowspan="1" colspan="1">0.9608</td><td align="center" valign="top" rowspan="1" colspan="1">2.024</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Total Variation</td><td align="center" valign="top" rowspan="1" colspan="1">0.9639</td><td align="center" valign="top" rowspan="1" colspan="1">1.974</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><strong>Optimized Blockwise NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">0.9756</td><td align="center" valign="top" rowspan="1" colspan="1">2.214</td></tr></tbody></table></div><div id="largeobj_idm140650598258304" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T3/?report=objectonly">Open in a separate window</a></div></div></div><div class="print-obj whole_rhythm"><!--table-wrap mode="anchored" t5--><div class="table-wrap table anchored whole_rhythm" id="T4"><h3>TABLE IV</h3><!--caption a7--><div class="caption"><!--caption a8--><strong>Comparison of different implementations of the NL-means filter in terms of computational time and denoising quality</strong><p id="__p26">These results are obtained on a T1-w BrainWeb image with 9% of Rician noise on a Intel(R) Pentium(R) D CPU 3.40GHz with 2Go of RAM. The parameters used are the default parameters. The average number of voxels/blocks used in <em>V<sub>i</sub></em> to denoise <em>x<sub>i</sub></em> shows the impact of voxels/blocks selection. For non-optimized implementations all the voxels/blocks in <em>V<sub>i</sub></em> are taken into account to denoise <em>x<sub>i</sub></em>. Thus, the number of voxels/blocks used are |<em>V<sub>i</sub></em>| = (2<em>M</em> + 1)<sup>3</sup> = 11<sup>3</sup>. For optimized implementations the voxel selection allows to drastically reduce this number.</p></div><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140650598231216" class="xtable"><table frame="box" rules="all" class="rendered small default_table"><thead><tr><th valign="bottom" align="center" rowspan="1" colspan="1"><em>Rician Noise</em></th><th valign="bottom" align="center" rowspan="1" colspan="1">Computational time (in s)</th><th valign="bottom" align="center" rowspan="1" colspan="1">PSNR (in dB)</th><th valign="bottom" align="center" rowspan="1" colspan="1">Average number of voxels/blocks used in <em>V<sub>i</sub></em> to denoise <em>x<sub>i</sub></em></th></tr></thead><tbody><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">4190</td><td align="center" valign="top" rowspan="1" colspan="1">31.35</td><td align="center" valign="top" rowspan="1" colspan="1">11<sup>3</sup> = 1331 voxels</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>Blockwise NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">759</td><td align="center" valign="top" rowspan="1" colspan="1">30.90</td><td align="center" valign="top" rowspan="1" colspan="1">11<sup>3</sup> = 1331 blocks</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>Optimized NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">1045</td><td align="center" valign="top" rowspan="1" colspan="1">33.40</td><td align="center" valign="top" rowspan="1" colspan="1">251.1 voxels</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1"><strong>Optimized Blockwise NL-means</strong></td><td align="center" valign="top" rowspan="1" colspan="1">169</td><td align="center" valign="top" rowspan="1" colspan="1">32.64</td><td align="center" valign="top" rowspan="1" colspan="1">251.1 blocks</td></tr></tbody></table></div><div id="largeobj_idm140650598231216" class="largeobj-link align_right" style="display: none"><a target="object" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881565/table/T4/?report=objectonly">Open in a separate window</a></div></div></div></div></div><!--post-content--></div>
        
        
    </div>
</div>
                        </div>
                        <div class="bottom">
                            
                            <div id="NCBIFooter_dynamic">
    
    
    
</div>

                            <script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/InstrumentPageStarterJS.js"> </script>
                        </div>
                    </div>
                    <!--/.page-->
                </div>
                <!--/.wrap-->
            </div><!-- /.twelve_col -->
        <div style="display: none;">External link. Please review our <a href="https://www.nlm.nih.gov/privacy.html">privacy policy</a>.</div></div><div id="ZN_dikYWqsjiUWN0Q5"></div>
        <!-- /.grid -->

        <span class="PAFAppResources"></span>
        
        <!-- BESelector tab -->
        
        
        
        <noscript><img alt="statistics" src="/stat?jsdisabled=true&amp;ncbi_db=pmc&amp;ncbi_pdid=article&amp;ncbi_acc=&amp;ncbi_domain=hal&amp;ncbi_report=printable&amp;ncbi_type=fulltext&amp;ncbi_objectid=&amp;ncbi_pcid=/articles/PMC2881565/?report=printable&amp;ncbi_app=pmc" /></noscript>
        
        
        <!-- usually for JS scripts at page bottom -->
        <!--<component id="PageFixtures" label="styles"></component>-->
    

<!-- 56B23163F7BDB3B3_0289SID /projects/PMC/PMCViewer@4.46 ptpmc102 v4.1.r617611 Mon, Oct 05 2020 02:55:27 -->

<script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/3821238.js" snapshot="pmc"></script>
<script type="text/javascript" src="./An optimized blockwise nonlocal means denoising filter for 3-D magnetic resonance images_files/saved_resource"></script><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>